/*
 Basic Primitives Diagram v4.3.0
 Copyright (c) 2013 - 2018 Basic Primitives Inc

 Non-commercial - Free
 http://creativecommons.org/licenses/by-nc/3.0/

 Commercial and government licenses:
 http://www.basicprimitives.com/pdf/license.pdf

*/
(function(){var a=function(a){var a=a.split("."),c=window,d;for(d=0;d<a.length;d+=1)c=c[a[d]]=c[a[d]]||{};return c};a("primitives.common");a("primitives.orgdiagram");a("primitives.famdiagram");a("primitives.text");a("primitives.callout");a("primitives.connector");a("primitives.shape");a("primitives.pdf");a("primitives.pdf.orgdiagram");a("primitives.pdf.famdiagram");primitives.common.version="4.3.0"})();primitives.common.isEven=function(a){return 0==a%2};
primitives.common.isNullOrEmpty=function(a){var b=!0;void 0!==a&&null!==a&&(a=a.toString(),0<a.length&&(b=!1));return b};primitives.common.isArray=Array.isArray||function(a){return a instanceof Array};primitives.common.loop=function(a,b,c){var d,f;if(null!=c)if(primitives.common.isArray(b)){d=0;for(f=b.length;d<f&&!c.call(a,d,b[d]);d+=1);}else for(d in b)if(b.hasOwnProperty(d)&&c.call(a,d,b[d]))break};
primitives.common.splitCamelCaseName=function(a){for(var b=[],c="",d=0;d<a.length;d+=1){var f=a[d];"A"<=f&&"Z">=f?(""!==c&&b.push(c),c=f):c+=f}""!==c&&b.push(c);return b};primitives.common.isObject=function(a){return null!==a&&"object"==typeof a};primitives.common.isEmptyObject=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0};
primitives.common.cloneObject=function(a,b){var c;if(null===a)c=null;else if(a instanceof Array)if(b)c=a.slice(0);else{c=[];for(var d=0,f=a.length;d<f;d+=1)c.push(primitives.common.cloneObject(a[d],b))}else switch(typeof a){case "object":c={};for(d in a)a.hasOwnProperty(d)&&(c[d]=b?a[d]:primitives.common.cloneObject(a[d],b));break;default:c=a}return c};primitives.common.hashCode=function(a){var b=0,c,d;if(0<a.length)for(d=0;d<a.length;d+=1)c=a.charCodeAt(d),b=(b<<5)-b+c,b&=b;return b};
primitives.common.css=function(a,b){var c,d;if(a.hasOwnProperty("cssHash"))for(c in b)b.hasOwnProperty(c)&&(d=b[c],a.cssHash[c]!=d&&(a.cssHash[c]=d,a.css(c,d)));else a.css(b),a.cssHash=b};primitives.common.stopPropagation=function(a){void 0!==a.stopPropagation?a.stopPropagation():void 0!==a.cancelBubble?a.cancelBubble=!0:void 0!==a.preventDefault&&a.preventDefault()};primitives.common.indexOf=function(a,b,c){var d,f;for(d=0;d<a.length;d+=1)if(f=a[d],null!=c?c(f,b):f===b)return d;return-1};
primitives.common._supportsSVG=null;primitives.common.supportsSVG=function(){null===primitives.common._supportsSVG&&(primitives.common._supportsSVG=document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Shape","1.0"));return primitives.common._supportsSVG};primitives.common._supportsVML=null;
primitives.common.supportsVML=function(){var a,b;null===primitives.common._supportsVML&&(primitives.common._supportsVML=!1,jQuery.support.opacity||(a=document.createElement("div"),a=document.body.appendChild(a),a.innerHTML='<v:shape adj="1" />',b=a.firstChild,b.style.behavior="url(#default#VML)",primitives.common._supportsVML=b?"object"===typeof b.adj:!1,a.parentNode.removeChild(a)));return primitives.common._supportsVML};primitives.common._supportsCanvas=null;
primitives.common.supportsCanvas=function(){null===primitives.common._supportsCanvas&&(primitives.common._supportsCanvas=!!window.HTMLCanvasElement);return primitives.common._supportsCanvas};
primitives.common.createGraphics=function(a,b){var c=null,d,f;d=[a];for(f in primitives.common.GraphicsType)primitives.common.GraphicsType.hasOwnProperty(f)&&d.push(primitives.common.GraphicsType[f]);for(f=0;null===c&&f<d.length;f+=1)switch(d[f]){case 2:primitives.common.supportsVML()&&(c=new primitives.common.VmlGraphics(b));break;case 0:primitives.common.supportsSVG()&&(c=new primitives.common.SvgGraphics(b));break;case 1:primitives.common.supportsCanvas()&&(c=new primitives.common.CanvasGraphics(b))}return c};
primitives.common.getColorHexValue=function(a){var b,c,d;if("#"===a.substr(0,1))return a;b=/(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(a);if(null!==b&&0<b.length)return a=parseInt(b[2],10),c=parseInt(b[3],10),d=parseInt(b[4],10),a=(a<<16|c<<8|d).toString(16),b[1]+"000000".substr(0,6-a.length)+a;if(void 0===primitives.common.ColorHexs)for(c in primitives.common.ColorHexs={},primitives.common.Colors)primitives.common.Colors.hasOwnProperty(c)&&(primitives.common.ColorHexs[c.toUpperCase()]=primitives.common.Colors[c]);
return primitives.common.ColorHexs[a.toUpperCase()]};primitives.common.getColorName=function(a){var b,a=primitives.common.getColorHexValue(a);if(void 0===primitives.common.ColorNames)for(b in primitives.common.ColorNames={},primitives.common.Colors)primitives.common.Colors.hasOwnProperty(b)&&(primitives.common.ColorNames[primitives.common.Colors[b]]=b);return primitives.common.ColorNames[a]};primitives.common.getRed=function(a){return"#"===a.substr(0,1)&&7===a.length?parseInt(a.substr(1,2),16):null};
primitives.common.getGreen=function(a){return"#"===a.substr(0,1)&&7===a.length?parseInt(a.substr(3,2),16):null};primitives.common.getBlue=function(a){return"#"===a.substr(0,1)&&7===a.length?parseInt(a.substr(5,2),16):null};
primitives.common.beforeOpacity=function(a,b){var c=primitives.common,d,f,a=c.getColorHexValue(a);d=Math.ceil((c.getRed(a)-255*(1-b))/b);f=Math.ceil((c.getGreen(a)-255*(1-b))/b);c=Math.ceil((c.getBlue(a)-255*(1-b))/b);d=(d<<16|f<<8|c).toString(16);return"#"+"000000".substr(0,6-d.length)+d};
primitives.common.highestContrast=function(a,b,c){var d=b,f=primitives.common,e=a+","+b+","+c;void 0===f.highestContrasts&&(f.highestContrasts={});f.highestContrasts.hasOwnProperty(e)?d=f.highestContrasts[e]:(f.luminosity(b,a)<f.luminosity(c,a)&&(d=c),f.highestContrasts[e]=d);return d};
primitives.common.luminosity=function(a,b){var c=primitives.common,d=c.getColorHexValue(a),f=c.getColorHexValue(b),d=0.2126*Math.pow(c.getRed(d)/255,2.2)+0.7152*Math.pow(c.getRed(d)/255,2.2)+0.0722*Math.pow(c.getRed(d)/255,2.2),c=0.2126*Math.pow(c.getRed(f)/255,2.2)+0.7152*Math.pow(c.getRed(f)/255,2.2)+0.0722*Math.pow(c.getRed(f)/255,2.2);return d>c?(d+0.05)/(c+0.05):(c+0.05)/(d+0.05)};
primitives.common.compareArrays=function(a,b,c){var d=!0,f,e,g,h;if(a.length!=b.length)d=!1;else{h={};f=0;for(e=a.length;f<e;f+=1)g=null!=c?c(a[f]):a[f],h[g]=h.hasOwnProperty(g)?h[g]+1:1;f=0;for(e=b.length;f<e;f+=1)if(g=null!=c?c(b[f]):b[f],h.hasOwnProperty(g)){if(h[g]-=1,0>h[g]){d=!1;break}}else{d=!1;break}}return d};
primitives.common.Mouse=function(){function a(a){if(jQuery.ui.ie&&(!document.documentMode||9>document.documentMode)&&!a.button)a=c(a);else if(g){if(null!=f.onMouseDrag)f.onMouseDrag(a);a=a.preventDefault()}else{if(d(a)&&mouseDelayMet){if(null!=f.onMouseStart)f.onMouseStart(e);g=!0;if(null!=f.onMouseDrag)f.onMouseDrag(a)}a=!g}return a}function b(a){return c(a)}function c(d){jQuery(document).unbind("mousemove."+f.name,a).unbind("mouseup."+f.name,b);if(g&&(g=!1,d.target===e.target&&jQuery.data(d.target,
f.name+".preventClickEvent",!0),null!=f.onMouseStop))f.onMouseStop(d);return!1}function d(a){return Math.max(Math.abs(e.pageX-a.pageX),Math.abs(e.pageY-a.pageY))>=f.distance}var f={distance:3,delay:0,element:null,name:null,onMouseStart:null,onMouseDrag:null,onMouseStop:null,onMouseCapture:null},e,g;return{init:function(h,i){f.element=h;for(var j in i)i.hasOwnProperty(j)&&(f[j]=i[j]);f.element.bind("mousedown."+f.name,function(h){a:if(primitives.common.Mouse.MouseHandled)h=void 0;else{g&&c(h);e=h;
var l=1===h.which,i=h.target.nodeName?jQuery(h.target).closest("input,textarea,button,select,option").length:!1;if(!(l=!l))i||(i=null!=f.onMouseCapture?f.onMouseCapture(h):!0,i=!i),l=i;if(!l){(mouseDelayMet=!f.delay)||(_mouseDelayTimer=setTimeout(function(){mouseDelayMet=!0},f.delay));if(d(h)&&mouseDelayMet){if(null!=f.onMouseStart)f.onMouseStart(h);g=!0;if(!g){h.preventDefault();h=!0;break a}}!0===jQuery.data(h.target,f.name+".preventClickEvent")&&jQuery.removeData(h.target,f.name+".preventClickEvent");
jQuery(document).bind("mousemove."+f.name,a).bind("mouseup."+f.name,b);h.preventDefault();primitives.common.Mouse.MouseHandled=!0}h=!0}return h}).bind("click."+f.name,function(a){if(!0===jQuery.data(a.target,f.name+".preventClickEvent"))return jQuery.removeData(a.target,f.name+".preventClickEvent"),a.stopImmediatePropagation(),!1})},destroy:function(){f.element.unbind("."+f.name);a&&jQuery(document).unbind("mousemove."+f.name,a).unbind("mouseup."+f.name,b)},isStarted:function(){return g}}};
primitives.common.Mouse.MouseHandled=!1;"undefined"!=typeof jQuery&&jQuery(document).mouseup(function(){primitives.common.Mouse.MouseHandled=!1});primitives.common.AdviserPlacementType={Auto:0,Left:2,Right:3};primitives.orgdiagram.AdviserPlacementType=primitives.common.AdviserPlacementType;primitives.common.VerticalAlignmentType={Top:0,Middle:1,Bottom:2};primitives.common.VectorRelationType={None:0,Null:1,Collinear:2,Opposite:3};primitives.common.UpdateMode={Recreate:0,Refresh:1,PositonHighlight:2};
primitives.orgdiagram.UpdateMode=primitives.common.UpdateMode;primitives.text.TextOrientationType={Horizontal:0,RotateLeft:1,RotateRight:2,Auto:3};primitives.common.SideFlag={Top:1,Right:2,Bottom:4,Left:8};primitives.common.ShapeType={Rectangle:0,Oval:1,Triangle:2,CrossOut:3,Circle:4,Rhombus:5,Wedge:7,FramedOval:8,FramedTriangle:9,FramedWedge:10,FramedRhombus:11,None:6};primitives.common.SelectionPathMode={None:0,FullStack:1};primitives.orgdiagram.SelectionPathMode=primitives.common.SelectionPathMode;
primitives.common.SegmentType={Line:0,Move:1,QuadraticArc:2,CubicArc:3,Dot:4};primitives.common.RenderingMode={Create:0,Update:1};primitives.common.PlacementType={Auto:0,TopLeft:8,Top:1,TopRight:2,RightTop:11,Right:3,RightBottom:12,BottomRight:4,Bottom:5,BottomLeft:6,LeftBottom:10,Left:7,LeftTop:9};primitives.common.PageFitMode={None:0,PageWidth:1,PageHeight:2,FitToPage:3,AutoSize:5,SelectionOnly:6};primitives.orgdiagram.PageFitMode=primitives.common.PageFitMode;
primitives.common.OrientationType={Top:0,Bottom:1,Left:2,Right:3,None:4};primitives.orgdiagram.OrientationType=primitives.common.OrientationType;primitives.common.NeighboursSelectionMode={ParentsAndChildren:0,ParentsChildrenSiblingsAndSpouses:1};primitives.common.NavigationMode={Default:0,CursorOnly:1,HighlightOnly:3,Inactive:2};primitives.common.LineType={Solid:0,Dotted:1,Dashed:2};
primitives.common.Layers={BackgroundAnnotation:2,BackgroundAnnotations:3,BackgroundConnectorAnnotation:4,BackgroundHighlightPathAnnotations:5,Connector:6,ForegroundHighlightPathAnnotations:7,Highlight:8,Marker:9,Label:10,Cursor:11,Item:12,ForegroundAnnotations:13,ForegroundConnectorAnnotation:14,Annotation:15,Controls:16};primitives.common.LabelType={Regular:0,Dummy:1,Fixed:2,None:3};primitives.common.AnnotationType={Connector:0,Shape:1,HighlightPath:2,Label:3,Background:4};
primitives.common.ChildrenPlacementType={Auto:0,Vertical:1,Horizontal:2,Matrix:3};primitives.orgdiagram.ChildrenPlacementType=primitives.common.ChildrenPlacementType;
primitives.common.Colors={AliceBlue:"#f0f8ff",AntiqueWhite:"#faebd7",Aqua:"#00ffff",Aquamarine:"#7fffd4",Azure:"#f0ffff",Beige:"#f5f5dc",Bisque:"#ffe4c4",Black:"#000000",BlanchedAlmond:"#ffebcd",Blue:"#0000ff",BlueViolet:"#8a2be2",Brown:"#a52a2a",BurlyWood:"#deb887",Bronze:"#cd7f32",CadetBlue:"#5f9ea0",ChartReuse:"#7fff00",Chocolate:"#d2691e",Coral:"#ff7f50",CornflowerBlue:"#6495ed",Cornsilk:"#fff8dc",Crimson:"#dc143c",Cyan:"#00ffff",DarkBlue:"#00008b",DarkCyan:"#008b8b",DarkGoldenrod:"#b8860b",DarkGray:"#a9a9a9",
DarkGreen:"#006400",DarkKhaki:"#bdb76b",DarkMagenta:"#8b008b",DarkOliveGreen:"#556b2f",Darkorange:"#ff8c00",DarkOrchid:"#9932cc",DarkRed:"#8b0000",DarkSalmon:"#e9967a",DarkSeaGreen:"#8fbc8f",DarkSlateBlue:"#483d8b",DarkSlateGray:"#2f4f4f",DarkTurquoise:"#00ced1",DarkViolet:"#9400d3",DeepPink:"#ff1493",DeepSkyBlue:"#00bfff",DimGray:"#696969",DodgerBlue:"#1e90ff",FireBrick:"#b22222",FloralWhite:"#fffaf0",ForestGreen:"#228b22",Fuchsia:"#ff00ff",Gainsboro:"#dcdcdc",GhostWhite:"#f8f8ff",Gold:"#ffd700",
Goldenrod:"#daa520",Gray:"#808080",Green:"#008000",GreenYellow:"#adff2f",Honeydew:"#f0fff0",Hotpink:"#ff69b4",IndianRed:"#cd5c5c",Indigo:"#4b0082",Ivory:"#fffff0",Khaki:"#f0e68c",Lavender:"#e6e6fa",LavenderBlush:"#fff0f5",Lawngreen:"#7cfc00",Lemonchiffon:"#fffacd",LightBlue:"#add8e6",LightCoral:"#f08080",LightCyan:"#e0ffff",LightGoldenrodYellow:"#fafad2",LightGray:"#d3d3d3",LightGreen:"#90ee90",LightPink:"#ffb6c1",LightSalmon:"#ffa07a",LightSeaGreen:"#20b2aa",LightSkyBlue:"#87cefa",LightSlateGray:"#778899",
LightSteelBlue:"#b0c4de",LightYellow:"#ffffe0",Lime:"#00ff00",Limegreen:"#32cd32",Linen:"#faf0e6",Magenta:"#ff00ff",Maroon:"#800000",MediumAquamarine:"#66cdaa",MediumBlue:"#0000cd",MediumOrchid:"#ba55d3",MediumPurple:"#9370d8",MediumSeaGreen:"#3cb371",MediumSlateBlue:"#7b68ee",MediumSpringGreen:"#00fa9a",MediumTurquoise:"#48d1cc",MediumVioletRed:"#c71585",MidnightBlue:"#191970",MintCream:"#f5fffa",MistyRose:"#ffe4e1",Moccasin:"#ffe4b5",NavajoWhite:"#ffdead",Navy:"#000080",Oldlace:"#fdf5e6",Olive:"#808000",
Olivedrab:"#6b8e23",Orange:"#ffa500",OrangeRed:"#ff4500",Orchid:"#da70d6",PaleGoldenRod:"#eee8aa",PaleGreen:"#98fb98",PaleTurquoise:"#afeeee",PaleVioletRed:"#d87093",Papayawhip:"#ffefd5",Peachpuff:"#ffdab9",Peru:"#cd853f",Pink:"#ffc0cb",Plum:"#dda0dd",PowderBlue:"#b0e0e6",Purple:"#800080",Red:"#ff0000",RosyBrown:"#bc8f8f",RoyalBlue:"#4169e1",SaddleBrown:"#8b4513",Salmon:"#fa8072",SandyBrown:"#f4a460",SeaGreen:"#2e8b57",Seashell:"#fff5ee",Sienna:"#a0522d",Silver:"#c0c0c0",SkyBlue:"#87ceeb",SlateBlue:"#6a5acd",
SlateGray:"#708090",Snow:"#fffafa",SpringGreen:"#00ff7f",SteelBlue:"#4682b4",Tan:"#d2b48c",Teal:"#008080",Thistle:"#d8bfd8",Tomato:"#ff6347",Turquoise:"#40e0d0",Violet:"#ee82ee",Wheat:"#f5deb3",White:"#ffffff",WhiteSmoke:"#f5f5f5",Yellow:"#ffff00",YellowGreen:"#9acd32"};primitives.common.ConnectorLabelPlacementType={From:0,Between:1,To:2};primitives.common.ConnectorPlacementType={Offbeat:0,Straight:1};primitives.common.ConnectorShapeType={OneWay:0,TwoWay:1,BothWay:2};
primitives.common.Visibility={Auto:0,Normal:1,Dot:2,Line:3,Invisible:4};primitives.common.ConnectorStyleType={Extra:0,Regular:1,Highlight:2};primitives.common.ElbowType={None:0,Dot:1,Bevel:2,Round:3};primitives.common.Enabled={Auto:0,True:1,False:2};primitives.common.GraphicsType={SVG:0,Canvas:1,VML:2};primitives.common.GroupByType={None:0,Parents:1,Children:2};primitives.common.HorizontalAlignmentType={Center:0,Left:1,Right:2};
primitives.orgdiagram.ItemType={Regular:0,Assistant:1,SubAssistant:4,SuperAssistant:10,SuperAdviser:9,SubAdviser:5,Adviser:2,Director:11,GeneralPartner:6,LimitedPartner:7,AdviserPartner:8};primitives.common.ConnectorType={Squared:0,Angular:1,Curved:2};primitives.orgdiagram.ConnectorType=primitives.common.ConnectorType;primitives.common.ZOrderType={Auto:0,Background:1,Foreground:2};
primitives.common.RenderEventArgs=function(){this.renderingMode=this.templateName=this.context=this.element=null;this.isSelected=this.isCursor=!1};primitives.common.BaseShape=function(){};
primitives.common.BaseShape.prototype._getLabelPosition=function(a,b,c,d,f,e,g,h){var i=null;switch(h){case 1:i=new primitives.common.Rect(a+c/2-f/2,b-g-e,f,e);break;case 2:i=new primitives.common.Rect(a+c-f,b-g-e,f,e);break;case 8:i=new primitives.common.Rect(a,b-g-e,f,e);break;case 3:i=new primitives.common.Rect(a+c+g,b+d/2-e/2,f,e);break;case 11:i=new primitives.common.Rect(a+c+g,b,f,e);break;case 12:i=new primitives.common.Rect(a+c+g,b+d-e,f,e);break;case 4:i=new primitives.common.Rect(a+c-f,
b+d+g,f,e);break;case 6:i=new primitives.common.Rect(a,b+d+g,f,e);break;case 7:i=new primitives.common.Rect(a-f-g,b+d/2-e/2,f,e);break;case 9:i=new primitives.common.Rect(a-f-g,b,f,e);break;case 10:i=new primitives.common.Rect(a-f-g,b+d-e,f,e);break;default:i=new primitives.common.Rect(a+c/2-f/2,b+d+g,f,e)}return i};primitives.common.BaseShape.prototype._betweenPoint=function(a,b){return new primitives.common.Point((a.x+b.x)/2,(a.y+b.y)/2)};
primitives.common.BaseShape.prototype._offsetPoint=function(a,b,c){var d=null,d=a.distanceTo(b);return d=0===d||0===c?new primitives.common.Point(a):new primitives.common.Point(a.x+(b.x-a.x)/d*c,a.y+(b.y-a.y)/d*c)};primitives.common.Callout=function(a){this.m_graphics=a;this.pointerPlacement=0;this.cornerRadius="10%";this.offset=0;this.lineWidth=this.opacity=1;this.pointerWidth="10%";this.borderColor="#000000";this.lineType=0;this.fillColor="#d3d3d3";this.m_map=[[8,7,6],[1,null,5],[2,3,4]]};
primitives.common.Callout.prototype=new primitives.common.BaseShape;
primitives.common.Callout.prototype.draw=function(a,b){var b=(new primitives.common.Rect(b)).offset(this.offset),c=new primitives.common.Point(b.x,b.y),d=new primitives.common.Point(b.right(),b.y),f=new primitives.common.Point(b.right(),b.bottom()),e=new primitives.common.Point(b.left(),b.bottom()),g=[null,null,null,null,null,null,null,null],e=[c,d,f,e],d=this.m_graphics.getPxSize(this.cornerRadius,Math.min(c.distanceTo(d),d.distanceTo(f))),h,i;h={};null!==this.fillColor&&(h.fillColor=this.fillColor,
h.opacity=this.opacity);null!==this.lineColor&&(h.lineColor=this.borderColor);h.lineWidth=this.lineWidth;h.lineType=this.lineType;i=new primitives.common.PaletteItem(h);h=new primitives.common.PolylinesBuffer;i=h.getPolyline(i);null!==a&&(c=0===this.pointerPlacement?this._getPlacement(a,c,f):this.pointerPlacement,null!==c&&(g[c]=a));for(f=0;f<e.length;f+=1)this._drawSegment(i,e[0],e[1],e[2],this.pointerWidth,d,g[1],g[2]),c=e.shift(),e.push(c),c=g.shift(),g.push(c),c=g.shift(),g.push(c);this.m_graphics.polylinesBuffer(h)};
primitives.common.Callout.prototype._getPlacement=function(a,b,c){var d=null,f=null,d=a.x<b.x?0:a.x>c.x?2:1,f=a.y<b.y?0:a.y>c.y?2:1;return this.m_map[d][f]};
primitives.common.Callout.prototype._drawSegment=function(a,b,c,d,f,e,g,h){var i=this._offsetPoint(b,c,e),j=this._offsetPoint(c,b,e),d=this._offsetPoint(c,d,e),f=this.m_graphics.getPxSize(f,b.distanceTo(c)/2);0===a.length()&&a.addSegment(new primitives.common.MoveSegment(i));null!==g&&(i=this._betweenPoint(b,c),b=this._offsetPoint(i,b,f),f=this._offsetPoint(i,c,f),a.addSegment(new primitives.common.LineSegment(b)),a.addSegment(new primitives.common.LineSegment(g)),a.addSegment(new primitives.common.LineSegment(f)));
a.addSegment(new primitives.common.LineSegment(j));null!==h?(a.addSegment(new primitives.common.LineSegment(h)),a.addSegment(new primitives.common.LineSegment(d))):a.addSegment(new primitives.common.QuadraticArcSegment(c,d))};primitives.common.ConnectorOffbeat=function(){};primitives.common.ConnectorOffbeat.prototype=new primitives.common.BaseShape;
primitives.common.ConnectorOffbeat.prototype.draw=function(a,b,c,d,f,e,g,h,i,j,k,l,m,n){var p,r,q,s,u,t,y,v,m=e=0,A=null,w,x;w=a.getPolyline(b);u=[];switch(i){case 1:u=[-f/2,f/2];x=!1;break;case 0:u=[0];x=!1;break;case 2:u=[0],x=!0}p=Math.max(l?g.width:0,5*f);if(c.right()+p<d.left()||c.left()>d.right()+p)if(c.left()>d.right()?(q=new primitives.common.Point(c.left(),c.verticalCenter()),s=new primitives.common.Point(d.right(),d.verticalCenter())):(q=new primitives.common.Point(c.right(),c.verticalCenter()),
s=new primitives.common.Point(d.left(),d.verticalCenter())),l&&(c.left()>d.right()?(e=7,m=3):(e=3,m=7)),r=new primitives.common.Rect(q,s),v=q.y<=s.y,y=q.x<s.x,r.height<r.width){r.height<2*f&&r.offset(0,v?2*f:0,0,v?0:2*f);h=0;for(p=u.length;h<p;h+=1)t=u[h],a.addInverted(function(d){d=d.getPolyline(b);d.addSegment(new primitives.common.MoveSegment(q.x,q.y+t));d.addSegment(new primitives.common.QuadraticArcSegment(r.horizontalCenter(),(v?r.top():r.bottom())+t,s.x,s.y+t));x&&d.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))})},
h||0==i),w.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))});l&&(i=g.width<2*(r.width/5)?primitives.common.QuadraticArcSegment.prototype.offsetPoint(q.x,q.y,r.horizontalCenter(),v?r.top():r.bottom(),s.x,s.y,0.5):new primitives.common.Point(q.x,v?r.top():r.bottom()),A=new primitives.common.Rect(i.x+(y?f:-g.width-f),v?i.y-g.height-f:i.y+f,g.width,g.height))}else{h=0;for(p=u.length;h<p;h+=1)t=u[h],a.addInverted(function(d){d=d.getPolyline(b);d.addSegment(new primitives.common.MoveSegment(q.x,
q.y+t));d.addSegment(new primitives.common.QuadraticArcSegment(r.horizontalCenter()+t*(v!=y?1:-1),(v?r.top():r.bottom())+t,r.horizontalCenter()+t*(v!=y?1:-1),r.verticalCenter()+t));d.addSegment(new primitives.common.QuadraticArcSegment(r.horizontalCenter()+t*(v!=y?1:-1),(v?r.bottom():r.top())+t,s.x,s.y+t));x&&d.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))})},h||0==i),w.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))});l&&(A=new primitives.common.Rect(r.horizontalCenter()+
(v!=y?f:-(f+g.width)),r.verticalCenter()-g.height/2,g.width,g.height))}else if(c.verticalCenter()<d.top()||c.verticalCenter()>d.bottom()){y=c.x<h.width/2;q=new primitives.common.Point(y?c.right():c.left(),c.verticalCenter());s=new primitives.common.Point(y?d.right():d.left(),d.verticalCenter());r=new primitives.common.Rect(q,s);r.offset(10*f,0,10*f,0);v=q.y<=s.y;h=0;for(p=u.length;h<p;h+=1)t=u[h],a.addInverted(function(c){c=c.getPolyline(b);c.addSegment(new primitives.common.MoveSegment(q.x,q.y+t));
c.addSegment(new primitives.common.QuadraticArcSegment(y?r.right()+t*(v?-1:1):r.left()-t*(v?-1:1),r.verticalCenter(),y?d.right():d.left(),d.verticalCenter()-t));x&&c.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))})},h||0==i),w.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))});l&&(m=e=y?3:7,i=primitives.common.QuadraticArcSegment.prototype.offsetPoint(q.x,q.y,y?r.right():r.left(),r.verticalCenter(),s.x,s.y,0.5),A=new primitives.common.Rect(i.x+(y?
f/2:-f/2-g.width),i.y-g.height/2,g.width,g.height))}else{q=new primitives.common.Point(c.horizontalCenter(),c.top());s=new primitives.common.Point(d.horizontalCenter(),d.top());r=new primitives.common.Rect(q,s);r.offset(0,7*f,0,0);y=q.x<s.x;h=0;for(p=u.length;h<p;h+=1)t=u[h],a.addInverted(function(c){c=c.getPolyline(b);c.addSegment(new primitives.common.MoveSegment(q.x+t,q.y));c.addSegment(new primitives.common.QuadraticArcSegment(r.horizontalCenter(),r.top()-t*(y?-1:1),d.horizontalCenter()-t,d.top()));
x&&c.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))})},h||0==i),w.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))});l&&(m=e=1,i=primitives.common.QuadraticArcSegment.prototype.offsetPoint(q.x,q.y,r.horizontalCenter(),r.top(),s.x,s.y,0.5),A=new primitives.common.Rect(i.x-g.width/2,i.y-(j+g.height),g.width,g.height))}if(l)switch(k){case 0:A=this._getLabelPosition(c.x,c.y,c.width,c.height,A.width,A.height,j,e);break;case 2:A=this._getLabelPosition(d.x,
d.y,d.width,d.height,A.width,A.height,j,m)}null!=n&&n(A)};primitives.common.ConnectorStraight=function(){};primitives.common.ConnectorStraight.prototype=new primitives.common.BaseShape;
primitives.common.ConnectorStraight.prototype.draw=function(a,b,c,d,f,e,g,h,i,j,k,l,m,n){var p,r,q,s,u,t=f/2,y=null,v=0,A=0,w=this;s=new primitives.common.Vector(c.centerPoint(),d.centerPoint());c.loopEdges(function(a,b){p=a.getIntersectionPoint(s,!0,1);v=b;return null!=p});d.loopEdges(function(a,b){r=a.getIntersectionPoint(s,!0,1);A=b;return null!=r});if(null!=p&&null!=r){var x=new primitives.common.Vector(p,r);m.getOffset(x,function(d,c,f){x.offset((d*e-(c-1)*e/2)*f);p=x.from;r=x.to;switch(i){case 1:u=
new primitives.common.Vector(r.clone(),p.clone());u.offset(t);w._drawLine(a,b,u.from,u.to,!1);u=new primitives.common.Vector(p.clone(),r.clone());u.offset(t);w._drawLine(a,b,u.from,u.to,!1);break;case 0:w._drawLine(a,b,p,r,!1);break;case 2:w._drawLine(a,b,p,r,!0)}if(l){switch(k){case 0:y=w._getLabelPositionBySnapPoint(p.x,p.y,g.width,g.height,j,v);break;case 1:q=w._betweenPoint(p,r);y=w._getLabelPositionBySnapPoint(q.x,q.y,g.width,g.height,j,3);break;case 2:y=w._getLabelPositionBySnapPoint(r.x,r.y,
g.width,g.height,j,A)}null!=n&&n.call(this,y)}})}};primitives.common.ConnectorStraight.prototype._drawLine=function(a,b,c,d,f){var e;a.addInverted(function(f){e=f.getPolyline(b);e.addSegment(new primitives.common.MoveSegment(c));e.addSegment(new primitives.common.LineSegment(d));e.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))})},!1);f&&(e=a.getPolyline(b),e.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))}))};
primitives.common.ConnectorStraight.prototype._getLabelPositionBySnapPoint=function(a,b,c,d,f,e){var g=null;switch(e){case 0:case 1:g=new primitives.common.Rect(a-c/2,b-f-d,c,d);break;case 3:g=new primitives.common.Rect(a+f,b-d/2,c,d);break;case 5:g=new primitives.common.Rect(a-c/2,b+f,c,d);break;case 7:g=new primitives.common.Rect(a-c-f,b-d/2,c,d)}return g};primitives.common.Marker=function(){};primitives.common.Marker.Markers={};
primitives.common.Marker.DrawCircle=function(a,b){var c=Math.min(b.width/2,b.height/2),b=new primitives.common.Rect(b.horizontalCenter()-c,b.verticalCenter()-c,2*c,2*c);primitives.common.Marker.DrawOval(a,b)};
primitives.common.Marker.DrawRectangle=function(a,b){a.addSegment(new primitives.common.MoveSegment(b.x,b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.x,b.y));a.addSegment(new primitives.common.LineSegment(b.right(),b.y));a.addSegment(new primitives.common.LineSegment(b.right(),b.bottom()));a.addSegment(new primitives.common.LineSegment(b.x,b.bottom()));a.addSegment(new primitives.common.LineSegment(b.x,b.verticalCenter()))};
primitives.common.Marker.DrawOval=function(a,b){var c,d;c=0.5522848*(b.width/2);d=0.5522848*(b.height/2);a.addSegment(new primitives.common.MoveSegment(b.x,b.verticalCenter()));a.addSegment(new primitives.common.CubicArcSegment(b.x,b.verticalCenter()-d,b.horizontalCenter()-c,b.y,b.horizontalCenter(),b.y));a.addSegment(new primitives.common.CubicArcSegment(b.horizontalCenter()+c,b.y,b.right(),b.verticalCenter()-d,b.right(),b.verticalCenter()));a.addSegment(new primitives.common.CubicArcSegment(b.right(),
b.verticalCenter()+d,b.horizontalCenter()+c,b.bottom(),b.horizontalCenter(),b.bottom()));a.addSegment(new primitives.common.CubicArcSegment(b.horizontalCenter()-c,b.bottom(),b.x,b.verticalCenter()+d,b.x,b.verticalCenter()))};
primitives.common.Marker.DrawTriangle=function(a,b){a.addSegment(new primitives.common.MoveSegment(b.left(),b.bottom()));a.addSegment(new primitives.common.LineSegment(b.horizontalCenter(),b.y));a.addSegment(new primitives.common.LineSegment(b.right(),b.bottom()));a.addSegment(new primitives.common.LineSegment(b.left(),b.bottom()))};
primitives.common.Marker.DrawCrossOut=function(a,b){a.addSegment(new primitives.common.MoveSegment(b.horizontalCenter(),b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.x,b.y));a.addSegment(new primitives.common.MoveSegment(b.horizontalCenter(),b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.right(),b.bottom()));a.addSegment(new primitives.common.MoveSegment(b.horizontalCenter(),b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.right(),
b.y));a.addSegment(new primitives.common.MoveSegment(b.horizontalCenter(),b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.left(),b.bottom()))};
primitives.common.Marker.DrawRhombus=function(a,b){a.addSegment(new primitives.common.MoveSegment(b.horizontalCenter(),b.bottom()));a.addSegment(new primitives.common.LineSegment(b.left(),b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.horizontalCenter(),b.y));a.addSegment(new primitives.common.LineSegment(b.right(),b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.horizontalCenter(),b.bottom()))};
primitives.common.Marker.DrawWedge=function(a,b){a.addSegment(new primitives.common.MoveSegment(b.horizontalCenter(),b.y));a.addSegment(new primitives.common.LineSegment(b.right(),b.y));a.addSegment(new primitives.common.LineSegment(b.horizontalCenter(),b.bottom()));a.addSegment(new primitives.common.LineSegment(b.left(),b.y));a.addSegment(new primitives.common.LineSegment(b.horizontalCenter(),b.y))};
primitives.common.Marker.DrawFramedOval=function(a,b){primitives.common.Marker.DrawRectangle(a,b);primitives.common.Marker.DrawOval(a,b)};primitives.common.Marker.DrawFramedTriangle=function(a,b){primitives.common.Marker.DrawRectangle(a,b);primitives.common.Marker.DrawTriangle(a,b)};primitives.common.Marker.DrawFramedWedge=function(a,b){primitives.common.Marker.DrawRectangle(a,b);primitives.common.Marker.DrawWedge(a,b)};
primitives.common.Marker.DrawFramedRhombus=function(a,b){primitives.common.Marker.DrawRectangle(a,b);primitives.common.Marker.DrawRhombus(a,b)};primitives.common.Marker.DrawNone=function(){};primitives.common.Marker.Markers[4]=primitives.common.Marker.DrawCircle;primitives.common.Marker.Markers[0]=primitives.common.Marker.DrawRectangle;primitives.common.Marker.Markers[1]=primitives.common.Marker.DrawOval;primitives.common.Marker.Markers[2]=primitives.common.Marker.DrawTriangle;
primitives.common.Marker.Markers[3]=primitives.common.Marker.DrawCrossOut;primitives.common.Marker.Markers[5]=primitives.common.Marker.DrawRhombus;primitives.common.Marker.Markers[7]=primitives.common.Marker.DrawWedge;primitives.common.Marker.Markers[8]=primitives.common.Marker.DrawFramedOval;primitives.common.Marker.Markers[9]=primitives.common.Marker.DrawFramedTriangle;primitives.common.Marker.Markers[10]=primitives.common.Marker.DrawFramedWedge;primitives.common.Marker.Markers[11]=primitives.common.Marker.DrawFramedRhombus;
primitives.common.Marker.Markers[6]=primitives.common.Marker.DrawNone;primitives.common.Marker.prototype.draw=function(a,b,c,d){a=a.getPolyline(d);primitives.common.Marker.Markers[b](a,c)};primitives.common.MergedRectangles=function(a){this.graphics=a;this.transform=null;this.opacity=this.lineWidth=1;this.fillColor=null;this.lineType=0;this.borderColor=null};primitives.common.MergedRectangles.prototype=new primitives.common.BaseShape;
primitives.common.MergedRectangles.prototype.draw=function(a){var b=new primitives.common.PaletteItem({lineColor:this.borderColor,lineWidth:this.lineWidth,fillColor:this.fillColor,lineType:this.lineType,opacity:this.opacity}),c=new primitives.common.Polyline(b);primitives.common.getMergedRectangles(this,a,function(a){for(var b=0,e=a.length;b<e;b+=1){var g=a[b];0==b?c.addSegment(new primitives.common.MoveSegment(g.x,g.y)):c.addSegment(new primitives.common.LineSegment(g.x,g.y))}});c.transform(this.transform,
!0);this.graphics.polyline(c)};primitives.common.Shape=function(a){this.m_graphics=a;this.transform=null;this.orientationType=0;this.panelSize=null;this.shapeType=0;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=1;this.labelOffset=4;this.cornerRadius="10%";this.opacity=1;this.fillColor=null;this.labelSize=new primitives.common.Size(60,30);this.lineType=0;this.borderColor=null;this.hasLabel=!1;this.labelTemplate=null;this.labelPlacement=0};primitives.common.Shape.prototype=new primitives.common.BaseShape;
primitives.common.Shape.prototype.draw=function(a,b){var c,d,f,e,a=(new primitives.common.Rect(a)).offset(this.offset);this.transform=new primitives.common.Transform;this.transform.size=this.panelSize;this.transform.setOrientation(this.orientationType);this.hasLabel&&(c=this._getLabelPosition(a.x,a.y,a.width,a.height,this.labelSize.width,this.labelSize.height,this.labelOffset,this.labelPlacement));switch(this.shapeType){case 0:d=new primitives.common.Callout(this.m_graphics);d.cornerRadius=this.cornerRadius;
d.opacity=this.opacity;d.lineWidth=this.lineWidth;d.lineType=this.lineType;d.borderColor=this.borderColor;d.fillColor=this.fillColor;d.draw(null,a);break;default:d=new primitives.common.PaletteItem({lineColor:this.borderColor,lineWidth:this.lineWidth,lineType:this.lineType,fillColor:this.fillColor,opacity:this.opacity}),this.transform.transformRect(a.x,a.y,a.width,a.height,!1,this,function(b,d,c,e){a=new primitives.common.Rect(b,d,c,e)}),e=new primitives.common.Marker,f=new primitives.common.PolylinesBuffer,
e.draw(f,this.shapeType,a,d),f.transform(this.transform,!0),this.m_graphics.polylinesBuffer(f)}this.hasLabel&&this.m_graphics.template(c.x,c.y,0,0,0,0,c.width,c.height,this.labelTemplate.template(),this.labelTemplate.getHashCode(),this.labelTemplate.render,b,null)};primitives.common.Point=function(a,b){this.context=this.y=this.x=null;switch(arguments.length){case 1:this.x=a.x;this.y=a.y;this.context=a.context;break;case 2:this.x=a,this.y=b}};
primitives.common.Point.prototype.scale=function(a){this.x*=a;this.x*=a;return this};primitives.common.Point.prototype.distanceTo=function(a,b){var c=0,d=0;switch(arguments.length){case 1:c=a.x;d=a.y;break;case 2:c=a,d=b}c=this.x-c;d=this.y-d;return Math.sqrt(c*c+d*d)};primitives.common.Point.prototype.equalTo=function(a){return this.x==a.x&&this.y==a.y};primitives.common.Point.prototype.swap=function(a){var b=a.x,c=a.y;a.x=this.x;a.y=this.y;this.x=b;this.y=c};
primitives.common.Point.prototype.clone=function(){return new primitives.common.Point(this)};primitives.common.Point.prototype.toString=function(a){var b,a=void 0!==a?a:"px";b=""+("left:"+this.x+a+";");return b+="top:"+this.y+a+";"};
primitives.common.Rect=function(a,b,c,d){this.context=this.height=this.width=this.y=this.x=null;switch(arguments.length){case 1:this.x=a.x;this.y=a.y;this.width=a.width;this.height=a.height;break;case 2:this.x=Math.min(a.x,b.x);this.y=Math.min(a.y,b.y);this.width=Math.abs(b.x-a.x);this.height=Math.abs(b.y-a.y);break;case 4:this.x=a,this.y=b,this.width=c,this.height=d}};primitives.common.Rect.prototype.left=function(){return this.x};primitives.common.Rect.prototype.top=function(){return this.y};
primitives.common.Rect.prototype.right=function(){return this.x+this.width};primitives.common.Rect.prototype.bottom=function(){return this.y+this.height};primitives.common.Rect.prototype.verticalCenter=function(){return this.y+this.height/2};primitives.common.Rect.prototype.horizontalCenter=function(){return this.x+this.width/2};primitives.common.Rect.prototype.centerPoint=function(){return new primitives.common.Point(this.horizontalCenter(),this.verticalCenter())};
primitives.common.Rect.prototype.isEmpty=function(){return null===this.x||null===this.y||null===this.width||null===this.height||0>this.width||0>this.height};
primitives.common.Rect.prototype.offset=function(a,b,c,d){switch(arguments.length){case 1:null!==a&&"object"==typeof a?(this.x-=a.left,this.y-=a.top,this.width=this.width+a.left+a.right,this.height=this.height+a.top+a.bottom):(this.x-=a,this.y-=a,this.width+=2*a,this.height+=2*a);break;case 4:this.x-=a,this.y-=b,this.width=this.width+a+c,this.height=this.height+b+d}return this};primitives.common.Rect.prototype.scale=function(a){this.x*=a;this.y*=a;this.width*=a;this.height*=a;return this};
primitives.common.Rect.prototype.translate=function(a,b){this.x+=a;this.y+=b;return this};primitives.common.Rect.prototype.invert=function(){var a=this.width,b=this.x;this.width=this.height;this.height=a;this.x=this.y;this.y=b;return this};
primitives.common.Rect.prototype.loopEdges=function(a){var b=[new primitives.common.Point(this.left(),this.top()),new primitives.common.Point(this.right(),this.top()),new primitives.common.Point(this.right(),this.bottom()),new primitives.common.Point(this.left(),this.bottom())],c=[1,3,5,7];b.push(b[0]);if(null!=a)for(var d=1,f=b.length;d<f&&!a(new primitives.common.Vector(b[d-1],b[d]),c[d-1]);d+=1);return this};
primitives.common.Rect.prototype.contains=function(a,b){switch(arguments.length){case 1:return this.x<=a.x&&a.x<=this.x+this.width&&this.y<=a.y&&a.y<=this.y+this.height;case 2:return this.x<=a&&a<=this.x+this.width&&this.y<=b&&b<=this.y+this.height;default:return!1}};
primitives.common.Rect.prototype.cropByRect=function(a){this.x<a.x&&(this.width-=a.x-this.x,this.x=a.x);this.right()>a.right()&&(this.width-=this.right()-a.right());this.y<a.y&&(this.height-=a.y-this.y,this.y=a.y);this.bottom()>a.bottom()&&(this.height-=this.bottom()-a.bottom());this.isEmpty()&&(this.height=this.width=this.y=this.x=null);return this};
primitives.common.Rect.prototype.overlaps=function(a){var b=!0;if(this.x+this.width<a.x||a.x+a.width<this.x||this.y+this.height<a.y||a.y+a.height<this.y)b=!1;return b};
primitives.common.Rect.prototype.addRect=function(a,b,c,d){var f,e;switch(arguments.length){case 1:a.isEmpty()||(this.isEmpty()?(this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height):(f=Math.max(this.right(),a.right()),e=Math.max(this.bottom(),a.bottom()),this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.width=f-this.x,this.height=e-this.y));break;case 2:this.isEmpty()?(this.x=a,this.y=b,this.height=this.width=0):(f=Math.max(this.right(),a),e=Math.max(this.bottom(),b),this.x=Math.min(this.x,
a),this.y=Math.min(this.y,b),this.width=f-this.x,this.height=e-this.y);break;case 4:this.isEmpty()?(this.x=a,this.y=b,this.width=c,this.height=d):(f=Math.max(this.right(),a+c),e=Math.max(this.bottom(),b+d),this.x=Math.min(this.x,a),this.y=Math.min(this.y,b),this.width=f-this.x,this.height=e-this.y)}return this};primitives.common.Rect.prototype.getCSS=function(a){a=void 0!==a?a:"px";return{left:this.x+a,top:this.y+a,width:this.width+a,height:this.height+a}};
primitives.common.Rect.prototype.toString=function(a){var b,a=void 0!==a?a:"px";b=""+("left:"+this.x+a+";");b+="top:"+this.y+a+";";b+="width:"+this.width+a+";";return b+="height:"+this.height+a+";"};primitives.common.Rect.prototype.validate=function(){if(isNaN(this.x)||isNaN(this.y)||isNaN(this.width)||isNaN(this.height))throw"Invalid rect position.";};primitives.common.Rect.prototype.equalTo=function(a){return this.x==a.x&&this.y==a.y&&this.width==a.width&&this.height==a.height};
primitives.common.MoveSegment=function(){this.parent=primitives.common.Point.prototype;this.parent.constructor.apply(this,arguments);this.segmentType=1};primitives.common.MoveSegment.prototype=new primitives.common.Point;primitives.common.MoveSegment.prototype.clone=function(){return new primitives.common.MoveSegment(this)};primitives.common.MoveSegment.prototype.loop=function(a,b){null!=b&&b.call(a,this.x,this.y,0)};primitives.common.MoveSegment.prototype.setPoint=function(a){this.x=a.x;this.y=a.y};
primitives.common.MoveSegment.prototype.getEndPoint=function(){return this};primitives.common.MoveSegment.prototype.invert=function(a){this.x=a.x;this.y=a.y};primitives.common.MoveSegment.prototype.transform=function(a,b){var c=this;a.transformPoint(c.x,c.y,b,c,function(a,b){c.x=a;c.y=b})};
primitives.common.CubicArcSegment=function(a,b,c,d,f,e){this.parent=primitives.common.Point.prototype;this.cpY2=this.cpX2=this.cpY1=this.cpX1=this.y=this.x=null;switch(arguments.length){case 3:this.parent.constructor.apply(this,[c.x,c.y]);this.cpX1=a.x;this.cpY1=a.y;this.cpX2=b.x;this.cpY2=b.y;break;case 6:this.parent.constructor.apply(this,[f,e]),this.cpX1=a,this.cpY1=b,this.cpX2=c,this.cpY2=d}this.segmentType=3};primitives.common.CubicArcSegment.prototype=new primitives.common.Point;
primitives.common.CubicArcSegment.prototype.clone=function(){return new primitives.common.CubicArcSegment(this.cpX1,this.cpY1,this.cpX2,this.cpY2,this.x,this.y)};primitives.common.CubicArcSegment.prototype.loop=function(a,b){null!=b&&(b.call(a,this.cpX1,this.cpY1,0),b.call(a,this.cpX2,this.cpY2,1),b.call(a,this.x,this.y,2))};
primitives.common.CubicArcSegment.prototype.setPoint=function(a,b){switch(b){case 0:this.cpX1=a.x;this.cpY1=a.y;break;case 1:this.cpX2=a.x;this.cpY2=a.y;break;case 2:this.x=a.x,this.y=a.y}};primitives.common.CubicArcSegment.prototype.getEndPoint=function(){return this};primitives.common.CubicArcSegment.prototype.invert=function(a){var b=this.cpX1,c=this.cpY1;this.x=a.x;this.y=a.y;this.cpX1=this.cpX2;this.cpY1=this.cpY2;this.cpX2=b;this.cpY2=c};
primitives.common.CubicArcSegment.prototype.transform=function(a,b){var c=this;a.transform3Points(c.x,c.y,c.cpX1,c.cpY1,c.cpX2,c.cpY2,b,c,function(a,b,e,g,h,i){c.x=a;c.y=b;c.cpX1=e;c.cpY1=g;c.cpX2=h;c.cpY2=i})};
primitives.common.CubicArcSegment.prototype.trim=function(a,b){var c=0.5,d=this.offsetPoint(this.x,this.y,this.cpX2,this.cpY2,this.cpX1,this.cpY1,a.x,a.y,c),f=this.offsetPoint(this.x,this.y,this.cpX2,this.cpY2,this.cpX1,this.cpY1,a.x,a.y,0.1),c=b*(c/d.distanceTo(this.x,this.y)+0.1/f.distanceTo(this.x,this.y))/2,d=this.offsetPoint(this.x,this.y,this.cpX2,this.cpY2,this.cpX1,this.cpY1,a.x,a.y,c);this.x=d.x;this.y=d.y;return this};
primitives.common.CubicArcSegment.prototype.offsetPoint=function(a,b,c,d,f,e,g,h,i){return new primitives.common.Point((1-i)*(1-i)*(1-i)*a+3*(1-i)*(1-i)*i*c+3*(1-i)*i*i*f+i*i*i*g,(1-i)*(1-i)*(1-i)*b+3*(1-i)*(1-i)*i*d+3*(1-i)*i*i*e+i*i*i*h)};primitives.common.DotSegment=function(a,b,c,d,f){this.segmentType=4;this.x=a;this.y=b;this.width=c;this.height=d;this.cornerRadius=f};
primitives.common.Label=function(){this.position=this.text=null;this.weight=0;this.isActive=!0;this.horizontalAlignmentType=this.labelOrientation=this.labelType=0;this.verticalAlignmentType=2;this.parent=primitives.common.Rect.prototype;this.parent.constructor.apply(this,arguments)};primitives.common.Label.prototype=new primitives.common.Rect;
primitives.common.LineSegment=function(){this.parent=primitives.common.MoveSegment.prototype;this.parent.constructor.apply(this,arguments);this.segmentType=0};primitives.common.LineSegment.prototype=new primitives.common.MoveSegment;primitives.common.LineSegment.prototype.clone=function(){return new primitives.common.LineSegment(this)};primitives.common.LineSegment.prototype.trim=function(a,b){var c=this.offsetPoint(this,a,b);this.x=c.x;this.y=c.y;return this};
primitives.common.LineSegment.prototype.offsetPoint=function(a,b,c){var d=null,d=a.distanceTo(b);return d=0===d||0===c?new primitives.common.Point(a):new primitives.common.Point(a.x+(b.x-a.x)/d*c,a.y+(b.y-a.y)/d*c)};primitives.common.Matrix=function(a,b,c,d){this.b2=this.a2=this.b1=this.a1=null;switch(arguments.length){case 1:this.a1=a.a1;this.b1=a.b1;this.a2=a.a2;this.b2=a.b2;break;case 4:this.a1=a,this.b1=b,this.a2=c,this.b2=d}};
primitives.common.Matrix.prototype.determinant=function(){return this.a1*this.b2-this.b1*this.a2};primitives.common.PaletteItem=function(a){this.lineColor="#c0c0c0";this.lineWidth=1;this.lineType=0;this.opacity=this.fillColor=null;this._key="";var b,c,d,f;c=["lineColor","lineWidth","lineType","fillColor","opacity"];d=0;for(f=c.length;d<f;d+=1)b=c[d],null!=a&&a.hasOwnProperty(b)&&(this[b]=a[b]),this._key+=(!primitives.common.isNullOrEmpty(this._key)?", ":"")+b+":"+this[b]};
primitives.common.PaletteItem.prototype.toAttr=function(){var a={lineWidth:this.lineWidth,lineType:this.lineType};null!==this.fillColor&&(a.fillColor=this.fillColor);null!==this.opacity&&(a.opacity=this.opacity);null!==this.lineColor&&(a.borderColor=this.lineColor);return a};primitives.common.PaletteItem.prototype.toString=function(){return this._key};
primitives.common.PaletteManager=function(a,b){this.palette=[];this.cursor=0;var c,d;if(0===b.length)this.palette=[new primitives.common.PaletteItem({lineColor:a.linesColor,lineWidth:a.linesWidth,lineType:a.linesType})],this.paletteLength=this.palette.length,this.regularIndex=0;else{c=0;for(d=b.length;c<d;c+=1)this.palette.push(new primitives.common.PaletteItem(b[c]));this.paletteLength=this.palette.length;this.palette.push(new primitives.common.PaletteItem({lineColor:a.linesColor,lineWidth:a.linesWidth,
lineType:a.linesType}));this.regularIndex=this.palette.length-1}this.palette.push(new primitives.common.PaletteItem({lineColor:a.highlightLinesColor,lineWidth:a.highlightLinesWidth,lineType:a.highlightLinesType}));this.highlightIndex=this.palette.length-1};primitives.common.PaletteManager.prototype.selectPalette=function(a){this.cursor=a%this.paletteLength};
primitives.common.PaletteManager.prototype.getPalette=function(a){var b=null;switch(a){case 1:b=this.regularIndex;break;case 2:b=this.highlightIndex;break;case 0:b=this.cursor}return this.palette[b]};
primitives.common.Polyline=function(a){function b(a,b){var d,c,e;if(null!=b){d=0;for(c=i.length;d<c&&(!(e=i[d])||!b.call(a,e,d));d+=1);}}function c(){return primitives.common.isNullOrEmpty(h.fillColor)}function d(a,b,d,c,e,f){for(var g=new primitives.common.Polyline(k),h,i,e=[new primitives.common.Point(e,-f/2),new primitives.common.Point(0,0),new primitives.common.Point(e,f/2),new primitives.common.Point(3*(e/4),0)],j=Math.atan2(b-c,a-d),a=0,b=e.length;a<b;a+=1)f=e[a],h=f.x*Math.cos(j)-f.y*Math.sin(j),
i=f.x*Math.sin(j)+f.y*Math.cos(j),f.x=h+d,f.y=i+c;g.addSegment(new primitives.common.MoveSegment(e[0].x,e[0].y));g.addSegment(new primitives.common.LineSegment(e[1].x,e[1].y));g.addSegment(new primitives.common.LineSegment(e[2].x,e[2].y));g.addSegment(new primitives.common.QuadraticArcSegment(e[3].x,e[3].y,e[0].x,e[0].y));return g}function f(a,b){this.segment=a;this.pointIndex=b}function e(a,b,d,c,e){var g=a.relateTo(b),h=e?0:d;2==g?b.offset(h):3==g&&0===b.from.context.pointIndex?(g=new primitives.common.LineSegment(b.from),
c.addSegment(g),b.offset(h),c=b.from.clone(),c.context=new f(g,0),h=new primitives.common.Vector(a.to.clone(),c),e||(b.from=c.clone()),h.offset(d),h.intersect(a),h.from.context.pushToSegment(h.from),b.intersect(h),e&&h.to.context.pushToSegment(h.to)):(b.offset(h),b.intersect(a));b.from.context.pushToSegment(b.from)}function g(a,b,d,c){var f,g=a[0],h=g.to.context.segment.getEndPoint().toString();b.hasOwnProperty(h)&&(f=b[h],e(g,f,d,c,!0),delete b[h]);g.to.context.pushToSegment(g.to);a.length=0}var h=
new primitives.common.PaletteItem,i=[],j,k;switch(arguments.length){case 1:h=a}k=new primitives.common.PaletteItem({lineColor:h.lineColor,lineWidth:0,fillColor:h.lineColor,opacity:h.opacity||1});f.prototype.pushToSegment=function(a){this.segment.setPoint(a,this.pointIndex)};return j={paletteItem:h,arrowPaletteItem:k,addSegment:function(a){i.push(a)},addSegments:function(a){i=i.concat(a)},mergeTo:function(a){a.addSegments(i)},length:function(){return i.length},loop:b,loopReversed:function(a,b){var d,
c;if(null!=b)for(d=i.length-1;0<=d&&(!(c=i[d])||!b.call(a,c,d));d-=1);},transform:function(a,d){b(this,function(b){null!=b.transform&&b.transform(a,d)})},isInvertable:c,addInverted:function(a){var b=!1,d=[];c()?a.loopReversed(this,function(a){4!=a.segmentType&&(b||(i.push(new primitives.common.MoveSegment(a.getEndPoint())),b=!0),d.unshift(a),1<d.length&&(d[1].invert(d[0].getEndPoint()),i.push(d[1]),d.length=1))}):a.mergeTo(j)},addArrow:function(a,b){var c,e,f,g;e=i.length;g=3*a;var h=2*a;switch(a){case 1:g=
8;h=6;break;case 2:g=12;h=8;break;case 3:g=16,h=10}null!=b&&1<e&&(c=i[e-2].getEndPoint(),f=i[e-1],null!=f.trim&&(e=new primitives.common.Point(f.getEndPoint()),c=f.trim(c,h),g=d(c.x,c.y,e.x,e.y,g,h),b(g,c)))},addOffsetArrow:function(a,b,c,e,f){var g,h,k;g=i.length;k=3*b;var j=2*b,y;switch(b){case 1:k=8;j=6;break;case 2:k=12;j=8;break;case 3:k=16,j=10}null!=f&&1<g&&(b=i[g-2].getEndPoint(),h=i[g-1],null!=h.offsetPoint&&(g=new primitives.common.Point(h.getEndPoint()),y=b.distanceTo(g),y>e&&(c*=y,a?(a=
h.offsetPoint(b,g,c),k=d(b.x,b.y,a.x,a.y,k,j)):(a=h.offsetPoint(g,b,c),k=d(g.x,g.y,a.x,a.y,k,j)),f(k))))},optimizeMoveSegments:function(){var a,b,d,c,e;d={};var f=[],g=[];a=0;for(b=i.length;a<b-1;a+=1)switch(c=i[a],e=i[a+1],c.segmentType){case 0:case 2:case 3:switch(e.segmentType){case 1:case 4:c=c.x+"&"+c.y,d.hasOwnProperty(c)||(d[c]=a)}break;case 1:c=c.x+"&"+c.y,d.hasOwnProperty(c)&&!f[d[c]]&&(f[d[c]]=a+1,g[a]=!0)}e=[];for(a=0;a<b;a+=1)if(!g[a]&&(c=i[a],e.push(c),g[a]=!0,0<f[a]))for(d=f[a];d<b&&
!g[d];)c=i[d],e.push(c),g[d]=!0,d=0<f[d]?f[d]:d+1;i=e},getOffsetPolyine:function(a){var d=new primitives.common.Polyline(h),c={},k=[],i=[];b(this,function(b){var h=b.clone();switch(h.segmentType){case 4:case 1:0<i.length&&g(i,c,a,d);k.length=0;1==h.segmentType&&(b=new primitives.common.Point(h),b.context=new f(h,0),k.push(b));break;default:h.loop(this,function(b,g,j){b=new primitives.common.Point(b,g);b.context=new f(h,j);k.unshift(b);1<k.length&&(i.unshift(new primitives.common.Vector(k[1].clone(),
k[0].clone())),k.length=1);switch(i.length){case 1:j=i[0];b=j.from.toString();c[b]=j;j.offset(a);j.from.context.pushToSegment(j.from);break;case 2:b=i[1],j=i[0],e(b,j,a,d,!1),i.length=1}})}d.addSegment(h)});0<i.length&&g(i,c,a,d);return d},toString:function(){return h.toString()},getStartPoint:function(){var a=null;0<i.length&&(a=i[0].getEndPoint());return a},getEndPoint:function(){var a=null;0<i.length&&(a=i[i.length-1].getEndPoint());return a},clone:function(){var a,b,d=new primitives.common.Polyline(h),
c=[],e;a=0;for(b=i.length;a<b;a+=1)e=i[a],c.push(e.clone());d.addSegments(c);return d}}};
primitives.common.PolylinesBuffer=function(){function a(a,b){a[b.toString()]||(a[b.toString()]=new primitives.common.Polyline(b));return a[b.toString()]}function b(a,b){var e,g;if(null!=b)for(e in c)if(c.hasOwnProperty(e)&&(g=c[e]))if(g.optimizeMoveSegments(),b.call(a,g))break}var c={};return{getPolyline:function(b){return a(c,b)},loop:b,addInverted:function(d,f){var e,g;e=c;c={};null!=d&&d(this);b(this,function(b){g=a(e,b.paletteItem);f?b.mergeTo(g):g.addInverted(b)});c=e},transform:function(a,c){b(this,
function(b){b.transform(a,c)})}}};primitives.common.QuadraticArcSegment=function(a,b,c,d){this.cpY=this.cpX=this.y=this.x=null;switch(arguments.length){case 2:this.x=b.x;this.y=b.y;this.cpX=a.x;this.cpY=a.y;break;case 4:this.cpX=a,this.cpY=b,this.x=c,this.y=d}this.segmentType=2};primitives.common.QuadraticArcSegment.prototype.clone=function(){return new primitives.common.QuadraticArcSegment(this.cpX,this.cpY,this.x,this.y)};
primitives.common.QuadraticArcSegment.prototype.loop=function(a,b){null!=b&&(b.call(a,this.cpX,this.cpY,0),b.call(a,this.x,this.y,1))};primitives.common.QuadraticArcSegment.prototype.setPoint=function(a,b){switch(b){case 0:this.cpX=a.x;this.cpY=a.y;break;case 1:this.x=a.x,this.y=a.y}};primitives.common.QuadraticArcSegment.prototype.getEndPoint=function(){return this};primitives.common.QuadraticArcSegment.prototype.invert=function(a){this.x=a.x;this.y=a.y};
primitives.common.QuadraticArcSegment.prototype.transform=function(a,b){var c=this;a.transformPoints(c.x,c.y,c.cpX,c.cpY,b,c,function(a,b,e,g){c.x=a;c.y=b;c.cpX=e;c.cpY=g})};
primitives.common.QuadraticArcSegment.prototype.trim=function(a,b){var c=0.5,d=this.offsetPoint(this.x,this.y,this.cpX,this.cpY,a.x,a.y,c),f=this.offsetPoint(this.x,this.y,this.cpX,this.cpY,a.x,a.y,0.1),c=b*(c/d.distanceTo(this.x,this.y)+0.1/f.distanceTo(this.x,this.y))/2,d=this.offsetPoint(this.x,this.y,this.cpX,this.cpY,a.x,a.y,c);this.x=d.x;this.y=d.y;return this};
primitives.common.QuadraticArcSegment.prototype.offsetPoint=function(a,b,c,d,f,e,g){return new primitives.common.Point((1-g)*(1-g)*a+2*(1-g)*g*c+g*g*f,(1-g)*(1-g)*b+2*(1-g)*g*d+g*g*e)};primitives.common.Size=function(a,b){this.height=this.width=0;switch(arguments.length){case 1:this.width=a.width;this.height=a.height;break;case 2:this.width=a,this.height=b}};primitives.common.Size.prototype.invert=function(){var a=this.width;this.width=this.height;this.height=a;return this};
primitives.common.Size.prototype.scale=function(a){this.width*=a;this.height*=a;return this};primitives.common.Size.prototype.getCSS=function(a){a=void 0!==a?a:"px";return{left:this.x+a,top:this.y+a,width:this.width+a,height:this.height+a}};primitives.common.Size.prototype.cropBySize=function(a){this.width=Math.min(this.width,a.width);this.height=Math.min(this.height,a.height);return this};
primitives.common.Size.prototype.addSize=function(a){this.width=Math.max(this.width,a.width);this.height=Math.max(this.height,a.height);return this};primitives.common.Size.prototype.validate=function(){if(isNaN(this.width)||isNaN(this.height))throw"Invalid size.";};primitives.common.Thickness=function(a,b,c,d){this.left=a;this.top=b;this.right=c;this.bottom=d};primitives.common.Thickness.prototype.isEmpty=function(){return 0===this.left&&0===this.top&&0===this.right&&0===this.bottom};
primitives.common.Thickness.prototype.toString=function(a){a=void 0!==a?a:"px";return this.left+a+", "+this.top+a+", "+this.right+a+", "+this.bottom+a};primitives.common.Vector=function(a,b){this.context=this.to=this.from=null;switch(arguments.length){case 1:this.from=a.from;this.to=a.to;break;case 2:this.from=a,this.to=b}};primitives.common.Vector.prototype.isNull=function(){return this.from.x==this.to&&this.from.y==this.to.y};primitives.common.Vector.prototype.length=function(){return this.from.distanceTo(this.to)};
primitives.common.Vector.prototype.equalTo=function(a){return this.from.equalTo(a.from)&&this.to.equalTo(a.to)};primitives.common.Vector.prototype.getMiddlePoint=function(){return new primitives.common.Point((this.from.x+this.to.x)/2,(this.from.y+this.to.y)/2)};
primitives.common.Vector.prototype.relateTo=function(a){var b=0,c=this.to.x-this.from.x,d=this.to.y-this.from.y,f=a.to.x-a.from.x,a=a.to.y-a.from.y;switch((c?8:0)+(d?4:0)+(f?2:0)+(a?1:0)){case 0:case 1:case 2:case 3:case 4:case 8:case 12:b=1;break;case 5:b=0<d*a?2:3;break;case 10:b=0<c*f?2:3;break;case 15:c/f==d/a&&(b=0<c/f?2:3)}return b};
primitives.common.Vector.prototype.offset=function(a){var b=this.length(),c=(this.to.y-this.from.y)*a/b,a=-(this.to.x-this.from.x)*a/b;this.from.x+=c;this.from.y+=a;this.to.x+=c;this.to.y+=a};primitives.common.Vector.prototype.getLine=function(){var a=this.from.x,b=this.from.y,c=this.to.x,d=this.to.y;return[d-b,a-c,a*(b-d)+b*(c-a)]};
primitives.common.Vector.prototype.getLineKey=function(){var a=this.getLine(),b=a[0],c=a[1],a=a[2],a=0!==c?[Math.floor(1E4*(b/c)),1,Math.floor(1E4*(a/c))]:[1,0,Math.floor(1E4*(a/b))];return a.toString()};
primitives.common.Vector.prototype.intersect=function(a){var b=this.getLine(),c=a.getLine(),d=(new primitives.common.Matrix(b[0],b[1],c[0],c[1])).determinant(),f;f=!1;0!==d&&(f=new primitives.common.Matrix(-b[2],b[1],-c[2],c[1]),f=f.determinant(),b=new primitives.common.Matrix(b[0],-b[2],c[0],-c[2]),b=b.determinant(),c=f/d,d=b/d,a.to.x=c,a.to.y=d,this.from.x=c,this.from.y=d,f=!0);return f};
primitives.common.Vector.prototype.getIntersectionPoint=function(a,b,c){var d=this.getLine(),f=a.getLine(),e=(new primitives.common.Matrix(d[0],d[1],f[0],f[1])).determinant(),g,h=null;0!==e&&(g=new primitives.common.Matrix(-d[2],d[1],-f[2],f[1]),g=g.determinant(),d=new primitives.common.Matrix(d[0],-d[2],f[0],-f[2]),d=d.determinant(),g/=e,e=d/e,b?a._contains(g,e,c)&&this._contains(g,e,c)&&(h=new primitives.common.Point(g,e)):h=new primitives.common.Point(g,e));return h};
primitives.common.Vector.prototype._contains=function(a,b,c){var d=Math.min(this.from.x,this.to.x),f=Math.min(this.from.y,this.to.y),e=Math.max(this.from.x,this.to.x),g=Math.max(this.from.y,this.to.y);return d-c<=a&&a<=e+c&&f-c<=b&&b<=g+c};
primitives.common.Graphics=function(a){this.m_element=a;this.m_placeholders={};this.m_activePlaceholder=null;this.m_cache=new primitives.common.Cache;this.graphicsType=null;this.debug=this.hasGraphics=!1;this.layerNames={};primitives.common.loop(this,primitives.common.Layers,function(a,c){this.layerNames[c]=a})};
primitives.common.Graphics.prototype.clean=function(){var a,b,c,d;this.m_cache.clear();this.m_element=this.m_cache=null;for(a in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(a)){b=this.m_placeholders[a];for(c in b.layers)b.layers.hasOwnProperty(c)&&(d=b.layers[c],d.canvas.remove(),d.canvas=null);b.layers.length=0;b.activeLayer=null;b.size=null;b.rect=null;b.div=null}this.m_placeholders.length=0;this.m_activePlaceholder=null};
primitives.common.Graphics.prototype.resize=function(a,b,c){a=this.m_placeholders[a];null!=a&&this.resizePlaceholder(a,b,c)};primitives.common.Graphics.prototype.resizePlaceholder=function(a,b,c){var d;a.size=new primitives.common.Size(b,c);a.rect=new primitives.common.Rect(0,0,b,c);for(d in a.layers)a.layers.hasOwnProperty(d)&&(b=a.layers[d],-1!==b.name&&b.canvas.css({position:"absolute",width:"0px",height:"0px"}))};primitives.common.Graphics.prototype.begin=function(){this.m_cache.begin()};
primitives.common.Graphics.prototype.end=function(){this.m_cache.end()};primitives.common.Graphics.prototype.reset=function(a,b){var c="none",d=-1;switch(arguments.length){case 1:"string"===typeof a?c=a:d=a;break;case 2:c=a,d=b}this.m_cache.reset(c,d)};
primitives.common.Graphics.prototype.activate=function(a,b){switch(arguments.length){case 1:"string"===typeof a?(this._activatePlaceholder(a),this._activateLayer(-1)):(this._activatePlaceholder("none"),this._activateLayer(a));break;case 2:this._activatePlaceholder(a),this._activateLayer(b)}return this.m_activePlaceholder};
primitives.common.Graphics.prototype._activatePlaceholder=function(a){var b=this.m_placeholders[a],c;void 0===b&&(c="none"===a?this.m_element:this.m_element.find("."+a),b=new primitives.common.Placeholder(a),b.div=c,b.size=new primitives.common.Size(c.innerWidth(),c.innerHeight()),b.rect=new primitives.common.Rect(0,0,b.size.width,b.size.height),this.m_placeholders[a]=b);this.m_activePlaceholder=b};
primitives.common.Graphics.prototype._activateLayer=function(a){var b=this.m_activePlaceholder.layers[a],c,d,f,e;if(void 0===b){c=this.m_activePlaceholder;if(-1===a)b=new primitives.common.Layer(a),b.canvas=c.div;else{d=jQuery("<div></div>");d.addClass("Layer"+a);d.addClass("Layer"+this.layerNames[a]);new primitives.common.Rect(c.rect);d.css({position:"absolute",width:"0px",height:"0px"});f=null;for(e in c.layers)c.layers.hasOwnProperty(e)&&(b=c.layers[e],b.name<a&&(f=null!==f?Math.max(f,b.name):
b.name));b=new primitives.common.Layer(a);b.canvas=d;null===f?c.div.prepend(b.canvas[0]):b.canvas.insertAfter(c.layers[f].canvas)}c.layers[a]=b}this.m_activePlaceholder.activeLayer=b};
primitives.common.Graphics.prototype.text=function(a,b,c,d,f,e,g,h,i){var j=this.m_activePlaceholder,g={position:"absolute",padding:0,margin:0,"text-align":this._getTextAlign(g),"font-size":i["font-size"],"font-family":i["font-family"],"font-weight":i["font-weight"],"font-style":i["font-style"],color:i["font-color"],"line-height":1},i="";switch(e){case 0:case 3:g.left=a;g.top=b;g.width=c;g.height=d;break;case 1:g.left=a+Math.round(c/2-d/2);g.top=b+Math.round(d/2-c/2);g.width=d;g.height=c;i="rotate(-90deg)";
break;case 2:g.left=a+Math.round(c/2-d/2),g.top=b+Math.round(d/2-c/2),g.width=d,g.height=c,i="rotate(90deg)"}g["-webkit-transform-origin"]="center center";g["-moz-transform-origin"]="center center";g["-o-transform-origin"]="center center";g["-ms-transform-origin"]="center center";g["-webkit-transform"]=i;g["-moz-transform"]=i;g["-o-transform"]=i;g["-ms-transform"]=i;g.transform=i;g["max-width"]=g.width;g["max-height"]=g.height;f=f.replace(RegExp("\n","g"),"<br/>");switch(h){case 0:this.debug&&(g.border=
"solid 1px black");a=this.m_cache.get(j.name,j.activeLayer.name,"text");null===a?(a=jQuery("<div></div>"),a.css(g),a.html(f),j.activeLayer.canvas.append(a),this.m_cache.put(j.name,j.activeLayer.name,"text",a)):(a.css(g),a.html(f));break;default:g["border-collapse"]="collapse",b={"vertical-align":this._getVerticalAlignment(h),padding:0},this.debug&&(b.border="solid 1px black"),a=this.m_cache.get(j.name,j.activeLayer.name,"textintable"),null===a?(a=jQuery("<table><tbody><tr><td></td></tr></tbody></table>"),
primitives.common.css(a,g),a.find("td").css(b).html(f),j.activeLayer.canvas.append(a),this.m_cache.put(j.name,j.activeLayer.name,"textintable",a)):(primitives.common.css(a,g),a.find("td").css(b).html(f))}};primitives.common.Graphics.prototype._getTextAlign=function(a){var b=null;switch(a){case 0:b="center";break;case 1:b="left";break;case 2:b="right"}return b};
primitives.common.Graphics.prototype._getVerticalAlignment=function(a){var b=null;switch(a){case 1:b="middle";break;case 0:b="top";break;case 2:b="bottom"}return b};primitives.common.Graphics.prototype.polylinesBuffer=function(a){a.loop(this,function(a){0<a.length()&&this.polyline(a)})};
primitives.common.Graphics.prototype.polyline=function(a){var b=null,c=null,d=a.paletteItem.toAttr();a.loop(this,function(a){switch(a.segmentType){case 1:b=Math.round(a.x)+0.5;c=Math.round(a.y)+0.5;break;case 0:this.rightAngleLine(b,c,Math.round(a.x)+0.5,Math.round(a.y)+0.5,d);b=Math.round(a.x)+0.5;c=Math.round(a.y)+0.5;break;case 4:this.dot(a.x,a.y,a.width,a.height,a.cornerRadius,d)}})};
primitives.common.Graphics.prototype.dot=function(a,b,c,d,f,e){var g=this.m_activePlaceholder,h=this.m_cache.get(g.name,g.activeLayer.name,"dot"),i=void 0!==e.lineWidth&&void 0!==e.borderColor,a={position:"absolute",width:c-(i?1:0),top:Math.round(b),left:Math.round(a),padding:0,margin:0,"line-height":"0px",overflow:"hidden",height:d-(i?1:0),background:e.fillColor,"-moz-border-radius":f,"-webkit-border-radius":f,"-khtml-border-radius":f,"border-radius":f,"font-size":"0px","border-style":i?"Solid":
"None","border-width":i?"1px":"0px","border-color":i?e.borderColor:""};null===h?(h=jQuery("<div></div>"),primitives.common.css(h,a),g.activeLayer.canvas.append(h),this.m_cache.put(g.name,g.activeLayer.name,"dot",h)):primitives.common.css(h,a)};
primitives.common.Graphics.prototype.rightAngleLine=function(a,b,c,d,f){var e=this.m_activePlaceholder,g=Math.abs(d-b)>Math.abs(c-a),h=f.lineWidth,f={position:"absolute",top:Math.round(Math.min(b,d)-(g?0:h/2)),left:Math.round(Math.min(a,c)-(g?h/2:0)),padding:0,margin:0,opacity:0.5,"line-height":"0px",overflow:"hidden",background:f.borderColor,"font-size":"0px"};g?(f.width=h,f.height=Math.abs(Math.round(d-b))):(f.width=Math.abs(Math.round(c-a)),f.height=h);a=this.m_cache.get(e.name,e.activeLayer.name,
"rect");null===a?(a=jQuery("<div></div>"),primitives.common.css(a,f),e.activeLayer.canvas.append(a),this.m_cache.put(e.name,e.activeLayer.name,"rect",a)):primitives.common.css(a,f)};
primitives.common.Graphics.prototype.template=function(a,b,c,d,f,e,g,h,i,j,k,l,m){var c=this.m_activePlaceholder,d="template"+(null!==j?j:primitives.common.hashCode(i)),n=0,p,j=this.m_cache.get(c.name,c.activeLayer.name,d);null!==m&&void 0!==m["border-width"]&&(n=this.getPxSize(m["border-width"]));p={width:g-n+"px",height:h-n+"px",top:b+e+"px",left:a+f+"px"};jQuery.extend(p,m);null==l&&(l=new primitives.common.RenderEventArgs);l.x=a+f;l.y=b+e;l.width=g-n;l.height=h-n;null==j?(j=jQuery(i),jQuery.extend(p,
{position:"absolute",padding:"0px",margin:"0px"},m),primitives.common.css(j,p),l.element=j,l.renderingMode=0,null!==k&&k(null,l),c.activeLayer.canvas.append(j),this.m_cache.put(c.name,c.activeLayer.name,d,j)):(l.element=j,l.renderingMode=1,primitives.common.css(j,p),null!==k&&k(null,l));return j};primitives.common.Graphics.prototype.getPxSize=function(a,b){var c=a;"string"===typeof a&&(c=0<a.indexOf("pt")?96*parseInt(a,10)/72:0<a.indexOf("%")?parseFloat(a)/100*b:parseInt(a,10));return c};
primitives.common.Cache=function(){this.threshold=20;this.m_visible={};this.m_invisible={}};primitives.common.Cache.prototype.begin=function(){var a,b,c,d;for(a in this.m_visible)if(this.m_visible.hasOwnProperty(a))for(b in this.m_visible[a])if(this.m_visible[a].hasOwnProperty(b)){for(c=this.m_visible[a][b].length-1;0<=c;c-=1)d=this.m_visible[a][b][c],d.css({visibility:"hidden"}),this.m_invisible[a][b].push(d);this.m_visible[a][b].length=0}};
primitives.common.Cache.prototype.end=function(){var a,b,c;for(a in this.m_visible)if(this.m_visible.hasOwnProperty(a))for(b in this.m_visible[a])if(this.m_visible[a].hasOwnProperty(b)&&this.m_invisible[a][b].length>this.threshold)for(;void 0!==(c=this.m_invisible[a][b].pop());)c.remove()};
primitives.common.Cache.prototype.reset=function(a,b){var a=a+"-"+b,c=null,d,f;for(d in this.m_visible[a])if(this.m_visible[a].hasOwnProperty(d)){for(f=this.m_visible[a][d].length-1;0<=f;f-=1)c=this.m_visible[a][d][f],this.m_invisible[a][d].push(c),c.css({visibility:"hidden"});this.m_visible[a][d].length=0}};
primitives.common.Cache.prototype.clear=function(){var a,b,c;for(a in this.m_visible)if(this.m_visible.hasOwnProperty(a))for(b in this.m_visible[a])if(this.m_visible[a].hasOwnProperty(b)){for(;void 0!==(c=this.m_visible[a][b].pop());)c.remove();for(;void 0!==(c=this.m_invisible[a][b].pop());)c.remove()}};
primitives.common.Cache.prototype.get=function(a,b,c){a=a+"-"+b;b=null;void 0===this.m_visible[a]&&(this.m_visible[a]={},this.m_invisible[a]={});void 0===this.m_visible[a][c]&&(this.m_visible[a][c]=[],this.m_invisible[a][c]=[]);b=this.m_invisible[a][c].pop()||null;null!==b&&(this.m_visible[a][c].push(b),b.css({visibility:"inherit"}));return b};primitives.common.Cache.prototype.put=function(a,b,c,d){this.m_visible[a+"-"+b][c].push(d)};
primitives.common.CanvasGraphics=function(a){this.parent=primitives.common.Graphics.prototype;this.parent.constructor.apply(this,arguments);this.graphicsType=1;this.m_maximum=8E3};primitives.common.CanvasGraphics.prototype=new primitives.common.Graphics;
primitives.common.CanvasGraphics.prototype.clean=function(){var a,b,c,d;for(a in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(a))for(c in b=this.m_placeholders[a],b.layers)b.layers.hasOwnProperty(c)&&(d=b.layers[c],null!==d.canvascanvas&&(d.canvascanvas.remove(),d.canvascanvas=null));this.parent.clean.apply(this,arguments)};
primitives.common.CanvasGraphics.prototype._activatePlaceholder=function(a){var b,c,d;this.parent._activatePlaceholder.apply(this,arguments);b=this.m_activePlaceholder;c=b.size.width;d=b.size.height;b.hasGraphics=c>this.m_maximum||d>this.m_maximum?!1:!0};
primitives.common.CanvasGraphics.prototype.resizePlaceholder=function(a,b,c){var d,f;this.parent.resizePlaceholder.apply(this,arguments);for(d in a.layers)a.layers.hasOwnProperty(d)&&(f=a.layers[d],null!==f.canvascanvas&&(f.canvascanvas.css({position:"absolute",width:b+"px",height:c+"px"}),f.canvascanvas.attr({width:b+"px",height:c+"px"})))};
primitives.common.CanvasGraphics.prototype.begin=function(){var a,b,c,d,f,e;this.parent.begin.apply(this);for(a in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(a))for(c in b=this.m_placeholders[a],f=b.size.width,e=b.size.height,b.layers)b.layers.hasOwnProperty(c)&&(d=b.layers[c],null!==d.canvascanvas&&d.canvascontext.clearRect(0,0,f,e))};
primitives.common.Graphics.prototype._getContext=function(a,b){var c=a.size.width,d=a.size.height;null===b.canvascanvas&&(b.canvascanvas=jQuery("<canvas></canvas>"),b.canvascanvas.attr({width:c+"px",height:d+"px"}),a.activeLayer.canvas.prepend(b.canvascanvas),b.canvascontext=b.canvascanvas[0].getContext("2d"));return b.canvascontext};
primitives.common.CanvasGraphics.prototype.reset=function(a,b){var c="none",d=-1,f,e;switch(arguments.length){case 1:"string"===typeof a?c=a:d=a;break;case 2:c=a,d=b}this.parent.reset.apply(this,arguments);f=this.m_placeholders[c];void 0!==f&&(c=f.size.width,e=f.size.height,d=f.layers[d],void 0!==d&&null!==d.canvascanvas&&d.canvascontext.clearRect(0,0,c,e))};
primitives.common.CanvasGraphics.prototype.polyline=function(a){var b=this.m_activePlaceholder,c,d,f=a.paletteItem.toAttr(),e,g;if(b.hasGraphics){c=b.activeLayer;d=this._getContext(b,c);d.save();void 0!==f.lineWidth&&void 0!==f.borderColor?(d.strokeStyle=f.borderColor,d.lineWidth=f.lineWidth):(d.lineWidth=0,d.strokeStyle="Transparent");if(null!=f.lineType){b=Math.round(f.lineWidth)||1;switch(f.lineType){case 0:e=[];break;case 1:e=[b,b];break;case 2:e=[5*b,3*b]}void 0!==d.setLineDash?d.setLineDash(e):
void 0!==d.webkitLineDash?d.webkitLineDash=e:void 0!==d.mozDash&&(d.mozDash=e)}d.beginPath();a.loop(this,function(a){switch(a.segmentType){case 1:d.moveTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5);break;case 0:d.lineTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5);break;case 4:a.width==a.height&&a.width/2<=a.cornerRadius?(d.moveTo(Math.round(a.x)+a.width+0.5,Math.round(a.y)+a.height/2+0.5),d.arc(Math.round(a.x)+a.width/2+0.5,Math.round(a.y)+a.height/2+0.5,Math.round(a.width/2),0,2*Math.PI,!1)):0===a.cornerRadius?
(d.moveTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5),d.lineTo(Math.round(a.x+a.width)+0.5,Math.round(a.y)+0.5),d.lineTo(Math.round(a.x+a.width)+0.5,Math.round(a.y+a.height)+0.5),d.lineTo(Math.round(a.x)+0.5,Math.round(a.y+a.height)+0.5),d.lineTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5)):(g=Math.min(a.cornerRadius,Math.min(a.width/2,a.height/2)),d.moveTo(Math.round(a.x)+0.5,Math.round(a.y+g)+0.5),d.arc(Math.round(a.x+g)+0.5,Math.round(a.y+g)+0.5,Math.round(g),Math.PI,-Math.PI/2,!1),d.lineTo(Math.round(a.x+
a.width-g)+0.5,Math.round(a.y)+0.5),d.arc(Math.round(a.x+a.width-g)+0.5,Math.round(a.y+g)+0.5,Math.round(g),-Math.PI/2,0,!1),d.lineTo(Math.round(a.x+a.width)+0.5,Math.round(a.y+a.height-g)+0.5),d.arc(Math.round(a.x+a.width-g)+0.5,Math.round(a.y+a.height-g)+0.5,Math.round(g),0,Math.PI/2,!1),d.lineTo(Math.round(a.x+g)+0.5,Math.round(a.y+a.height)+0.5),d.arc(Math.round(a.x+g)+0.5,Math.round(a.y+a.height-g)+0.5,Math.round(g),Math.PI/2,Math.PI,!1),d.lineTo(Math.round(a.x)+0.5,Math.round(a.y+g)+0.5));break;
case 2:d.quadraticCurveTo(Math.round(a.cpX)+0.5,Math.round(a.cpY)+0.5,Math.round(a.x)+0.5,Math.round(a.y)+0.5);break;case 3:d.bezierCurveTo(Math.round(a.cpX1)+0.5,Math.round(a.cpY1)+0.5,Math.round(a.cpX2)+0.5,Math.round(a.cpY2)+0.5,Math.round(a.x)+0.5,Math.round(a.y)+0.5)}});null!=f.opacity&&(d.globalAlpha=f.opacity);void 0!==f.lineWidth&&d.stroke();void 0!==f.fillColor&&(d.fillStyle=f.fillColor,d.fill());d.restore()}else this.parent.polyline.apply(this,arguments)};
primitives.common.Element=function(a,b){this.name=this.ns=null;this.attr={};this.style={};this.children=[];switch(arguments.length){case 1:this.name=a;break;case 2:this.ns=a,this.name=b}};primitives.common.Element.prototype.setAttribute=function(a,b){this.attr[a]=b};primitives.common.Element.prototype.appendChild=function(a){this.children[this.children.length]=a};
primitives.common.Element.prototype.create=function(a){var b=null,c,d,b=null!==this.ns?document.createElementNS(this.ns,this.name):document.createElement(this.name);for(c in this.attr)this.attr.hasOwnProperty(c)&&(void 0!==a?b[c]=this.attr[c]:b.setAttribute(c,this.attr[c]));for(c in this.style)this.style.hasOwnProperty(c)&&(b.style[c]=this.style[c]);for(d=0;d<this.children.length;d+=1)c=this.children[d],"string"===typeof c?b.appendChild(document.createTextNode(c)):b.appendChild(c.create(a));return b};
primitives.common.Element.prototype.update=function(a,b){var c,d,f;for(c in this.style)this.style.hasOwnProperty(c)&&(d=this.style[c],a.style[c]!==d&&(a.style[c]=d));for(c in this.attr)this.attr.hasOwnProperty(c)&&(d=this.attr[c],void 0!==b?a[c]!==d&&(a[c]=d):a.getAttribute(c)!==d&&a.setAttribute(c,d));c=this.children.length;for(d=0;d<c;d+=1)f=this.children[d],"string"===typeof f?a.innerHtml!==f&&(a.innerHtml=f):this.children[d].update(a.children[d],b)};
primitives.common.Layer=function(a){this.name=a;this.svgcanvas=this.canvascanvas=this.canvas=null};primitives.common.Placeholder=function(a){this.name=a;this.layers={};this.div=this.rect=this.size=this.activeLayer=null;this.hasGraphics=!0};primitives.common.SvgGraphics=function(a){this.parent=primitives.common.Graphics.prototype;this.parent.constructor.apply(this,arguments);this._svgxmlns="http://www.w3.org/2000/svg";this.graphicsType=0;this.hasGraphics=!0};
primitives.common.SvgGraphics.prototype=new primitives.common.Graphics;primitives.common.SvgGraphics.prototype.clean=function(){var a,b,c,d;for(a in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(a))for(c in b=this.m_placeholders[a],b.layers)b.layers.hasOwnProperty(c)&&(d=b.layers[c],null!==d.svgcanvas&&(d.svgcanvas.remove(),d.svgcanvas=null));this.parent.clean.apply(this,arguments)};
primitives.common.SvgGraphics.prototype.resizePlaceholder=function(a,b,c){var d,f,e;this.parent.resizePlaceholder.apply(this,arguments);for(d in a.layers)a.layers.hasOwnProperty(d)&&(f=a.layers[d],null!==f.svgcanvas&&(e={position:"absolute",width:b+"px",height:c+"px"},f.svgcanvas.css(e),f.svgcanvas.attr({viewBox:"0 0 "+b+" "+c})))};
primitives.common.SvgGraphics.prototype._getCanvas=function(){var a=this.m_activePlaceholder,b=a.activeLayer,c=a.rect;null===b.svgcanvas&&(b.svgcanvas=jQuery('<svg version = "1.1"></svg>'),b.svgcanvas.attr({viewBox:c.x+" "+c.y+" "+c.width+" "+c.height}),b.svgcanvas.css({width:c.width+"px",height:c.height+"px"}),a.activeLayer.canvas.prepend(b.svgcanvas));return b.svgcanvas};
primitives.common.SvgGraphics.prototype.polyline=function(a){var b=this.m_activePlaceholder,c,d,f=a.paletteItem.toAttr(),e,g,h;c=new primitives.common.Element(this._svgxmlns,"path");void 0!==f.fillColor?(c.setAttribute("fill",f.fillColor),c.setAttribute("fill-opacity",f.opacity)):c.setAttribute("fill-opacity",0);void 0!==f.lineWidth&&void 0!==f.borderColor?(c.setAttribute("stroke",f.borderColor),c.setAttribute("stroke-width",f.lineWidth),void 0!==f.opacity?c.setAttribute("stroke-opacity",f.opacity):
c.setAttribute("stroke-opacity",1)):(c.setAttribute("stroke","transparent"),c.setAttribute("stroke-width",0));if(null!=f.lineType)switch(e=Math.round(f.lineWidth)||1,f.lineType){case 0:c.setAttribute("stroke-dasharray","");break;case 1:c.setAttribute("stroke-dasharray",e+","+e);break;case 2:c.setAttribute("stroke-dasharray",5*e+","+3*e)}d="";a.loop(this,function(a){switch(a.segmentType){case 1:d+="M"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+0.5);break;case 0:d+="L"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+
0.5);break;case 2:d+="Q"+(Math.round(a.cpX)+0.5)+" "+(Math.round(a.cpY)+0.5)+" "+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+0.5);break;case 4:a.width==a.height&&a.width/2<=a.cornerRadius?(g=a.width/2,d+="M"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+a.height/2+0.5),d+="A"+g+" "+g+" 0 0 0 "+(Math.round(a.x+a.width)+0.5)+" "+(Math.round(a.y)+a.height/2+0.5),d+="A"+g+" "+g+" 0 0 0 "+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+a.height/2+0.5)):0===a.cornerRadius?(d+="M"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+
0.5),d+="L"+(Math.round(a.x+a.width)+0.5)+" "+(Math.round(a.y)+0.5),d+="L"+(Math.round(a.x+a.width)+0.5)+" "+(Math.round(a.y+a.height)+0.5),d+="L"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y+a.height)+0.5),d+="L"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+0.5)):(h=Math.min(a.cornerRadius,Math.min(a.width/2,a.height/2)),d+="M"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y+h)+0.5),d+="A"+Math.round(h)+" "+Math.round(h)+" 0 0 1 "+(Math.round(a.x+h)+0.5)+" "+(Math.round(a.y)+0.5),d+="L"+(Math.round(a.x+a.width-
h)+0.5)+" "+(Math.round(a.y)+0.5),d+="A"+Math.round(h)+" "+Math.round(h)+" 0 0 1 "+(Math.round(a.x+a.width)+0.5)+" "+(Math.round(a.y+h)+0.5),d+="L"+(Math.round(a.x+a.width)+0.5)+" "+(Math.round(a.y+a.height-h)+0.5),d+="A"+Math.round(h)+" "+Math.round(h)+" 0 0 1 "+(Math.round(a.x+a.width-h)+0.5)+" "+(Math.round(a.y+a.height)+0.5),d+="L"+(Math.round(a.x+h)+0.5)+" "+(Math.round(a.y+a.height)+0.5),d+="A"+Math.round(h)+" "+Math.round(h)+" 0 0 1 "+(Math.round(a.x)+0.5)+" "+(Math.round(a.y+a.height-h)+0.5),
d+="L"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y+h)+0.5));break;case 3:d+="C"+(Math.round(a.cpX1)+0.5)+" "+(Math.round(a.cpY1)+0.5)+" "+(Math.round(a.cpX2)+0.5)+" "+(Math.round(a.cpY2)+0.5)+" "+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+0.5)}});c.setAttribute("d",d);a=this.m_cache.get(b.name,b.activeLayer.name,"path");null===a?(a=jQuery(c.create()),c=this._getCanvas(),c.append(a),this.m_cache.put(b.name,b.activeLayer.name,"path",a)):c.update(a[0])};
primitives.common.Transform=function(){this.invertVertically=this.invertHorizontally=this.invertArea=!1;this.size=null};
primitives.common.Transform.prototype.setOrientation=function(a){switch(a){case 0:this.invertVertically=this.invertHorizontally=this.invertArea=!1;break;case 1:this.invertHorizontally=this.invertArea=!1;this.invertVertically=!0;break;case 2:this.invertArea=!0;this.invertVertically=this.invertHorizontally=!1;break;case 3:this.invertHorizontally=this.invertArea=!0,this.invertVertically=!1}};
primitives.common.Transform.prototype.getOrientation=function(a){var b=a;if(this.invertHorizontally)switch(a){case 2:b=3;break;case 3:b=2}if(this.invertVertically)switch(a){case 0:b=1;break;case 1:b=0}if(this.invertArea)switch(b){case 0:b=2;break;case 1:b=3;break;case 2:b=0;break;case 3:b=1}return b};
primitives.common.Transform.prototype.transformPoint=function(a,b,c,d,f){var e;c&&this.invertArea&&(e=a,a=b,b=e);this.invertHorizontally&&(a=this.size.width-a);this.invertVertically&&(b=this.size.height-b);!c&&this.invertArea&&(e=a,a=b,b=e);f.call(d,a,b)};
primitives.common.Transform.prototype.transformPoints=function(a,b,c,d,f,e,g){var h;f&&this.invertArea&&(h=a,a=b,b=h,h=c,c=d,d=h);this.invertHorizontally&&(a=this.size.width-a,c=this.size.width-c);this.invertVertically&&(b=this.size.height-b,d=this.size.height-d);!f&&this.invertArea&&(h=a,a=b,b=h,h=c,c=d,d=h);g.call(e,a,b,c,d)};
primitives.common.Transform.prototype.transform3Points=function(a,b,c,d,f,e,g,h,i){var j;g&&this.invertArea&&(j=a,a=b,b=j,j=c,c=d,d=j,j=f,f=e,e=j);this.invertHorizontally&&(a=this.size.width-a,c=this.size.width-c,f=this.size.width-f);this.invertVertically&&(b=this.size.height-b,d=this.size.height-d,e=this.size.height-e);!g&&this.invertArea&&(j=a,a=b,b=j,j=c,c=d,d=j,j=f,f=e,e=j);i.call(h,a,b,c,d,f,e)};
primitives.common.Transform.prototype.transformRect=function(a,b,c,d,f,e,g){var h;f&&this.invertArea&&(h=a,a=b,b=h,h=c,c=d,d=h);this.invertHorizontally&&(a=this.size.width-a-c);this.invertVertically&&(b=this.size.height-b-d);!f&&this.invertArea&&(h=a,a=b,b=h,h=c,c=d,d=h);g.call(e,a,b,c,d)};
primitives.common.VmlGraphics=function(a){var b,c,d;this.parent=primitives.common.Graphics.prototype;this.parent.constructor.apply(this,arguments);this.prefix="rvml";this.ie8mode=document.documentMode&&8<=document.documentMode;try{eval("document.namespaces")}catch(f){}document.namespaces[this.prefix]||document.namespaces.add(this.prefix,"urn:schemas-microsoft-com:vml");if(!primitives.common.VmlGraphics.prototype.vmlStyle){b=primitives.common.VmlGraphics.prototype.vmlStyle=document.createStyleSheet();
c=" *;fill;shape;path;textpath;stroke".split(";");for(d=0;d<c.length;d+=1)b.addRule(this.prefix+"\\:"+c[d],"behavior:url(#default#VML); position:absolute;")}this.graphicsType=2;this.hasGraphics=!0};primitives.common.VmlGraphics.prototype=new primitives.common.Graphics;
primitives.common.VmlGraphics.prototype.text=function(a,b,c,d,f,e,g,h,i){var j,k,l;switch(e){case 0:case 3:this.parent.text.call(this,a,b,c,d,f,e,g,h,i);break;default:j=this.m_activePlaceholder;e=1===e;a=new primitives.common.Rect(a,b,c,d);d=new primitives.common.Rect(0,0,10*c,10*d);c=new primitives.common.Element(this.prefix+":shape");c.setAttribute("CoordSize",d.width+","+d.height);c.setAttribute("filled",!0);c.setAttribute("stroked",!1);c.setAttribute("fillcolor",i["font-color"]);c.style.top=a.y+
"px";c.style.left=a.x+"px";c.style.width=a.width+"px";c.style.height=a.height+"px";c.style["font-family"]=i["font-family"];a=new primitives.common.Element(this.prefix+":path");a.setAttribute("TextPathOk",!0);b=16*Math.floor(this.getPxSize(i["font-size"]))*Math.max(f.split("\n").length-1,1);l=k=null;if(e)switch(h){case 0:k=new primitives.common.Point(d.x+b/2,d.bottom());l=new primitives.common.Point(d.x+b/2,d.y);break;case 1:k=new primitives.common.Point(d.horizontalCenter(),d.bottom());l=new primitives.common.Point(d.horizontalCenter(),
d.y);break;case 2:k=new primitives.common.Point(d.right()-b/2,d.bottom()),l=new primitives.common.Point(d.right()-b/2,d.y)}else switch(h){case 0:k=new primitives.common.Point(d.right()-b/2,d.y);l=new primitives.common.Point(d.right()-b/2,d.bottom());break;case 1:k=new primitives.common.Point(d.horizontalCenter(),d.y);l=new primitives.common.Point(d.horizontalCenter(),d.bottom());break;case 2:k=new primitives.common.Point(d.x+b/2,d.y),l=new primitives.common.Point(d.x+b/2,d.bottom())}a.setAttribute("v",
" m"+k.x+","+k.y+" l"+l.x+","+l.y+" e");h=new primitives.common.Element(this.prefix+":textpath");h.setAttribute("on",!0);h.setAttribute("string",f);h.style.trim=!1;h.style["v-text-align"]=this._getTextAlign(g);h.style.font="normal normal normal "+i["font-size"]+"pt "+i["font-family"];c.appendChild(a);c.appendChild(h);f=this.m_cache.get(j.name,j.activeLayer.name,"vmltext");null===f?(f=jQuery(c.create(this.ie8mode)),j.activeLayer.canvas.append(f),this.m_cache.put(j.name,j.activeLayer.name,"vmltext",
f)):c.update(f[0],this.ie8mode)}};
primitives.common.VmlGraphics.prototype.polyline=function(a){var b=this.m_activePlaceholder,c=new primitives.common.Rect(b.rect),d=new primitives.common.Rect(0,0,10*c.width,10*c.height),f=new primitives.common.Element(this.prefix+":shape"),e,g,h,i,j,k,l;g=a.paletteItem.toAttr();void 0!==g.borderColor&&void 0!==g.lineWidth?(f.setAttribute("strokecolor",g.borderColor),f.setAttribute("strokeweight",g.lineWidth),f.setAttribute("stroked",!0)):f.setAttribute("stroked",!1);f.setAttribute("CoordSize",d.width+
","+d.height);f.style.top=c.y+"px";f.style.left=c.x+"px";f.style.width=c.width+"px";f.style.height=c.height+"px";e="";a.loop(this,function(a){switch(a.segmentType){case 1:e+=" m"+10*Math.round(a.x)+","+10*Math.round(a.y);break;case 0:e+=" l"+10*Math.round(a.x)+","+10*Math.round(a.y);break;case 4:h=Math.round(a.x);i=Math.round(a.y);j=Math.round(a.x+a.width);k=Math.round(a.y+a.height);h>j&&(l=h,h=j,j=l);i>k&&(l=i,i=k,k=l);h=10*h+5;i=10*i+5;j=10*j-5;k=10*k-5;e+=" m"+h+","+i;e+=" l"+j+","+i;e+=" l"+j+
","+k;e+=" l"+h+","+k;e+=" l"+h+","+i;break;case 2:e+=" qb"+10*Math.round(a.cpX)+","+10*Math.round(a.cpY)+" l"+10*Math.round(a.x)+","+10*Math.round(a.y);break;case 3:e+=" c"+10*Math.round(a.cpX1)+","+10*Math.round(a.cpY1)+","+10*Math.round(a.cpX2)+","+10*Math.round(a.cpY2)+","+10*Math.round(a.x)+","+10*Math.round(a.y)}});e+=" e";a="shapepath";c=new primitives.common.Element(this.prefix+":path");c.setAttribute("v",e);f.appendChild(c);if(null!=g.lineType){c=new primitives.common.Element(this.prefix+
":stroke");switch(g.lineType){case 0:c.setAttribute("dashstyle","Solid");break;case 1:c.setAttribute("dashstyle","ShortDot");break;case 2:c.setAttribute("dashstyle","Dash")}f.appendChild(c);a+="stroke"}null!==g.fillColor?(f.setAttribute("filled",!0),c=new primitives.common.Element(this.prefix+":fill"),c.setAttribute("opacity",g.opacity),c.setAttribute("color",g.fillColor),f.appendChild(c),a+="fill"):f.setAttribute("filled",!1);g=this.m_cache.get(b.name,b.activeLayer.name,a);null===g?(g=jQuery(f.create(this.ie8mode)),
b.activeLayer.canvas.append(g),this.m_cache.put(b.name,b.activeLayer.name,a,g)):f.update(g[0],this.ie8mode)};primitives.common.ArrayReader=function(a,b,c,d,f){this.itemTemplate=a;this.containsUniqueItems=b;this.uniquePropertyKey=c;this.containsPrimitiveValues=primitives.common.isNullOrEmpty(c);this.createSourceHash=d;this.isOrdered=f};
primitives.common.ArrayReader.prototype.read=function(a,b,c,d){var f=[],e={},g,h,i={},j={},k,l,m,n,p,r=c+"-seq";if(!b||!primitives.common.isArray(b))b=[];g=d.hash[c]||{};h=d.hash[r]||{};m=0;for(n=b.length;m<n;m+=1)k=b[m],l=this.containsUniqueItems?this.containsPrimitiveValues?k:k[this.uniquePropertyKey]:m,e.hasOwnProperty(l)||(p=this.itemTemplate.read(g[l]||{},k,c+"-"+m,d),f.push(p),e[l]=p,i[m]=l,this.createSourceHash&&(j[l]=k),this.isOrdered&&h[m]!=i[m]&&(d.isChanged=!0));d.hash[c]=e;d.hash[r]=i;
this.createSourceHash&&(d.sourceHash[c]=j);if(null==a||a.length!=f.length)d.isChanged=!0;return f};primitives.common.EnumerationReader=function(a,b,c){this.enumeration=a;this.isNullable=b;this.defaultValue=c;this.hash={};for(var d in a)this.hash[a[d]]=d};primitives.common.EnumerationReader.prototype.read=function(a,b,c,d){if(null===b||"undefined"==typeof b||!this.hash.hasOwnProperty(b))b=this.isNullable?null:this.defaultValue;a!==b&&(d.isChanged=!0);return b};primitives.common.FunctionReader=function(){};
primitives.common.FunctionReader.prototype.read=function(a,b){return"function"==typeof b?b:null};primitives.common.ObjectReader=function(a,b,c){this.dataTemplate=a;this.isNullable=b;this.defaultValue=c};
primitives.common.ObjectReader.prototype.read=function(a,b,c,d){var f=null,e,g;b||(b=this.isNullable?null:this.defaultValue);if(primitives.common.isObject(b))for(e in f={},this.dataTemplate)this.dataTemplate.hasOwnProperty(e)&&(g=this.dataTemplate[e],f[e]=g.read(primitives.common.isObject(a)?a[e]:null,b[e],c+"-"+e,d));else f=b,a!==b&&(d.isChanged=!0);return f};
primitives.common.ValueReader=function(a,b,c){this.acceptedTypes=a;this.isNullable=b;this.defaultValue=c;this.hash={};for(b=0;b<a.length;b+=1)this.hash[a[b]]=!0};primitives.common.ValueReader.prototype.read=function(a,b,c,d){if(null===b||"undefined"==typeof b||!this.hash.hasOwnProperty(typeof b))b=this.isNullable?null:this.defaultValue;a!==b&&(d.isChanged=!0);return b};
primitives.famdiagram.EventArgs=function(){this.context=this.oldContext=null;this.parentItems=[];this.childrenItems=[];this.name=this.position=null;this.cancel=!1};
primitives.famdiagram.TemplateConfig=function(){this.name=null;this.isActive=!0;this.itemSize=new primitives.common.Size(120,100);this.itemBorderWidth=1;this.minimizedItemShapeType=this.itemTemplate=null;this.minimizedItemSize=new primitives.common.Size(4,4);this.minimizedItemCornerRadius=null;this.minimizedItemLineWidth=1;this.minimizedItemBorderColor=null;this.minimizedItemLineType=0;this.minimizedItemFillColor=null;this.minimizedItemOpacity=1;this.highlightPadding=new primitives.common.Thickness(2,
2,2,2);this.highlightBorderWidth=1;this.highlightTemplate=null;this.cursorPadding=new primitives.common.Thickness(3,3,3,3);this.cursorBorderWidth=2;this.buttons=this.cursorTemplate=null};
primitives.famdiagram.BackgroundAnnotationConfig=function(a){var b;this.annotationType=4;this.items=[];this.zOrderType=0;this.offset=new primitives.common.Thickness(18,18,18,18);this.lineWidth=2;this.opacity=1;this.fillColor=this.borderColor=null;this.lineType=0;this.selectItems=!1;switch(arguments.length){case 1:if(null!==a)if(a instanceof Array)this.items=a;else if("object"==typeof a)for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};
primitives.famdiagram.ButtonConfig=function(a,b,c){this.name=a;this.icon=b;this.text=!1;this.label=null;this.tooltip=c;this.size=new primitives.common.Size(16,16)};
primitives.famdiagram.Config=function(a){this.name=void 0!==a?a:"FamDiagram";this.classPrefix="famdiagram";this.graphicsType=this.navigationMode=0;this.pageFitMode=3;this.minimalVisibility=2;this.orientationType=0;this.verticalAlignment=1;this.arrowsDirection=0;this.showExtraArrows=!0;this.extraArrowsMinimumSpace=30;this.groupByType=2;this.alignBylevels=!0;this.enableMatrixLayout=!1;this.minimumMatrixSize=4;this.maximumColumnsInMatrix=6;this.hideGrandParentsConnectors=!1;this.elbowType=3;this.elbowDotSize=
this.bevelSize=4;this.emptyDiagramMessage="Diagram is empty.";this.items=[];this.annotations=[];this.highlightItem=this.cursorItem=null;this.highlightGravityRadius=40;this.selectedItems=[];this.hasSelectorCheckbox=0;this.selectCheckBoxLabel="Selected";this.neighboursSelectionMode=this.selectionPathMode=0;this.templates=[];this.defaultLabelAnnotationTemplate=this.defaultTemplateName=null;this.hasButtons=0;this.buttons=[];this.onCursorRender=this.onHighlightRender=this.onItemRender=this.onMouseDblClick=
this.onMouseClick=this.onButtonClick=this.onSelectionChanged=this.onSelectionChanging=this.onCursorChanged=this.onCursorChanging=this.onHighlightChanged=this.onHighlightChanging=null;this.dotLevelShift=this.normalLevelShift=20;this.normalItemsInterval=this.lineLevelShift=10;this.dotItemsInterval=1;this.lineItemsInterval=2;this.cousinsIntervalMultiplier=5;this.itemTitleFirstFontColor="#ffffff";this.itemTitleSecondFontColor="#000080";this.minimizedItemShapeType=6;this.linesColor="#c0c0c0";this.linesWidth=
1;this.linesType=0;this.showNeigboursConnectorsHighlighted=!1;this.highlightLinesColor="#ff0000";this.highlightLinesWidth=1;this.highlightLinesType=0;this.linesPalette=[];this.calloutMaximumVisibility=2;this.showCallout=!0;this.calloutPlacementOffset=100;this.defaultCalloutTemplateName=null;this.calloutfillColor="#000000";this.calloutBorderColor=null;this.calloutCornerRadius=this.calloutOffset=4;this.calloutPointerWidth="10%";this.calloutLineWidth=1;this.calloutOpacity=0.2;this.buttonsPanelSize=28;
this.checkBoxPanelSize=this.groupTitlePanelSize=24;this.groupTitleOrientation=this.groupTitlePlacementType=2;this.groupTitleVerticalAlignment=1;this.groupTitleHorizontalAlignment=0;this.groupTitleFontSize="12px";this.groupTitleFontFamily="Arial";this.groupTitleColor="#4169e1";this.groupTitleFontStyle=this.groupTitleFontWeight="normal";this.distance=3;this.scale=1;this.minimumScale=0.5;this.maximumScale=1;this.showLabels=0;this.labelSize=new primitives.common.Size(80,24);this.labelOffset=1;this.labelOrientation=
0;this.labelPlacement=1;this.labelFontSize="10px";this.labelFontFamily="Arial";this.labelColor="#000000";this.labelFontStyle=this.labelFontWeight="normal";this.enablePanning=!0;this.autoSizeMinimum=new primitives.common.Size(800,600);this.autoSizeMaximum=new primitives.common.Size(1024,768)};
primitives.famdiagram.ConnectorAnnotationConfig=function(a,b){var c;this.annotationType=0;this.zOrderType=2;this.toItem=this.fromItem=null;this.connectorPlacementType=this.connectorShapeType=0;this.labelPlacementType=1;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=2;this.color="#000000";this.lineType=0;this.selectItems=!0;this.label=null;this.labelSize=new primitives.common.Size(60,30);switch(arguments.length){case 1:for(c in a)a.hasOwnProperty(c)&&(this[c]=a[c]);break;case 2:this.fromItem=
a,this.toItem=b}};primitives.famdiagram.HighlightPathAnnotationConfig=function(a){var b;this.zOrderType=this.annotationType=2;this.items=[];this.lineWidth=2;this.color="#ff0000";this.lineType=0;this.opacity=1;this.showArrows=!0;this.selectItems=!1;switch(arguments.length){case 1:if(null!==a)if(a instanceof Array)this.items=a;else if("object"==typeof a)for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};
primitives.famdiagram.ItemConfig=function(a,b,c,d,f){var e;this.id=null;this.parents=[];this.spouses=[];this.context=this.image=this.description=this.title=null;this.itemTitleColor="#4169e1";this.groupTitle=this.minimizedItemShapeType=null;this.groupTitleColor="#4169e1";this.isActive=!0;this.hasButtons=this.hasSelectorCheckbox=0;this.templateName=null;this.showCallout=0;this.label=this.calloutTemplateName=null;this.showLabel=0;this.labelSize=null;this.labelOrientation=3;this.labelPlacement=0;switch(arguments.length){case 1:for(e in a)a.hasOwnProperty(e)&&
(this[e]=a[e]);break;case 5:this.id=a,this.parent=b,this.title=c,this.description=d,this.image=f}};primitives.famdiagram.LabelAnnotationConfig=function(a,b){var c;this.annotationType=3;this.fromItem=null;this.toItems=[];this.title=null;this.itemTitleColor="#4169e1";this.templateName=null;switch(arguments.length){case 1:for(c in a)a.hasOwnProperty(c)&&(this[c]=a[c]);break;case 2:this.fromItem=a,this.toItem=b}};
primitives.famdiagram.PaletteItemConfig=function(a,b,c){var d;this.lineColor="#c0c0c0";this.lineWidth=1;this.lineType=0;switch(arguments.length){case 1:for(d in a)a.hasOwnProperty(d)&&(this[d]=a[d]);break;case 3:this.lineColor=a,this.lineWidth=b,this.lineType=c}};
primitives.famdiagram.ShapeAnnotationConfig=function(a){var b;this.annotationType=1;this.zOrderType=0;this.items=[];this.shapeType=0;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=2;this.cornerRadius="10%";this.opacity=1;this.fillColor=this.borderColor=null;this.lineType=0;this.selectItems=!1;this.label=null;this.labelSize=new primitives.common.Size(60,30);this.labelPlacement=0;this.labelOffset=4;switch(arguments.length){case 1:if(null!==a)if(a instanceof Array)this.items=a;else if("object"==
typeof a)for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};primitives.famdiagram.EdgeItem=function(a,b,c,d){this.values=[b,d];this[a]=0;this[c]=1};primitives.famdiagram.EdgeItem.prototype.getNear=function(a){return this.values[this[a]]};primitives.famdiagram.EdgeItem.prototype.getFar=function(a){return this.values[Math.abs(this[a]-1)]};primitives.famdiagram.EdgeItem.prototype.setNear=function(a,b){this.values[this[a]]=b};
primitives.famdiagram.EdgeItem.prototype.setFar=function(a,b){this.values[Math.abs(this[a]-1)]=b};primitives.famdiagram.EdgeItem.prototype.toString=function(){return this.parent+","+this.child};
primitives.famdiagram.FamilyItem=function(a){var b;this.itemConfig=this.familyId=this.id=null;this.isActive=this.isVisible=!0;this.isLevelNeutral=!1;this.level=null;this.levelGravity=0;this.hideChildrenConnection=this.hideParentConnection=!1;switch(arguments.length){case 1:for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};primitives.famdiagram.Slot=function(a){this.position=this.next=this.prev=this.id=null;this.balance=0;this.itemId=a;this.left={};this.right={};this.crossings={}};
primitives.famdiagram.Slot.prototype.clone=function(){var a=new primitives.famdiagram.Slot,b;a.itemId=this.itemId;for(b in this.left)this.left.hasOwnProperty(b)&&(a.left[b]=this.left[b]);for(b in this.right)this.right.hasOwnProperty(b)&&(a.right[b]=this.right[b]);for(b in this.crossings)this.crossings.hasOwnProperty(b)&&(a.crossings[b]=this.crossings[b]);return a};primitives.famdiagram.Slots=function(){this.last=this.first=null;this.slots={};this.items={};this.counter=0};
primitives.famdiagram.Slots.prototype.add=function(a){a.id=this.counter;this.counter+=1;this.slots[a.id]=a;null!=a.itemId&&(this.items[a.itemId]=a);null==this.last?this.first=this.last=a.id:(this.slots[this.last].next=a.id,a.prev=this.last,this.last=a.id)};
primitives.famdiagram.Slots.prototype.insertBefore=function(a,b){b.id=this.counter;this.counter+=1;this.slots[b.id]=b;null!=b.itemId&&(this.items[b.itemId]=b);if(null==a.prev)b.next=a.id,this.first=b.id;else{var c=this.slots[a.prev];c.next=b.id;b.next=a.id;a.prev=b.id;b.prev=c.id}};primitives.famdiagram.Slots.prototype.loop=function(a,b){for(var c=null!=b?b.id:this.first;null!=c;){c=this.slots[c];if(a(c))break;c=c.next}};
primitives.famdiagram.Slots.prototype.backwardLoop=function(a,b){for(var c=null!=b?b.id:this.last;null!=c;){c=this.slots[c];if(a(c))break;c=c.prev}};primitives.famdiagram.Slots.prototype.getSlot=function(a){return this.items[a]};
primitives.famdiagram.LabelAnnotationOptionTask=function(a,b,c){var d=[],f={},e=null,g={},h=new primitives.common.ArrayReader(new primitives.common.ObjectReader({zOrderType:new primitives.common.EnumerationReader(primitives.common.ZOrderType,!1,c.zOrderType),fromItem:new primitives.common.ValueReader(["string","number"],!0),toItems:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0),title:new primitives.common.ValueReader(["string"],!0),itemTitleColor:new primitives.common.ValueReader(["string"],
!1,c.itemTitleColor),templateName:new primitives.common.ValueReader(["string"],!0)},!1),!1,null,!0);return{process:function(){var c={isChanged:!1,hash:g,sourceHash:{}},j=b.getMaximumId(),k,l,m;d=h.read(d,a.getAnnotations(3),"annotations",c);f={};var n=c.sourceHash.annotations;k=0;for(l=d.length;k<l;k+=1)m=d[k],j+=1,m.id=j,f[m.id]=n[k];e=j;return c.isChanged},getAnnotations:function(){return d},getMaximumId:function(){return e},getConfig:function(a){return f[a]}}};
primitives.famdiagram.LabelAnnotationPlacementOptionTask=function(a){var b=[],c={},d=new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["number"],!0),fromItem:new primitives.common.ValueReader(["string","number"],!0),toItems:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0)}),!0,"id");return{process:function(){var f={isChanged:!1,hash:c};b=d.read(b,a.getAnnotations(),"annotations",f);return f.isChanged},
getAnnotations:function(){return b},getMaximumId:function(){return a.getMaximumId()}}};
primitives.famdiagram.LabelAnnotationTemplateOptionTask=function(a,b){var c=[],d={},f=new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["number"],!0),title:new primitives.common.ValueReader(["string"],!0),itemTitleColor:new primitives.common.ValueReader(["string"],!1,b.itemTitleColor),templateName:new primitives.common.ValueReader(["string"],!0)}),!0,"id");return{process:function(){var b={isChanged:!1,hash:d};c=f.read(c,a.getAnnotations(),
"annotations",b);return b.isChanged},getAnnotations:function(){return c}}};primitives.famdiagram.NeighboursSelectionModeOptionTask=function(a,b){var c={},d=new primitives.common.ObjectReader({neighboursSelectionMode:new primitives.common.EnumerationReader(primitives.common.NeighboursSelectionMode,!1,b.neighboursSelectionMode)});return{process:function(){var b={isChanged:!1};c=d.read(c,a.getOptions(),"options",b);return b.isChanged},getNeighboursSelectionMode:function(){return c.neighboursSelectionMode}}};
primitives.famdiagram.ItemsOptionTask=function(a,b){var c={},d={},f={},e=new primitives.common.ObjectReader({items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string","number"],!0),parents:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0),isActive:new primitives.common.ValueReader(["boolean"],!1,b.isActive)}),!0,"id",!0)});return{process:function(){var b={isChanged:!1,hash:d,sourceHash:f};
c=e.read(c,a.getOptions(),"options",b);return b.isChanged},getItems:function(){return c.items},getConfig:function(a){return f["options-items"][a]}}};
primitives.famdiagram.LinePaletteOptionTask=function(a,b){var c={},d={},f=new primitives.common.ObjectReader({linesPalette:new primitives.common.ArrayReader(new primitives.common.ObjectReader({lineColor:new primitives.common.ValueReader(["string"],!1,b.lineColor),lineWidth:new primitives.common.ValueReader(["number"],!1,b.lineWidth),lineType:new primitives.common.EnumerationReader(primitives.common.LineType,!1,b.lineType)}),!1)});return{process:function(){var b={isChanged:!1,hash:d};c=f.read(c,a.getOptions(),
"options",b);return b.isChanged},getOptions:function(){return c}}};
primitives.famdiagram.NormalizeOptionTask=function(a,b){var c={},d={},f=new primitives.common.ObjectReader({groupByType:new primitives.common.EnumerationReader(primitives.common.GroupByType,!1,b.groupByType),alignBylevels:new primitives.common.ValueReader(["boolean"],!1,b.alignBylevels),hideGrandParentsConnectors:new primitives.common.ValueReader(["boolean"],!1,b.hideGrandParentsConnectors),enableMatrixLayout:new primitives.common.ValueReader(["boolean"],!1,b.enableMatrixLayout),minimumMatrixSize:new primitives.common.ValueReader(["number"],
!1,b.minimumMatrixSize),maximumColumnsInMatrix:new primitives.common.ValueReader(["number"],!1,b.maximumColumnsInMatrix)});return{process:function(){var b={isChanged:!1,hash:d};c=f.read(c,a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return c}}};primitives.famdiagram.OptionsTask=function(a){return{process:function(){return!0},getOptions:a,description:"Raw options."}};
primitives.famdiagram.SpousesOptionTask=function(a){var b={},c={},d=new primitives.common.ObjectReader({items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string","number"],!0),spouses:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0)}),!0,"id")});return{process:function(){var f={isChanged:!1,hash:c};b=d.read(b,a.getOptions(),"options",f);return f.isChanged},getItems:function(){return b.items}}};
primitives.famdiagram.VisualTreeOptionTask=function(){var a={leavesPlacementType:2,childrenPlacementType:2,maximumColumnsInMatrix:6,horizontalAlignment:0};return{process:function(){return!1},getOptions:function(){return a}}};primitives.famdiagram.CombinedTemplateParamsTask=function(a,b){return{process:function(){return!0},getTemplateParams:function(c){return a.getTemplateParams(c)||b.getTemplateParams(c)}}};
primitives.famdiagram.LabelAnnotationTemplateParamsTask=function(a,b,c){var d={};return{process:function(){var f=a.getOptions(),e=b.getAnnotations(),g,h;d={};g=0;for(h=e.length;g<h;g+=1){var i=e[g],j=new primitives.orgdiagram.TemplateParams,k=c.getTemplate(i.templateName,f.defaultLabelAnnotationTemplate,c.DefaultWidgetLabelAnnotationTemplateName);j.template=k;d[i.id]=j}return!0},getTemplateParams:function(a){return d[a]}}};primitives.famdiagram.BaseTransformer=function(a){this.debug=a};
primitives.famdiagram.BaseTransformer.prototype.validate=function(a,b){if(!a.validate())throw"Family structure failed to pass validation!";a.loop(this,function(c,d){a.loopChildren(this,c,function(c,e){if(null===e.level||null===d.level||(b?e.level!=d.level+1:e.level<=d.level))throw"Family tree is broken. Children/Parents or levels mismatch!";return a.SKIP})})};primitives.famdiagram.FamilyBalance=function(){this.properties="title description image itemTitleColor groupTitle groupTitleColor isActive hasSelectorCheckbox hasButtons templateName showCallout calloutTemplateName label showLabel labelSize labelOrientation labelPlacement minimizedItemShapeType".split(" ")};
primitives.famdiagram.FamilyBalance.prototype.balance=function(a){var b={maximumId:null,treeLevels:primitives.common.TreeLevels(),bundles:[],connectorStacks:[]},c={orgTree:primitives.common.tree(),maximumId:a.maximumId,orgPartners:{},itemByChildrenKey:{},minimumLevel:null,maximumLevel:null};this.createOrgTree(a,c);c.orgTree.loopLevels(this,function(a,c,e){b.treeLevels.addItem(e,a,c)});this.recalcLevelsDepth(b.bundles,b.connectorStacks,b.treeLevels,c.orgTree,c.orgPartners);b.maximumId=c.maximumId;
return b};primitives.famdiagram.FamilyBalance.prototype.Family=function(a){this.id=null;this.familyPriority=1;this.childFamilies=[];this.items=[];this.links=[];this.backLinks=[];1==arguments.length&&(this.id=a)};primitives.famdiagram.FamilyBalance.prototype.FamLink=function(a,b){this.fromItem=a;this.toItem=b};
primitives.famdiagram.FamilyBalance.prototype.createOrgTree=function(a,b){var c,d,f,e,g,h,i,j,k=[],l,m,n,p,r,q,s,u,t,y,v=[],A;if(0<a.logicalFamily.hasNodes()){y={};m=0;A=[];a.logicalFamily.loopRoots(this,function(c){n=new this.Family(m);this.extractOrgChart(c,a.logicalFamily,a.defaultItemConfig,b.orgTree,b.orgPartners,b.itemByChildrenKey,y,n);v.push(n);A.push(n);m+=1});A.sort(function(a,b){var c=a.items[0].level,d=b.items[0].level;return c!=d?c-d:b.items.length-a.items.length});k=[];l={};if(0<v.length){g=
primitives.common.graph();c=0;for(d=v.length;c<d;c+=1){n=v[c];f=0;for(e=n.links.length;f<e;f+=1)h=n.links[f],i=a.logicalFamily.node(h.fromItem).familyId,j=a.logicalFamily.node(h.toItem).familyId,i!=j&&(g.addEdge(i,j,{weight:0}),g.edge(i,j).weight+=1),v[j].backLinks.push(new this.FamLink(h.toItem,h.fromItem))}for(;k.length<v.length;){c=0;for(d=A.length;c<d;c+=1)n=A[c],l.hasOwnProperty(n.id)||(u=g.getSpanningTree(n.id,function(a){return-a.weight}),null!=u.node(n.id)?(u.loopPostOrder(this,function(a,
b,c){var b=v[a],d=v[c],e=[];null!=c&&(d.familyPriority+=b.familyPriority);e=[];u.loopChildren(this,a,function(a){e.push(a)});e.sort(function(a,b){return v[a].familyPriority-v[b].familyPriority});u.arrangeChildren(a,e)}),u.loopPreOrder(this,function(a){k.push(a);l[a]=!0})):(k.push(n.id),l[n.id]=!0))}}b.maximumId+=1;t=this.createOrgItem(b.orgTree,a.defaultItemConfig,b.maximumId,null,null,b.minimumLevel-1,null);t.hideParentConnection=!0;t.hideChildrenConnection=!0;t.title="internal root";t.isVisible=
!1;t.isActive=!1;t.childIndex=0;g={};c=0;for(d=k.length;c<d;c+=1){n=v[k[c]];j={};q=t;s=0;e=n.links.concat(n.backLinks);for(f=0;f<e.length;f+=1)h=e[f],i=b.orgTree.node(h.toItem),b.orgTree.node(h.fromItem),!0===g[i.familyId]&&(p=n.items[0],r=i,r.level>=p.level&&b.orgTree.loopParents(this,r.id,function(a,b){r=b;if(b.level<p.level)return!0}),j[r.id]=j.hasOwnProperty(r.id)?j[r.id]+1:1,s<j[r.id]&&(q=r,s=j[r.id]));this.attachFamilyToOrgChart(b,a.defaultItemConfig,q,n);g[n.id]=!0}c=this.getExtraGravity(b);
d=this.getGrandChildren(b);this.balanceOrgTree(b.orgTree,c,d)}};
primitives.famdiagram.FamilyBalance.prototype.getGrandChildren=function(a){var b={};a.orgTree.loopPostOrder(this,function(c,d,f){a.minimumLevel=null!=a.minimumLevel?Math.min(a.minimumLevel,d.level):d.level;a.maximumLevel=null!=a.maximumLevel?Math.max(a.maximumLevel,d.level):d.level;if(null!=f&&(b[f]||(b[f]={}),d=d.level-1,b[f][d]=b[f][d]?b[f][d]+1:1,null!=b[c]))for(d in b[c])b[c].hasOwnProperty(d)&&(b[f][d]=b[f][d]?b[f][d]+b[c][d]:b[c][d])});return b};
primitives.famdiagram.FamilyBalance.prototype.balanceOrgTree=function(a,b,c){var d,f,e,g,h,i,j,k,l,m,n;a.loopLevels(this,function(p,r){var q=primitives.common.graph(),s={},u=null,t;j=[];a.loopChildren(this,r.id,function(c,e,g){var k;null==u&&(u=e);s[e.id]={};if(b.hasOwnProperty(e.id))for(k in i=b[e.id],i)if(i.hasOwnProperty(k)){m=i[k];s[e.id][k]={};d=0;for(f=m.length;d<f;d+=1)h=m[d],t=h.commonParent==r.id?h.toParent:a.node(h.fromParent).childIndex<a.node(h.toParent).childIndex?"__right__":"__left__",
e.id!=t&&(q.addEdge(e.id,t,{weight:0}),q.edge(e.id,t).weight+=1,null==s[e.id][k][t]&&(s[e.id][k][t]=0),s[e.id][k][t]+=1)}0<g&&q.addEdge(e.id,u.id,{weight:0})});if(null!=u){n=[];q.getTotalWeightGrowthSequence(this,function(a){return a.weight},function(a){n.push(a)});0===n.length&&(n=[u.id]);k=this.balanceItems(n,"__left__","__right__",s,c);e=0;for(g=k.length;e<g;e+=1)l=a.node(k[e]),l.childIndex=e,j.push(l.id)}a.arrangeChildren(r.id,j)})};
primitives.famdiagram.FamilyBalance.prototype.balanceItems=function(a,b,c,d,f){var e=[],g,h,i,j,k,l,m,n,p,r,q,s,u,t,y,v,A,w,x,z;h=new primitives.famdiagram.Slots;h.add(new primitives.famdiagram.Slot(b));h.add(new primitives.famdiagram.Slot(null));h.add(new primitives.famdiagram.Slot(c));i=0;h.loop(function(a){i+=1;a.position=i});for(g=0;g<a.length;g+=1)if(j=a[g],j!=b&&j!=c)for(A in p=n=m=l=k=null,h.loop(function(a){var b,c,e,g;if(null==a.itemId){t=f[j];u=s=q=r=0;for(b in a.crossings)a.crossings.hasOwnProperty(b)&&
(t&&null!=t[b]&&(r+=a.crossings[b]*t[b]),u+=a.crossings[b]);for(b in d[j])if(d[j].hasOwnProperty(b))for(c in e=d[j][b],e)e.hasOwnProperty(c)&&(g=h.getSlot(c),null!=g&&(g.position<a.position?(r+=(a.left[b]||0)-(g.left[b]||0),s+=Math.abs(g.balance+1)):(r+=(a.right[b]||0)-(g.right[b]||0),s+=Math.abs(g.balance-1)),q+=Math.abs(g.position-a.position)));if(null==l||l>r||l==r&&(m>q||m==q&&(n>s||n==s&&p>u)))l=r,k=a,m=q,n=s,p=u}}),y=k.clone(),v=k.clone(),v.itemId=j,h.insertBefore(k,y),h.insertBefore(k,v),i=
v.position=0,h.loop(function(a){var b,c;if(a.id!=v.id){c=f[j];for(b in c)c.hasOwnProperty(b)&&(a.left[b]=a.left[b]?a.left[b]+c[b]:c[b]);i+=1;a.position=i}},v),i=0,h.backwardLoop(function(a){var b,c;if(a.id!=v.id){c=f[j];for(b in f[j])f[j].hasOwnProperty(b)&&(a.right[b]=a.right[b]?a.right[b]+c[b]:c[b]);i-=1;a.position=i}},v),d[j])if(d[j].hasOwnProperty(A))for(x in w=d[j][A],w)w.hasOwnProperty(x)&&(z=h.getSlot(x),null!=z&&(0>z.position?(z.balance+=1,v.balance-=1,h.backwardLoop(function(a){if(a.id!=
v.id)if(a.id!=z.id)a.crossings[A]=a.crossings[A]?a.crossings[A]+w[x]:w[x];else return!0},v)):(z.balance-=1,v.balance+=1,h.loop(function(a){if(a.id!=v.id)if(a.id!=z.id)a.crossings[A]=a.crossings[A]?a.crossings[A]+w[x]:w[x];else return!0},v))));h.loop(function(a){a=a.itemId;null!=a&&(a!=b&&a!=c)&&e.push(a)});return e};primitives.famdiagram.FamilyBalance.prototype.ExtraGravity=function(a){this.toParent=this.fromParent=this.commonParent=null;this.level=a};
primitives.famdiagram.FamilyBalance.prototype.getExtraGravity=function(a){var b,c,d={},f,e,g,h;for(b in a.orgPartners)if(a.orgPartners.hasOwnProperty(b)){c=a.orgTree.node(b);g=a.orgPartners[b];f=0;for(e=g.length;f<e;f+=1)h=a.orgTree.node(g[f]),this.addExtraGravitiesForConnection(a.orgTree,d,h,c)}return d};
primitives.famdiagram.FamilyBalance.prototype.addExtraGravitiesForConnection=function(a,b,c,d){var f=new this.ExtraGravity(c.level),e=new this.ExtraGravity(d.level);a.zipUp(this,c.id,d.id,function(a,c,d,j){this.addExtraGravityForItem(b,a,f);this.addExtraGravityForItem(b,d,e);if(c==j)return f.commonParent=c,f.fromParent=a,f.toParent=d,e.commonParent=c,e.fromParent=d,e.toParent=a,!0})};
primitives.famdiagram.FamilyBalance.prototype.addExtraGravityForItem=function(a,b,c){a.hasOwnProperty(b)||(a[b]={});null==a[b][c.level]&&(a[b][c.level]=[]);a[b][c.level].push(c)};
primitives.famdiagram.FamilyBalance.prototype.attachFamilyToOrgChart=function(a,b,c,d){for(var f=d.items[0],e=null,e=c,c=c.level+1;c<f.level;c+=1)a.maximumId+=1,e=this.createOrgItem(a.orgTree,b,a.maximumId,e.id,null,c,null),e.title="shift",e.isVisible=!1,e.isActive=!1,e.hideParentConnection=!0,e.hideChildrenConnection=!0,d.items.push(e);f.hideParentConnection=!0;a.orgTree.adopt(e.id,f.id,f)};
primitives.famdiagram.FamilyBalance.prototype.extractOrgChart=function(a,b,c,d,f,e,g,h){var i,j=[],k,l,a=b.node(a),j=this.createOrgItem(d,c,a.id,null,h.id,a.level,a.itemConfig);j.hideParentConnection=!0;j.isVisible=a.isVisible;j.isActive=a.isActive;j.hideParentConnection=a.hideParentConnection;j.hideChildrenConnection=a.hideChildrenConnection;h.items.push(j);g[a.id]=!0;a.familyId=h.id;for(j=this.extractChildren(a,b,c,d,f,e,g,h);0<j.length;){k=[];a=0;for(i=j.length;a<i;a+=1)l=j[a],k=k.concat(this.extractChildren(l,
b,c,d,f,e,g,h));j=k}};
primitives.famdiagram.FamilyBalance.prototype.extractChildren=function(a,b,c,d,f,e,g,h){var i=[],j=null,k=null,l;1==b.countChildren(a.id)&&(j=b.firstChild(a.id));null!=e[j]?(k=e[j],null==f[k.id]&&(f[k.id]=[]),f[k.id].push(a.id),h.links.push(new this.FamLink(a.id,j))):(null!=j&&(e[j]=a),b.loopChildren(this,a.id,function(e,f){if(g[f.id])throw"Many to many relations should not exist at this stage";i.push(f);l=this.createOrgItem(d,c,f.id,a.id,h.id,f.level,f.itemConfig);l.hideParentConnection=f.hideParentConnection;
l.hideChildrenConnection=f.hideChildrenConnection;l.isVisible=f.isVisible;l.isActive=f.isActive;h.items.push(l);g[f.id]=!0;f.familyId=h.id;return b.SKIP}));return i};primitives.famdiagram.FamilyBalance.prototype.createOrgItem=function(a,b,c,d,f,e,g){var h=new primitives.orgdiagram.OrgItem({});h.id=c;h.familyId=f;h.level=e;c=0;for(f=this.properties.length;c<f;c+=1)e=this.properties[c],h[e]=null!=g&&void 0!==g[e]?g[e]:b[e];a.add(d,h.id,h);return h};
primitives.famdiagram.FamilyBalance.prototype.recalcLevelsDepth=function(a,b,c,d,f){var e,g,h,i,j,k,l,m,n,p={},r,q,s;c.loopLevels(this,function(u){var t=new primitives.orgdiagram.TreeLevelConnectorStackSize;b[u]=t;n=[];c.loopLevelItems(this,u,function(b,c){var h=[],k=[],j;if(!p.hasOwnProperty(b)){p[b]=!0;c.hideChildrenConnection||h.push(b);j=f[b];if(null!=j){e=0;for(g=j.length;e<g;e+=1){var l=j[e];p[l]=!0;h.push(l)}}d.loopChildren(this,b,function(a,b){b.hideParentConnection||k.push(a)});if(1<h.length||
0<k.length)m=new primitives.common.VerticalConnectorBundle(h,k),a.push(m),1<h.length&&n.push(m)}});if(0<n.length){s=primitives.common.pile();h=0;for(i=n.length;h<i;h+=1){m=n[h];q=r=null;j=0;for(k=m.fromItems.length;j<k;j+=1)l=c.getItemPosition(m.fromItems[j]),r=null!=r?Math.min(r,l):l,q=null!=q?Math.max(q,l):l;s.add(r,q,m)}t.parentsStackSize=s.resolve(this,function(a,b,c,d,e){c.fromOffset=d+1;c.fromStackSize=e})}})};
primitives.famdiagram.FamilyMatrixesExtractor=function(a){this.parent=primitives.famdiagram.BaseTransformer.prototype;this.parent.constructor.apply(this,arguments)};primitives.famdiagram.FamilyMatrixesExtractor.prototype=new primitives.famdiagram.BaseTransformer;
primitives.famdiagram.FamilyMatrixesExtractor.prototype.extract=function(a,b,c,d,f,e){0<b.hasNodes()&&a.enableMatrixLayout&&b.groupBy(this,Math.max(2,a.minimumMatrixSize),function(g,h,i,j){var k=e+=1,l=e+=1,m=b.node(i[0]),m=new primitives.famdiagram.FamilyItem({id:k,level:m.level,isVisible:!1,isActive:!1,itemConfig:{title:"dummy #"+k,description:"This is item used as aggregator of matrixed nodes."},levelGravity:1,hideParentConnection:!0,hideChildrenConnection:!0});d[k]=l;for(var n=0,p=i.length;n<
p;n+=1)b.removeNode(i[n]);null!=g?(b.add([g],k,m),m.hideParentConnection=!1,f.push(new primitives.common.MatrixConnectorBundle(!0,i,k,k,this.getMatrixWidth(a.maximumColumnsInMatrix,i.length)))):b.add(null,k,m);null!=h&&(b.adopt([k],h),m.hideChildrenConnection=!1,f.push(new primitives.common.MatrixConnectorBundle(!1,i,k,l,this.getMatrixWidth(a.maximumColumnsInMatrix,i.length))));c[k]=j});return e};
primitives.famdiagram.FamilyMatrixesExtractor.prototype.getMatrixWidth=function(a,b){return Math.min(a,Math.ceil(Math.sqrt(b)))};primitives.famdiagram.FamilyNormalizer=function(a){this.parent=primitives.famdiagram.BaseTransformer.prototype;this.parent.constructor.apply(this,arguments)};primitives.famdiagram.FamilyNormalizer.prototype=new primitives.famdiagram.BaseTransformer;
primitives.famdiagram.FamilyNormalizer.prototype.normalize=function(a,b,c){if(0<b.hasNodes()){b.loopLevels(this,1==a.groupByType,function(a,b,c){b.level=c});b.optimizeReferences(function(){c+=1;return new primitives.famdiagram.FamilyItem({id:c,isVisible:!1,isActive:!1,itemConfig:{title:"bundle #"+c,description:" This item was created by references optimizer."},levelGravity:2})});if(this.debug&&!b.validate())throw"References are broken in family structure!";if(this.debug&&b.hasLoops())throw"Structure has loops!";
b.eliminateManyToMany(function(){c+=1;return new primitives.famdiagram.FamilyItem({id:c,isVisible:!1,isActive:!1,itemConfig:{title:"dummy #"+c,description:"This is item used to eliminate M:M relations."},levelGravity:2,hideParentConnection:!1,hideChildrenConnection:!1})});if(this.debug&&!b.validate())throw"References are broken in family structure!";a.alignBylevels?this.resortItemsBylevels(b):b.loopLevels(this,1==a.groupByType,function(a,b,c){b.level=c});this.debug&&this.validate(b,!1);this.fillInItems(b,
function(){c+=1;return new primitives.famdiagram.FamilyItem({id:c,levelGravity:2,isVisible:!1,isActive:!1,itemConfig:{title:"extension #"+c,description:"This is item used to fill gaps in levels."}})});this.debug&&this.validate(b,!0)}return c};
primitives.famdiagram.FamilyNormalizer.prototype.resortItemsBylevels=function(a){var b=[],c=null,d=null,f,e;a.loop(this,function(a,e){e.originalLevel=e.level;e.level=null;null!=e.originalLevel&&(b[e.originalLevel]||(b[e.originalLevel]={}),b[e.originalLevel][a]=e,c=null!=c?Math.min(e.originalLevel,c):e.originalLevel,d=null!=d?Math.max(e.originalLevel,d):e.originalLevel)});for(f=c;f<=d;f+=1)e=b[f],this.setLevelsForItems(e,a);a.loopTopo(this,function(b,c){var d;1==c.levelGravity&&(d=null,a.loopParents(this,
b,function(b,c){d=null==d?c.level+1:Math.max(c.level+1,d);return a.SKIP}),c.level=!d?c.level:d)})};
primitives.famdiagram.FamilyNormalizer.prototype.setLevelsForItems=function(a,b){var c=0,d,f,e;for(d in a)a.hasOwnProperty(d)&&b.loopParents(this,d,function(a,d){c=Math.max(d.level+1,c);return b.SKIP});for(d in a)a.hasOwnProperty(d)&&(f=a[d],f.level=c);for(;!primitives.common.isEmptyObject(a);){e={};for(d in a)a.hasOwnProperty(d)&&(f=a[d],b.loopChildren(this,d,function(a,c){if(null==c.originalLevel||c.isLevelNeutral)c.level=null==c.level?f.level+1:Math.max(c.level,f.level+1),e[a]=c;return b.SKIP}));
a=e}};
primitives.famdiagram.FamilyNormalizer.prototype.fillInItems=function(a,b){var c;a.loop(this,function(d,f){for(var e=!0,g;e;)e=!1,g=[],a.loopParents(this,d,function(b,c){f.level-1>c.level&&g.push(b);return a.SKIP}),1<g.length&&(c=b(f),c.level=f.level-1,c.hideParentConnection=!1,c.hideChildrenConnection=!1,a.bundleParents(d,g,c.id,c),e=!0,d=c.id,f=c)});a.loop(this,function(d,f){for(var e=!0,g,h=!0;e;)e=!1,g=[],a.loopChildren(this,d,function(b,c){f.level+1<c.level?g.push(b):h=!1;return a.SKIP}),1<g.length&&
(c=b(f),c.level=f.level+1,h&&(c.hideParentConnection=!1,c.hideChildrenConnection=!1),a.bundleChildren(d,g,c.id,c),e=!0,d=c.id,f=c)});a.loop(this,function(d,f){for(var e=!0,g;e;)e=!1,g=[],a.loopParents(this,d,function(b,c){f.level-1>c.level&&g.push(b);return a.SKIP}),0<g.length&&(c=b(f),c.level=f.level-1,c.hideParentConnection=!1,c.hideChildrenConnection=!1,a.bundleParents(d,g,c.id,c),e=!0,d=c.id,f=c)})};
primitives.common.BaseLayout=function(a,b){this._children={};if(null!=this.params)for(var c in this.params)this.params.hasOwnProperty(c)&&a.hasOwnProperty(c)&&(this.params[c]=a[c]);if(null!=this.options){for(c in this.options)this.options.hasOwnProperty(c)&&b.hasOwnProperty(c)&&(this.options[c]=b[c]);this.options.shifts=this.getShifts(this.options);this.options.intervals=this.getIntervals(this.options)}};primitives.common.BaseLayout.prototype.add=function(a,b){this._children[a]=b};
primitives.common.BaseLayout.prototype.getLayout=function(a){return this._children[a]||null};primitives.common.BaseLayout.prototype.getShifts=function(a){var b=[];b[1]=a.normalLevelShift;b[2]=a.dotLevelShift;b[3]=a.lineLevelShift;b[4]=a.lineLevelShift;return b};primitives.common.BaseLayout.prototype.getIntervals=function(a){var b=[];b[1]=a.normalItemsInterval;b[2]=a.dotItemsInterval;b[3]=a.lineItemsInterval;b[4]=a.lineItemsInterval;return b};
primitives.common.BaseLayout.prototype.getItemSize=function(a,b,c,d){var f,e;switch(a){case 1:a=c.template.templateConfig;f=new primitives.common.Size(a.itemSize);e=new primitives.common.Rect(0,0,f.width,f.height);b&&(f.height+=a.cursorPadding.top+a.cursorPadding.bottom,f.width+=a.cursorPadding.left+a.cursorPadding.right,e.x=a.cursorPadding.left,e.y=a.cursorPadding.top);c.hasSelectorCheckbox&&(f.height+=d.checkBoxPanelSize);if(c.hasButtons)switch(f.width+=d.buttonsPanelSize,d.groupTitlePlacementType){case 3:e.x+=
d.buttonsPanelSize}if(c.hasGroupTitle)switch(f.width+=d.groupTitlePanelSize,d.groupTitlePlacementType){case 3:break;default:e.x+=d.groupTitlePanelSize}break;case 2:a=c.template.templateConfig;f=new primitives.common.Size(a.minimizedItemSize);break;case 3:case 4:f=new primitives.common.Size}switch(d.orientationType){case 2:case 3:f.invert()}return{actualSize:f,contentPosition:e}};
primitives.famdiagram.FamilyLayout=function(a,b){this.params={logicalFamily:null,treeLevels:null,getConnectorsStacksSizes:null,isItemSelected:null,cursorItemId:null,getTemplateParams:null};this.options={verticalAlignment:1,pageFitMode:0,minimalVisibility:2,orientationType:0,arrowsDirection:0,linesWidth:1,checkBoxPanelSize:24,buttonsPanelSize:28,groupTitlePanelSize:24,groupTitlePlacementType:2,normalLevelShift:20,dotLevelShift:20,lineLevelShift:20,normalItemsInterval:10,dotItemsInterval:1,lineItemsInterval:2};
this.data={treeItemsPositions:{},treeLevelsPositions:[]};this.parent=primitives.common.BaseLayout.prototype;this.parent.constructor.apply(this,arguments)};primitives.famdiagram.FamilyLayout.prototype=new primitives.common.BaseLayout;
primitives.famdiagram.FamilyLayout.prototype.measure=function(a){var b=new primitives.common.Rect(0,0,0,0),c,d,f={treeItemsPositions:{},treeLevelsPositions:[]};switch(this.options.orientationType){case 2:case 3:a.invert()}if(!this.params.treeLevels.isEmpty())switch(this.options.pageFitMode){case 0:case primitives.common.PageFitMode.PrintPreview:case 5:c=[new primitives.orgdiagram.LevelVisibility(0,1)];b=this.setTreeLevelsVisibilityAndPositionTreeItems(f,this.params,this.options,c,0);break;default:c=
this.getLevelVisibilities(this.params.treeLevels,this.options.minimalVisibility),d=this.setTreeLevelsVisibilityAndPositionTreeItems(f,this.params,this.options,c,c.length-1),d.addRect(a),d.offset(0,0,5,5),this.findOptimalSize(this,c.length-1,function(a){b=this.setTreeLevelsVisibilityAndPositionTreeItems(f,this.params,this.options,c,a);return this.checkDiagramSize(b,d,this.options.pageFitMode)})}this.data=f;return b};
primitives.famdiagram.FamilyLayout.prototype.getLevelVisibilities=function(a,b){var c=[new primitives.orgdiagram.LevelVisibility(0,1)],d=[];switch(b){case 2:d.push(2);break;case 0:case 3:case 4:d.push(2),d.push(3)}a.loopLevelsReversed(this,function(a){for(var b=0;b<d.length;b+=1)c.push(new primitives.orgdiagram.LevelVisibility(a,d[b]))});return c};
primitives.famdiagram.FamilyLayout.prototype.findOptimalSize=function(a,b,c){var d=0,f;if(!c.call(a,d)&&c.call(a,b)){for(f=b;1<b-d;)f=Math.floor((b+d)/2),c.call(a,f)?b=f:d=f;b!==f&&c.call(a,b)}};
primitives.famdiagram.FamilyLayout.prototype.setTreeLevelsVisibilityAndPositionTreeItems=function(a,b,c,d,f){var e,g;a.treeLevelsPositions=[];b.treeLevels.loopLevels(this,function(){var b=new primitives.orgdiagram.TreeLevelPosition;b.currentvisibility=1;a.treeLevelsPositions.push(b)});for(e=0;e<=f;e+=1)g=d[e],a.treeLevelsPositions[g.level].currentvisibility=g.currentvisibility;a.treeItemsPositions={};this.recalcItemsSize(b.treeLevels,a.treeItemsPositions,a.treeLevelsPositions,b.isItemSelected,b.cursorItemId,
b.getTemplateParams,c);this.setOffsets(b.treeLevels,a.treeItemsPositions,a.treeLevelsPositions,b.logicalFamily,c.intervals);this.recalcLevelsDepth(b.treeLevels,a.treeItemsPositions,a.treeLevelsPositions,c.verticalAlignment);this.shiftLevels(a.treeLevelsPositions,c.shifts[3],c.shifts,c.arrowsDirection,c.linesWidth,b.getConnectorsStacksSizes);return this.getLayoutSize(b.treeLevels,a.treeItemsPositions,a.treeLevelsPositions)};
primitives.famdiagram.FamilyLayout.prototype.checkDiagramSize=function(a,b,c){var d=!1;switch(c){case 1:b.width>=a.width&&(d=!0);break;case 2:b.height>=a.height&&(d=!0);break;case 3:b.height>=a.height&&b.width>=a.width&&(d=!0)}return d};primitives.famdiagram.FamilyLayout.prototype.getLayoutSize=function(a,b,c){return new primitives.common.Rect(0,0,Math.round(this.getLayoutWidth(a,b)),Math.round(this.getLayoutHeight(c)))};
primitives.famdiagram.FamilyLayout.prototype.getLayoutWidth=function(a,b){var c=0;a.loopLevels(this,function(d){var f=a.getLevelLength(d);0<f&&(d=a.getItemAtPosition(d,f-1),d=b[d],c=Math.max(c,d.offset+d.actualSize.width+d.rightPadding))});return c};primitives.famdiagram.FamilyLayout.prototype.getLayoutHeight=function(a){a=a[a.length-1];return a.shift+a.nextLevelShift};
primitives.famdiagram.FamilyLayout.prototype.recalcItemsSize=function(a,b,c,d,f,e,g){a.loopLevels(this,function(h){var i=c[h];a.loopLevelItems(this,h,function(a,c){var h=new primitives.orgdiagram.TreeItemPosition,m=this.getLayout(a);if(null==m){var n=d(a)?1:!c.isVisible?4:0,m=e(a),n=0===n?i.currentvisibility:n,m=this.getItemSize(n,f==a,m,g);h.actualVisibility=n;h.actualSize=m.actualSize;h.contentPosition=m.contentPosition}else m=m.measure(i.currentvisibility),h.actualVisibility=4,h.actualSize=m;b[a]=
h})})};
primitives.famdiagram.FamilyLayout.prototype.recalcLevelsDepth=function(a,b,c,d){var f,e;a.loopLevels(this,function(g){var h=c[g];h.shift=0;h.depth=0;h.actualVisibility=4;e=f=null;a.loopLevelItems(this,g,function(a){a=b[a];h.depth=Math.max(h.depth,a.actualSize.height);switch(a.actualVisibility){case 2:case 3:case 4:e=!e?a.actualSize.height:Math.min(e,a.actualSize.height);break;default:f=!f?a.actualSize.height:Math.min(f,a.actualSize.height)}h.actualVisibility=Math.min(h.actualVisibility,a.actualVisibility)});null==
f&&(f=h.depth);null!=e&&e>f&&(f=e);switch(d){case 0:h.horizontalConnectorsDepth=f/2;break;case 1:h.horizontalConnectorsDepth=h.depth/2;break;case 2:h.horizontalConnectorsDepth=h.depth-f/2}})};primitives.famdiagram.FamilyLayout.prototype.shiftLevels=function(a,b,c,d,f,e){var g,h,i=0,j=0,f=8*f;switch(d){case 1:i=f;j=0;break;case 2:i=0,j=f}d=0;for(f=a.length;d<f;d+=1)g=a[d],h=e(d),b+=g.setShift(b,c[g.actualVisibility],j,i,h.parentsStackSize)};
primitives.famdiagram.FamilyLayout.prototype.setOffsets=function(a,b,c,d,f){var e,g;e=0;for(g=c.length;e<g;e+=1)c[e].currentOffset=0;var c=d.getPlanarFamily(a),h=new primitives.common.FamilyAlignment(this,c,a,function(a){var a=b[a],c=f[a.actualVisibility]/2;a.leftPadding=c;a.rightPadding=c;return a.leftPadding+a.actualSize.width+a.rightPadding}),i=null;a.loopLevels(this,function(c){c=a.getItemAtPosition(c,0);if(null!=c){var d=b[c],c=h.getOffset(c)-d.leftPadding-d.actualSize.width/2;i=null==i?c:Math.min(i,
c)}});a.loopLevels(this,function(c){a.loopLevelItems(this,c,function(a){var c=b[a],a=h.getOffset(a);c.offset=a-c.actualSize.width/2;c.offset-=i})})};
primitives.famdiagram.FamilyLayout.prototype.arrange=function(a,b){var c=null;null!=b&&this.params.treeLevels.loopLevels(this,function(d){var f=this.data.treeLevelsPositions[d];this.params.treeLevels.loopLevelItems(this,d,function(d){var g=this.data.treeItemsPositions[d],h=this.getItemPosition(g.actualVisibility,g.offset,g.actualSize,c,f,this.options.verticalAlignment);g.actualPosition=h.position;g.horizontalConnectorsShift=h.horizontalConnectorsShift;g.topConnectorShift=h.topConnectorShift;g.topConnectorInterval=
h.topConnectorInterval;g.bottomConnectorShift=h.bottomConnectorShift;g.bottomConnectorInterval=h.bottomConnectorInterval;b.call(a,d,g);d=this.getLayout(d);null!=d&&d.arrange(a,h.position,b)});c=f})};
primitives.famdiagram.FamilyLayout.prototype.getItemPosition=function(a,b,c,d,f,e){var g=0;switch(a){case 1:switch(e){case 0:g=0;break;case 1:g=(f.depth-c.height)/2;break;case 2:g=f.depth-c.height}break;case 2:case 3:case 4:g=f.horizontalConnectorsDepth-c.height/2}return{position:new primitives.common.Rect(b,f.shift+g,c.width,c.height),horizontalConnectorsShift:f.shift+f.horizontalConnectorsDepth,topConnectorShift:null!=d?d.shift+d.connectorShift:null,topConnectorInterval:null!=d?d.levelSpace/2:null,
bottomConnectorShift:f.shift+f.connectorShift,bottomConnectorInterval:f.levelSpace/2}};
primitives.famdiagram.MatrixLayout=function(a,b){this.params={items:[],isItemSelected:null,cursorItemId:null,getTemplateParams:null,hideParentConnection:!1,hideChildrenConnection:!1};this.options={verticalAlignment:1,orientationType:0,arrowsDirection:0,linesWidth:1,checkBoxPanelSize:24,buttonsPanelSize:28,groupTitlePanelSize:24,groupTitlePlacementType:2,normalLevelShift:20,dotLevelShift:20,lineLevelShift:20,normalItemsInterval:10,dotItemsInterval:1,lineItemsInterval:2,maximumColumnsInMatrix:6};this.data=
{treeItemsPositions:{},columns:[],rows:[]};this.parent=primitives.common.BaseLayout.prototype;this.parent.constructor.apply(this,arguments)};primitives.famdiagram.MatrixLayout.prototype=new primitives.common.BaseLayout;primitives.famdiagram.MatrixLayout.prototype.Column=function(){this.rightPadding=this.leftPadding=this.offset=this.depth=0};primitives.famdiagram.MatrixLayout.prototype.Row=function(){this.horizontalConnectorsDepth=this.offset=this.depth=0;this.dotsDepth=this.minimalDepth=null};
primitives.famdiagram.MatrixLayout.prototype.getMatrixWidth=function(a,b){return Math.min(a,Math.ceil(Math.sqrt(b)))};primitives.famdiagram.MatrixLayout.prototype.measure=function(a){var b={treeItemsPositions:{},columns:[],rows:[]};this.measureItems(b,this.params,this.options,a);this.measureColumns(b,this.params,this.options);this.measureRows(b,this.params,this.options);this.data=b;return this.getLayoutSize(b)};
primitives.famdiagram.MatrixLayout.prototype.measureItems=function(a,b,c,d){for(var f=0,e=b.items.length;f<e;f+=1){var g=b.items[f],h=g.id,i=new primitives.orgdiagram.TreeItemPosition,j=b.isItemSelected(h)?1:!g.isVisible?4:0,g=b.getTemplateParams(h),j=0===j?d:j,g=this.getItemSize(j,b.cursorItemId==h,g,c);i.actualVisibility=j;i.actualSize=g.actualSize;i.contentPosition=g.contentPosition;a.treeItemsPositions[h]=i}};
primitives.famdiagram.MatrixLayout.prototype.measureColumns=function(a,b,c){var d,f,e,g=this.getMatrixWidth(c.maximumColumnsInMatrix,b.items.length);f=0;for(e=b.items.length;f<e;f+=1){var h=a.treeItemsPositions[b.items[f].id];d=c.intervals[h.actualVisibility]/2;h.leftPadding=d;h.rightPadding=d;var i=f%g;d=a.columns[i];null==d&&(d=new this.Column,a.columns[i]=d);d.depth=Math.max(d.depth,h.leftPadding+h.actualSize.width+h.rightPadding)}g=8*c.linesWidth;f=h=0;for(e=a.columns.length;f<e;f+=1){d=a.columns[f];
if(0==f%2)switch(c.arrowsDirection){case 1:d.leftPadding=b.hideChildrenConnection?0:g;d.rightPadding=0;break;case 2:d.leftPadding=0,d.rightPadding=b.hideParentConnection?0:g}else switch(c.arrowsDirection){case 1:d.leftPadding=0;d.rightPadding=b.hideChildrenConnection?0:g;break;case 2:d.leftPadding=b.hideParentConnection?0:g,d.rightPadding=0}d.offset=h+d.leftPadding+d.depth/2;h=d.offset+d.depth/2+d.rightPadding}};
primitives.famdiagram.MatrixLayout.prototype.measureRows=function(a,b,c){var d,f,e,g=this.getMatrixWidth(c.maximumColumnsInMatrix,b.items.length);d=0;for(f=b.items.length;d<f;d+=1){var h=a.treeItemsPositions[b.items[d].id],i=Math.floor(d/g),j=c.shifts[h.actualVisibility]/2;e=a.rows[i];null==e&&(e=new this.Row,a.rows[i]=e);e.depth=Math.max(e.depth,j+h.actualSize.height+j);switch(h.actualVisibility){case 2:case 3:case 4:e.dotsDepth=!e.dotsDepth?h.actualSize.height:Math.min(e.dotsDepth,h.actualSize.height);
break;default:e.minimalDepth=!e.minimalDepth?h.actualSize.height:Math.min(e.minimalDepth,h.actualSize.height)}}d=b=0;for(f=a.rows.length;d<f;d+=1)switch(e=a.rows[d],e.offset=b+e.depth/2,b=e.offset+e.depth/2,null==e.minimalDepth&&(e.minimalDepth=e.depth),null!=e.dotsDepth&&e.dotsDepth>e.minimalDepth&&(e.minimalDepth=e.dotsDepth),c.verticalAlignment){case 0:e.horizontalConnectorsDepth=e.minimalDepth/2;break;case 1:e.horizontalConnectorsDepth=e.depth/2;break;case 2:e.horizontalConnectorsDepth=e.depth-
e.minimalDepth/2}};primitives.famdiagram.MatrixLayout.prototype.getLayoutSize=function(a){return new primitives.common.Rect(0,0,Math.round(this.getLayoutWidth(a)),Math.round(this.getLayoutHeight(a)))};primitives.famdiagram.MatrixLayout.prototype.getLayoutWidth=function(a){var b=0,c=a.columns.length;0<c&&(a=a.columns[c-1],b=a.offset+a.depth/2+a.rightPadding);return b};
primitives.famdiagram.MatrixLayout.prototype.getLayoutHeight=function(a){var b=0,c=a.rows.length;0<c&&(a=a.rows[c-1],b=a.offset+a.depth/2);return b};
primitives.famdiagram.MatrixLayout.prototype.arrange=function(a,b,c){if(null!=c)for(var d=this.getMatrixWidth(this.options.maximumColumnsInMatrix,this.params.items.length),f=0,e=this.params.items.length;f<e;f+=1){var g=this.params.items[f].id,h=this.data.columns[f%d],i=this.data.rows[Math.floor(f/d)],j=this.data.treeItemsPositions[g],k=this.getItemPosition(j.actualVisibility,h,i,j.actualSize,this.options);k.translate(b.x,b.y);j.actualPosition=k;j.horizontalConnectorsShift=b.y+i.offset-i.depth/2+i.horizontalConnectorsDepth;
j.leftMedianOffset=h.depth/2+h.leftPadding;j.rightMedianOffset=h.depth/2+h.rightPadding;j.topConnectorShift=i.depth/2;j.bottomConnectorShift=i.depth/2;c.call(a,g,j)}};
primitives.famdiagram.MatrixLayout.prototype.getItemPosition=function(a,b,c,d,f){var e=0;switch(a){case 1:switch(f.verticalAlignment){case 0:e=0;break;case 1:e=(c.depth-d.height)/2;break;case 2:e=c.depth-d.height}break;case 2:case 3:case 4:e=c.horizontalConnectorsDepth-d.height/2}return new primitives.common.Rect(b.offset-d.width/2,c.offset-c.depth/2+e,d.width,d.height)};
primitives.famdiagram.CursorNeighboursTask=function(a,b,c){function d(a,b,c){var d=[],f={};if(null!==a)switch(b){case 0:c.loopParents(this,a,function(a,b){f.hasOwnProperty(a)||(f[a]=!0,d.push(a));if(b.isActive)return c.SKIP});c.loopChildren(this,a,function(a,b){f.hasOwnProperty(a)||(f[a]=!0,d.push(a));if(b.isActive)return c.SKIP});break;case 1:c.loopNeighbours(this,a,function(a,b){f.hasOwnProperty(a)||(f[a]=!0,d.push(a));if(b.isActive)return!0})}return d}var f=[];return{process:function(){var e=a.getCursorTreeItem(),
g=c.getNavigationFamily(),h=b.getNeighboursSelectionMode();f=d(e,h,g);return!0},getItems:function(){return f}}};
primitives.famdiagram.AddLabelAnnotationsTask=function(a,b){function c(a,b){var c=primitives.common.graph(),d={},f,k,l,m;if(0<b.length){m=0;for(f=b.length;m<f;m+=1)k=b[m],d.hasOwnProperty(k.fromItem)?d[k.fromItem].push(k):(d[k.fromItem]=[k],a.loopChildren(this,k.fromItem,function(b){c.addEdge(k.fromItem,b,new primitives.famdiagram.EdgeItem(k.fromItem,k.fromItem,b,b));return a.SKIP}),a.loopParents(this,k.fromItem,function(b){c.addEdge(b,k.fromItem,new primitives.famdiagram.EdgeItem(b,b,k.fromItem,
k.fromItem));return a.SKIP}));for(l in d)if(d.hasOwnProperty(l)){f=d[l];f.sort(function(a,b){return b.toItems.length-a.toItems.length});for(m=0;m<f.length;m+=1){k=f[m];for(var n=a,p=c,r=k.fromItem,q=k.toItems,s=void 0,u=!0,t=null,y=void 0,v=void 0,A=void 0,w=void 0,x=[],v=0,A=q.length;v<A;v+=1)if(y=q[v],s=p.edge(r,y),null!=s){if(null==t)t=s.getFar(y);else if(t!=s.getFar(y)){u=!1;break}x.push(s.getNear(y))}else{u=!1;break}if(u&&(w=new primitives.famdiagram.FamilyItem({id:k.id,isVisible:!0,isLevelNeutral:!0,
isActive:!1,itemConfig:k}),n.bundleParents(t,x,w.id,w)?(w.levelGravity=2,u=!0):n.bundleChildren(t,x,w.id,w)?(w.levelGravity=1,u=!0):n.bundleParents(t,q,w.id,w)?(w.levelGravity=2,u=!0):n.bundleParents(t,q,w.id,w)&&(w.levelGravity=1,u=!0),u)){v=0;for(A=q.length;v<A;v+=1)y=q[v],s=p.edge(r,y),s.setFar(y,w.id)}}}}}var d=null,f=null;return{process:function(e){var g=b.getLogicalFamily(),h=a.getAnnotations(),g=g.clone();c(g,h);d=g;f=a.getMaximumId();if(e&&!g.validate())throw"References are broken in family structure!";
return!0},getNavigationFamily:function(){return d},getMaximumId:function(){return f}}};
primitives.famdiagram.AddSpousesTask=function(a,b){var c=null,d=null;return{process:function(f){var e=b.getLogicalFamily(),g=b.getMaximumId(),h=a.getItems(),i=e=e.clone(),j,k,l,m,n,p,r,q;l=0;for(m=h.length;l<m;l+=1){n=h[l];q=n.spouses.slice(0);p=0;for(r=q.length;p<r;p+=1)j=[n.id,q[p]],i.hasCommonChild(j)||(g+=1,k=new primitives.famdiagram.FamilyItem({id:g,isVisible:!1,isActive:!1,isLevelNeutral:!0,hideParentConnection:!0,hideChildrenConnection:!0,itemConfig:{title:"fake child #"+g,description:"This is fake child keeps spouses together."},
levelGravity:1}),i.add(j,k.id,k))}c=e;d=g;if(f&&!e.validate())throw"References are broken in family structure!";return!0},getLogicalFamily:function(){return c},getMaximumId:function(){return d}}};
primitives.famdiagram.ItemsPositionsTask=function(a,b,c,d,f,e,g,h,i,j){var k={},l=null;return{process:function(){var m=d.getOptions(),n=f.getOptions(),p=e.getOptions(),r={logicalFamily:g.getLogicalFamily(),treeLevels:g.getTreeLevels(),getConnectorsStacksSizes:g.getConnectorsStacksSizes,isItemSelected:j.isItemSelected,cursorItemId:i.getCursorTreeItem(),getTemplateParams:h.getTemplateParams},m={verticalAlignment:m.verticalAlignment,pageFitMode:m.pageFitMode,minimalVisibility:m.minimalVisibility,normalLevelShift:m.normalLevelShift,
dotLevelShift:m.dotLevelShift,lineLevelShift:m.lineLevelShift,normalItemsInterval:m.normalItemsInterval,dotItemsInterval:m.dotItemsInterval,lineItemsInterval:m.lineItemsInterval,orientationType:c.getOptions().orientationType,arrowsDirection:n.arrowsDirection,linesWidth:n.linesWidth,checkBoxPanelSize:m.checkBoxPanelSize,buttonsPanelSize:m.buttonsPanelSize,groupTitlePanelSize:m.groupTitlePanelSize,groupTitlePlacementType:m.groupTitlePlacementType,maximumColumnsInMatrix:p.maximumColumnsInMatrix},n=a.getOptimalPanelSize(),
p=b.getOptions().scale;n.scale(1/p);var n=new primitives.common.Rect(0,0,n.width,n.height),p=new primitives.famdiagram.FamilyLayout(r,m),q=g.getMatrixes(),s;for(s in q)if(q.hasOwnProperty(s)){var u=r.logicalFamily.node(s);p.add(s,new primitives.famdiagram.MatrixLayout({items:q[s],isItemSelected:r.isItemSelected,cursorItemId:r.cursorItemId,getTemplateParams:r.getTemplateParams,hideParentConnection:u.hideParentConnection,hideChildrenConnection:u.hideChildrenConnection},m))}l=p.measure(n);k={};p.arrange(this,
function(a,b){k[a]=b});return!0},getItemsPositions:function(){return k},getItemPosition:function(a){return k[a]},getContentSize:function(){return l}}};
primitives.famdiagram.LevelsTask=function(a,b){var c={maximumId:null,treeLevels:null,bundles:null,connectorStacks:null},d=new primitives.famdiagram.FamilyBalance,f=new primitives.orgdiagram.TreeLevelConnectorStackSize;return{process:function(){var e={logicalFamily:a.getLogicalFamily(),maximumId:a.getMaximumId(),defaultItemConfig:b};c=d.balance(e);return!0},getMaximumId:function(){return c.maximumId},getTreeLevels:function(){return c.treeLevels},getBundles:function(){return c.bundles},getConnectorsStacksSizes:function(a){return c.connectorStacks[a]||
f}}};
primitives.famdiagram.LogicalFamilyTask=function(a){var b=null,c=null;return{process:function(d){var f,e,g,h,i=a.getItems(),j=primitives.common.family(),k=0;if(0<i.length){f=0;for(e=i.length;f<e;f+=1)g=i[f],null!=g&&(h=new primitives.famdiagram.FamilyItem({id:g.id,itemConfig:g,isActive:g.isActive}),j.add(g.parents,h.id,h),g=parseInt(g.id,10),k=Math.max(isNaN(g)?0:g,k))}b=j;c=k;if(d&&!j.validate())throw"References are broken in family structure!";return!0},getLogicalFamily:function(){return b},getMaximumId:function(){return c}}};
primitives.famdiagram.NormalizeLogicalFamilyTask=function(a,b,c){var d=null,f=null,e={},g={},h=null,i=null,j=null,k=new primitives.famdiagram.FamilyBalance,l=new primitives.famdiagram.FamilyNormalizer(!1),m=new primitives.famdiagram.FamilyMatrixesExtractor(!1),n=new primitives.orgdiagram.TreeLevelConnectorStackSize;return{process:function(){var n=b.getLogicalFamily(),r=b.getMaximumId(),q={},s={},u=[],t=a.getOptions(),t={hideGrandParentsConnectors:t.hideGrandParentsConnectors,groupByType:t.groupByType,
alignBylevels:t.alignBylevels,enableMatrixLayout:t.enableMatrixLayout,minimumMatrixSize:t.minimumMatrixSize,maximumColumnsInMatrix:t.maximumColumnsInMatrix},n=!0==t.hideGrandParentsConnectors?n.getFamilyWithoutGrandParentsRelations():n.clone(),r=l.normalize(t,n,r),r=m.extract(t,n,q,s,u,r);f=n;e=q;g=s;i=u;n=k.balance({logicalFamily:n,maximumId:r,defaultItemConfig:c});d=n.maximumId;h=n.treeLevels;i=i.concat(n.bundles);j=n.connectorStacks;return!0},getLogicalFamily:function(){return f},getMatrixes:function(){return e},
getNestedLayoutBottomConnectorIds:function(){return g},getMaximumId:function(){return d},getTreeLevels:function(){return h},getBundles:function(){return i},getConnectorsStacksSizes:function(a){return j[a]||n}}};
primitives.famdiagram.RemoveLoopsTask=function(a,b){function c(a,b,c){var d,f,k,l,m,n,p,r,q;d=b.clone();b.loopTopo(this,function(a){d.removeNode(a)});if(d.hasNodes()){l=0;for(m=a.length;l<m;l+=1)if(f=a[l],null!=d.node(f.id)){q=[];d.loopParents(this,f.id,function(a){q.push(a);return d.SKIP});n=0;for(p=q.length;n<p;n+=1)d.removeRelation(q[n],f.id),b.removeRelation(q[n],f.id);c+=1;k=new primitives.famdiagram.FamilyItem({id:c,isVisible:!1,isActive:!0,isLevelNeutral:!0,hideParentConnection:!0,hideChildrenConnection:!0,
itemConfig:{title:"fake parent #"+c,description:"This is fake parent item was created by loops reversal."}});b.add([],k.id,k);b.adopt([k.id],f.id);n=0;for(p=q.length;n<p;n+=1)c+=1,f=new primitives.famdiagram.FamilyItem({id:c,isVisible:!1,isActive:!0,isLevelNeutral:!0,hideParentConnection:!0,hideChildrenConnection:!0,itemConfig:{title:"fake child #"+c,description:"This is fake child item was created by loops reversal."}}),b.add([k.id,q[n]],f.id,f);r=[];d.loopTopo(this,function(a){r.push(a)});n=0;for(p=
r.length;n<p;n+=1)d.removeNode(r[n])}}return c}var d=null,f=null;return{process:function(e){var g=b.getNavigationFamily(),h=b.getMaximumId(),i=a.getItems(),g=g.clone(),h=c(i,g,h,e);d=g;f=h;if(e&&!g.validate())throw"References are broken in family structure!";return!0},getLogicalFamily:function(){return d},getMaximumId:function(){return f}}};
primitives.common.LabelAnnotationTemplate=function(){var a,b=jQuery('<div class="bp-label-annotation"></div>');b.addClass("bp-item");a=b.wrap("<div>").parent().html();var c=primitives.common.hashCode(a);return{template:function(){return a},getHashCode:function(){return c},render:function(a,b){b.element.text(b.context.title)}}};
primitives.famdiagram.Control=function(a,b){return primitives.orgdiagram.BaseControl(a,b,function(a,b,f){var e=new primitives.common.TaskManager;e.addDependency("options",a);e.addDependency("graphics",b);e.addDependency("layout",f);e.addDependency("defaultConfig",new primitives.famdiagram.Config);e.addDependency("defaultItemConfig",new primitives.famdiagram.ItemConfig);e.addDependency("defaultTemplateConfig",new primitives.famdiagram.TemplateConfig);e.addDependency("defaultButtonConfig",new primitives.famdiagram.ButtonConfig);
e.addDependency("defaultPaletteItemConfig",new primitives.famdiagram.PaletteItemConfig);e.addDependency("defaultBackgroundAnnotationConfig",new primitives.famdiagram.BackgroundAnnotationConfig);e.addDependency("defaultConnectorAnnotationConfig",new primitives.famdiagram.ConnectorAnnotationConfig);e.addDependency("defaultHighlightPathAnnotationConfig",new primitives.famdiagram.HighlightPathAnnotationConfig);e.addDependency("defaultShapeAnnotationConfig",new primitives.famdiagram.ShapeAnnotationConfig);
e.addDependency("defaultLabelAnnotationConfig",new primitives.famdiagram.LabelAnnotationConfig);e.addDependency("isFamilyChartMode",!0);e.addDependency("showElbowDots",!0);e.addDependency("null",null);e.addDependency("foreground",2);e.addDependency("background",1);e.addTask("OptionsTask",["options"],primitives.famdiagram.OptionsTask,"#000000");e.addTask("CurrentControlSizeTask",["layout","OptionsTask","ItemsSizesOptionTask"],primitives.orgdiagram.CurrentControlSizeTask,"#000000");e.addTask("CurrentScrollPositionTask",
["layout","OptionsTask"],primitives.orgdiagram.CurrentScrollPositionTask,"#000000");e.addTask("CalloutOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],primitives.orgdiagram.CalloutOptionTask,"#000080");e.addTask("ConnectorsOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.ConnectorsOptionTask,"#000080");e.addTask("ItemsOptionTask",["OptionsTask","defaultItemConfig"],primitives.famdiagram.ItemsOptionTask,"#000080");e.addTask("SpousesOptionTask",["OptionsTask","defaultItemConfig"],
primitives.famdiagram.SpousesOptionTask,"#000080");e.addTask("ItemsSizesOptionTask",["OptionsTask","defaultConfig","defaultItemConfig","defaultButtonConfig"],primitives.orgdiagram.ItemsSizesOptionTask,"#000080");e.addTask("LabelsOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],primitives.orgdiagram.LabelsOptionTask,"#000080");e.addTask("TemplatesOptionTask",["OptionsTask","defaultConfig","defaultButtonConfig","defaultTemplateConfig"],primitives.orgdiagram.TemplatesOptionTask,"#000080");
e.addTask("OrientationOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.OrientationOptionTask,"#000080");e.addTask("VisualTreeOptionTask",["OptionsTask"],primitives.famdiagram.VisualTreeOptionTask,"#000080");e.addTask("MinimizedItemsOptionTask",["OptionsTask"],primitives.orgdiagram.MinimizedItemsOptionTask,"#000080");e.addTask("NormalizeOptionTask",["OptionsTask","defaultConfig"],primitives.famdiagram.NormalizeOptionTask,"#000080");e.addTask("LinePaletteOptionTask",["OptionsTask",
"defaultPaletteItemConfig"],primitives.famdiagram.LinePaletteOptionTask,"#000080");e.addTask("CursorItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.CursorItemOptionTask,"#000080");e.addTask("HighlightItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.HighlightItemOptionTask,"#000080");e.addTask("SelectedItemsOptionTask",["OptionsTask"],primitives.orgdiagram.SelectedItemsOptionTask,"#000080");e.addTask("CursorSelectionPathModeOptionTask",["OptionsTask","defaultConfig"],
primitives.orgdiagram.CursorSelectionPathModeOptionTask,"#000080");e.addTask("NeighboursSelectionModeOptionTask",["OptionsTask","defaultConfig"],primitives.famdiagram.NeighboursSelectionModeOptionTask,"#000080");e.addTask("SplitAnnotationsOptionTask",["OptionsTask"],primitives.orgdiagram.SplitAnnotationsOptionTask,"#00ffff");e.addTask("ForegroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","foreground"],primitives.orgdiagram.ShapeAnnotationOptionTask,"#000080");
e.addTask("BackgroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","background"],primitives.orgdiagram.ShapeAnnotationOptionTask,"#000080");e.addTask("ForegroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","foreground"],primitives.orgdiagram.HighlightPathAnnotationOptionTask,"#000080");e.addTask("BackgroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig",
"background"],primitives.orgdiagram.HighlightPathAnnotationOptionTask,"#000080");e.addTask("ForegroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","foreground"],primitives.orgdiagram.ConnectorAnnotationOptionTask,"#000080");e.addTask("BackgroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","background"],primitives.orgdiagram.ConnectorAnnotationOptionTask,"#000080");e.addTask("BackgroundAnnotationOptionTask",
["SplitAnnotationsOptionTask","defaultBackgroundAnnotationConfig"],primitives.orgdiagram.BackgroundAnnotationOptionTask,"#000080");e.addTask("ScaleOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.ScaleOptionTask,"#000080");e.addTask("LogicalFamilyTask",["ItemsOptionTask"],primitives.famdiagram.LogicalFamilyTask,"#00ffff");e.addTask("LabelAnnotationOptionTask",["SplitAnnotationsOptionTask","LogicalFamilyTask","defaultLabelAnnotationConfig"],primitives.famdiagram.LabelAnnotationOptionTask,
"#000080");e.addTask("LabelAnnotationTemplateOptionTask",["LabelAnnotationOptionTask","defaultLabelAnnotationConfig"],primitives.famdiagram.LabelAnnotationTemplateOptionTask,"#000080");e.addTask("LabelAnnotationPlacementOptionTask",["LabelAnnotationOptionTask","defaultLabelAnnotationConfig"],primitives.famdiagram.LabelAnnotationPlacementOptionTask,"#000080");e.addTask("CombinedContextsTask",["ItemsOptionTask","LabelAnnotationOptionTask"],primitives.orgdiagram.CombinedContextsTask,"#00ffff");e.addTask("AddLabelAnnotationsTask",
["LabelAnnotationPlacementOptionTask","LogicalFamilyTask"],primitives.famdiagram.AddLabelAnnotationsTask,"#ff0000");e.addTask("RemoveLoopsTask",["ItemsOptionTask","AddLabelAnnotationsTask"],primitives.famdiagram.RemoveLoopsTask,"#ff0000");e.addTask("AddSpousesTask",["SpousesOptionTask","RemoveLoopsTask"],primitives.famdiagram.AddSpousesTask,"#ff0000");e.addTask("NormalizeLogicalFamilyTask",["NormalizeOptionTask","AddSpousesTask","defaultItemConfig"],primitives.famdiagram.NormalizeLogicalFamilyTask,
"#ff0000");e.addTask("ReadTemplatesTask",["TemplatesOptionTask"],primitives.orgdiagram.ReadTemplatesTask,"#00ffff");e.addTask("ActiveItemsTask",["ItemsSizesOptionTask","ReadTemplatesTask"],primitives.orgdiagram.ActiveItemsTask,"#00ffff");e.addTask("ItemTemplateParamsTask",["ItemsSizesOptionTask","CursorItemOptionTask","ReadTemplatesTask"],primitives.orgdiagram.ItemTemplateParamsTask,"#00ffff");e.addTask("LabelAnnotationTemplateParamsTask",["ItemsSizesOptionTask","LabelAnnotationTemplateOptionTask",
"ReadTemplatesTask"],primitives.famdiagram.LabelAnnotationTemplateParamsTask,"#00ffff");e.addTask("CombinedTemplateParamsTask",["ItemTemplateParamsTask","LabelAnnotationTemplateParamsTask"],primitives.famdiagram.CombinedTemplateParamsTask,"#00ffff");e.addTask("GroupTitleTemplateTask",["TemplatesOptionTask"],primitives.orgdiagram.GroupTitleTemplateTask,"#00ffff");e.addTask("CheckBoxTemplateTask",["ItemsSizesOptionTask"],primitives.orgdiagram.CheckBoxTemplateTask,"#00ffff");e.addTask("ButtonsTemplateTask",
["ItemsSizesOptionTask"],primitives.orgdiagram.ButtonsTemplateTask,"#00ffff");e.addTask("AnnotationLabelTemplateTask",["ItemsOptionTask"],primitives.orgdiagram.AnnotationLabelTemplateTask,"#00ffff");e.addTask("ConnectionsGraphTask",["graphics","CreateTransformTask","ConnectorsOptionTask","NormalizeLogicalFamilyTask","AlignDiagramTask"],primitives.orgdiagram.ConnectionsGraphTask,"#00ffff");e.addTask("HighlightItemTask",["HighlightItemOptionTask","ActiveItemsTask"],primitives.orgdiagram.HighlightItemTask,
"#00ffff");e.addTask("CursorItemTask",["CursorItemOptionTask","ActiveItemsTask"],primitives.orgdiagram.CursorItemTask,"#00ffff");e.addTask("CursorNeighboursTask",["CursorItemTask","NeighboursSelectionModeOptionTask","AddLabelAnnotationsTask"],primitives.famdiagram.CursorNeighboursTask,"#00ffff");e.addTask("SelectedItemsTask",["SelectedItemsOptionTask"],primitives.orgdiagram.SelectedItemsTask,"#00ffff");e.addTask("SelectionPathItemsTask",["AddLabelAnnotationsTask","CursorItemTask","SelectedItemsTask",
"CursorSelectionPathModeOptionTask"],primitives.orgdiagram.SelectionPathItemsTask,"#00ffff");e.addTask("NormalVisibilityItemsByForegroundShapeAnnotationTask",["ForegroundShapeAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");e.addTask("NormalVisibilityItemsByBackgroundShapeAnnotationTask",["BackgroundShapeAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");e.addTask("NormalVisibilityItemsByBackgroundAnnotationTask",
["BackgroundAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");e.addTask("NormalVisibilityItemsByForegroundHighlightPathAnnotationTask",["ForegroundHighlightPathAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");e.addTask("NormalVisibilityItemsByBackgroundHighlightPathAnnotationTask",["BackgroundHighlightPathAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");e.addTask("NormalVisibilityItemsByForegroundConnectorAnnotationTask",
["ForegroundConnectorAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByConnectorAnnotationTask,"#00ffff");e.addTask("NormalVisibilityItemsByBackgroundConnectorAnnotationTask",["BackgroundConnectorAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByConnectorAnnotationTask,"#00ffff");e.addTask("CombinedNormalVisibilityItemsTask","ItemsSizesOptionTask CursorItemTask CursorNeighboursTask SelectedItemsTask SelectionPathItemsTask NormalVisibilityItemsByForegroundShapeAnnotationTask NormalVisibilityItemsByBackgroundShapeAnnotationTask NormalVisibilityItemsByBackgroundAnnotationTask NormalVisibilityItemsByForegroundHighlightPathAnnotationTask NormalVisibilityItemsByBackgroundHighlightPathAnnotationTask NormalVisibilityItemsByForegroundConnectorAnnotationTask NormalVisibilityItemsByBackgroundConnectorAnnotationTask".split(" "),
primitives.orgdiagram.CombinedNormalVisibilityItemsTask,"#00ffff");e.addTask("ItemsPositionsTask","CurrentControlSizeTask ScaleOptionTask OrientationOptionTask ItemsSizesOptionTask ConnectorsOptionTask NormalizeOptionTask NormalizeLogicalFamilyTask CombinedTemplateParamsTask CursorItemTask CombinedNormalVisibilityItemsTask".split(" "),primitives.famdiagram.ItemsPositionsTask,"#ff0000");e.addTask("AlignDiagramTask","OrientationOptionTask ItemsSizesOptionTask VisualTreeOptionTask ScaleOptionTask CurrentControlSizeTask ActiveItemsTask ItemsPositionsTask isFamilyChartMode".split(" "),
primitives.orgdiagram.AlignDiagramTask,"#ff0000");e.addTask("CreateTransformTask",["OrientationOptionTask","AlignDiagramTask"],primitives.orgdiagram.CreateTransformTask,"#00ffff");e.addTask("CenterOnCursorTask","layout CurrentControlSizeTask CurrentScrollPositionTask CursorItemTask AlignDiagramTask CreateTransformTask ScaleOptionTask".split(" "),primitives.orgdiagram.CenterOnCursorTask,"#00ffff");e.addTask("PaletteManagerTask",["ConnectorsOptionTask","LinePaletteOptionTask"],primitives.orgdiagram.PaletteManagerTask,
"#00ffff");e.addTask("ApplyLayoutChangesTask","graphics layout ItemsSizesOptionTask CurrentControlSizeTask ScaleOptionTask AlignDiagramTask".split(" "),primitives.orgdiagram.ApplyLayoutChangesTask,"#00ffff");e.addTask("DrawBackgroundHighlightPathAnnotationTask",["graphics","ConnectorsOptionTask","ForegroundHighlightPathAnnotationOptionTask","ConnectionsGraphTask","foreground"],primitives.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff");e.addTask("DrawForegroundHighlightPathAnnotationTask",["graphics",
"ConnectorsOptionTask","BackgroundHighlightPathAnnotationOptionTask","ConnectionsGraphTask","background"],primitives.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff");e.addTask("DrawBackgroundAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask BackgroundAnnotationOptionTask AddLabelAnnotationsTask AlignDiagramTask".split(" "),primitives.orgdiagram.DrawBackgroundAnnotationTask,"#008000");e.addTask("DrawForegroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground".split(" "),
primitives.orgdiagram.DrawConnectorAnnotationTask,"#008000");e.addTask("DrawBackgroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background".split(" "),primitives.orgdiagram.DrawConnectorAnnotationTask,"#008000");e.addTask("DrawForegroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground".split(" "),
primitives.orgdiagram.DrawShapeAnnotationTask,"#008000");e.addTask("DrawBackgroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background".split(" "),primitives.orgdiagram.DrawShapeAnnotationTask,"#008000");e.addTask("DrawCursorTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask CombinedTemplateParamsTask CursorItemTask SelectedItemsTask".split(" "),
primitives.orgdiagram.DrawCursorTask,"#008000");e.addTask("DrawHighlightTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask CombinedTemplateParamsTask HighlightItemTask CursorItemTask SelectedItemsTask".split(" "),primitives.orgdiagram.DrawHighlightTask,"#008000");e.addTask("DrawHighlightAnnotationTask","layout graphics CreateTransformTask ApplyLayoutChangesTask ScaleOptionTask CombinedContextsTask CalloutOptionTask ReadTemplatesTask AlignDiagramTask CenterOnCursorTask HighlightItemTask CursorItemTask SelectedItemsTask".split(" "),
primitives.orgdiagram.DrawHighlightAnnotationTask,"#008000");e.addTask("DrawTreeItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask ItemsSizesOptionTask CombinedContextsTask AlignDiagramTask CombinedTemplateParamsTask CursorItemTask SelectedItemsTask GroupTitleTemplateTask CheckBoxTemplateTask ButtonsTemplateTask".split(" "),primitives.orgdiagram.DrawTreeItemsTask,"#008000");e.addTask("DrawMinimizedItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask MinimizedItemsOptionTask CombinedTemplateParamsTask AlignDiagramTask".split(" "),
primitives.orgdiagram.DrawMinimizedItemsTask,"#008000");e.addTask("DrawConnectorsTask",["graphics","ConnectionsGraphTask","ConnectorsOptionTask","showElbowDots","PaletteManagerTask"],primitives.orgdiagram.DrawConnectorsTask,"#008000");e.addTask("DrawItemLabelsTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","LabelsOptionTask","AlignDiagramTask"],primitives.orgdiagram.DrawItemLabelsTask,"#008000");return e},function(a,b,f,e){var g=new primitives.famdiagram.EventArgs,h=a.tasks.getTask("CombinedContextsTask"),
i=a.tasks.getTask("AlignDiagramTask"),j=a.tasks.getTask("LogicalFamilyTask"),b=h.getConfig(b),k=h.getConfig(f),l=j.getLogicalFamily();b&&null!=b.id&&(g.oldContext=b);k&&null!=k.id&&(g.context=k,l.loopParents(this,k.id,function(a,b,c){if(0<c)return l.BREAK;g.parentItems.push(h.getConfig(a))}),l.loopChildren(this,k.id,function(a,b,c){if(0<c)return l.BREAK;g.childrenItems.push(h.getConfig(a))}),j=a.layout.mousePanel.offset(),a=a.layout.element.offset(),f=i.getItemPosition(f),g.position=(new primitives.common.Rect(f.actualPosition)).translate(j.left,
j.top).translate(-a.left,-a.top));null!=e&&(g.name=e);return g})};
primitives.orgdiagram.TemplateConfig=function(){this.name=null;this.isActive=!0;this.itemSize=new primitives.common.Size(120,100);this.itemBorderWidth=1;this.minimizedItemShapeType=this.itemTemplate=null;this.minimizedItemSize=new primitives.common.Size(4,4);this.minimizedItemCornerRadius=null;this.minimizedItemLineWidth=1;this.minimizedItemBorderColor=null;this.minimizedItemLineType=0;this.minimizedItemFillColor=null;this.minimizedItemOpacity=1;this.highlightPadding=new primitives.common.Thickness(2,
2,2,2);this.highlightBorderWidth=1;this.highlightTemplate=null;this.cursorPadding=new primitives.common.Thickness(3,3,3,3);this.cursorBorderWidth=2;this.buttons=this.cursorTemplate=null};
primitives.orgdiagram.BackgroundAnnotationConfig=function(a){var b;this.annotationType=4;this.items=[];this.includeChildren=!1;this.zOrderType=0;this.offset=new primitives.common.Thickness(18,18,18,18);this.lineWidth=2;this.opacity=1;this.fillColor=this.borderColor=null;this.lineType=0;this.selectItems=!1;switch(arguments.length){case 1:if(null!==a)if(a instanceof Array)this.items=a;else if("object"==typeof a)for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};
primitives.orgdiagram.ButtonConfig=function(a,b,c){this.name=a;this.icon=b;this.text=!1;this.label=null;this.tooltip=c;this.size=new primitives.common.Size(16,16)};
primitives.orgdiagram.Config=function(a){this.name=void 0!==a?a:"OrgDiagram";this.classPrefix="orgdiagram";this.graphicsType=this.navigationMode=0;this.pageFitMode=3;this.minimalVisibility=2;this.horizontalAlignment=this.orientationType=0;this.verticalAlignment=1;this.arrowsDirection=0;this.showExtraArrows=!1;this.extraArrowsMinimumSpace=30;this.showHorizontalArrows=!1;this.connectorType=0;this.bevelSize=4;this.elbowType=0;this.elbowDotSize=4;this.emptyDiagramMessage="Diagram is empty.";this.items=
[];this.annotations=[];this.highlightItem=this.cursorItem=null;this.highlightGravityRadius=40;this.selectedItems=[];this.hasSelectorCheckbox=0;this.selectCheckBoxLabel="Selected";this.selectionPathMode=1;this.templates=[];this.defaultTemplateName=null;this.hasButtons=0;this.buttons=[];this.onCursorRender=this.onHighlightRender=this.onItemRender=this.onMouseDblClick=this.onMouseClick=this.onButtonClick=this.onSelectionChanged=this.onSelectionChanging=this.onCursorChanged=this.onCursorChanging=this.onHighlightChanged=
this.onHighlightChanging=null;this.dotLevelShift=this.normalLevelShift=20;this.normalItemsInterval=this.lineLevelShift=10;this.dotItemsInterval=1;this.lineItemsInterval=2;this.cousinsIntervalMultiplier=5;this.itemTitleFirstFontColor="#ffffff";this.itemTitleSecondFontColor="#000080";this.minimizedItemShapeType=6;this.linesColor="#c0c0c0";this.linesWidth=1;this.linesType=0;this.highlightLinesColor="#ff0000";this.highlightLinesWidth=1;this.highlightLinesType=0;this.calloutMaximumVisibility=2;this.showCallout=
!0;this.calloutPlacementOffset=100;this.defaultCalloutTemplateName=null;this.calloutfillColor="#000000";this.calloutBorderColor=null;this.calloutCornerRadius=this.calloutOffset=4;this.calloutPointerWidth="10%";this.calloutLineWidth=1;this.calloutOpacity=0.2;this.leavesPlacementType=this.childrenPlacementType=2;this.maximumColumnsInMatrix=6;this.buttonsPanelSize=28;this.checkBoxPanelSize=this.groupTitlePanelSize=24;this.groupTitleOrientation=this.groupTitlePlacementType=2;this.groupTitleVerticalAlignment=
1;this.groupTitleHorizontalAlignment=0;this.groupTitleFontSize="12px";this.groupTitleFontFamily="Arial";this.groupTitleColor="#4169e1";this.groupTitleFontStyle=this.groupTitleFontWeight="normal";this.distance=3;this.scale=1;this.minimumScale=0.5;this.maximumScale=2;this.showLabels=0;this.labelSize=new primitives.common.Size(80,24);this.labelOffset=1;this.labelOrientation=0;this.labelPlacement=1;this.labelFontSize="10px";this.labelFontFamily="Arial";this.labelColor="#000000";this.labelFontStyle=this.labelFontWeight=
"normal";this.enablePanning=!0;this.autoSizeMinimum=new primitives.common.Size(800,600);this.autoSizeMaximum=new primitives.common.Size(1024,768)};
primitives.orgdiagram.ConnectorAnnotationConfig=function(a,b){var c;this.annotationType=0;this.zOrderType=2;this.toItem=this.fromItem=null;this.connectorPlacementType=this.connectorShapeType=0;this.labelPlacementType=1;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=2;this.color="#000000";this.lineType=0;this.selectItems=!0;this.label=null;this.labelSize=new primitives.common.Size(60,30);switch(arguments.length){case 1:for(c in a)a.hasOwnProperty(c)&&(this[c]=a[c]);break;case 2:this.fromItem=
a,this.toItem=b}};primitives.orgdiagram.HighlightPathAnnotationConfig=function(a){var b;this.zOrderType=this.annotationType=2;this.items=[];this.lineWidth=2;this.color="#ff0000";this.lineType=0;this.opacity=1;this.showArrows=!0;this.selectItems=!1;switch(arguments.length){case 1:if(null!==a)if(a instanceof Array)this.items=a;else if("object"==typeof a)for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};
primitives.orgdiagram.ItemConfig=function(a,b,c,d,f){var e;this.context=this.image=this.description=this.title=this.parent=this.id=null;this.itemTitleColor="#4169e1";this.groupTitle=this.minimizedItemShapeType=null;this.groupTitleColor="#4169e1";this.isActive=this.isVisible=!0;this.childrenPlacementType=this.adviserPlacementType=this.itemType=this.hasButtons=this.hasSelectorCheckbox=0;this.templateName=this.groupName=null;this.showCallout=0;this.label=this.calloutTemplateName=null;this.showLabel=
0;this.labelSize=null;this.labelOrientation=3;this.labelPlacement=0;switch(arguments.length){case 1:for(e in a)a.hasOwnProperty(e)&&(this[e]=a[e]);break;case 5:this.id=a,this.parent=b,this.title=c,this.description=d,this.image=f}};
primitives.orgdiagram.ShapeAnnotationConfig=function(a){var b;this.annotationType=1;this.zOrderType=0;this.items=[];this.shapeType=0;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=2;this.cornerRadius="10%";this.opacity=1;this.fillColor=this.borderColor=null;this.lineType=0;this.selectItems=!1;this.label=null;this.labelSize=new primitives.common.Size(60,30);this.labelPlacement=0;this.labelOffset=4;switch(arguments.length){case 1:if(null!==a)if(a instanceof Array)this.items=a;else if("object"==
typeof a)for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};primitives.orgdiagram.EventArgs=function(){this.name=this.position=this.parentItem=this.context=this.oldContext=null;this.cancel=!1};primitives.common.BaseConnectorBundle=function(){};primitives.common.BaseConnectorBundle.prototype.trace=function(){};primitives.common.BaseConnectorBundle.prototype.getId=function(a){var b="_"+a.nodeid;a.nodeid+=1;return b};
primitives.common.BaseConnectorBundle.prototype.ConnectorEdge=function(a,b,c,d,f,e,g,h,i,j){this.polyline=c;this.from=a;this.to=b;this.weight=g||0;this.fromOffset=h||0;this.parentsArrowId=d;this.childrenArrowId=f;this.dotId=e;this.hasMiddle=i;this.middleParent=j};
primitives.common.BaseConnectorBundle.prototype.ConnectorDestination=function(a){this.bundleid=this.y=this.x=this.id=null;this.hasElbow=!1;this.visibility=this.elbowPoint2=this.elbowPoint1=null;this.isSquared=!0;for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b])};
primitives.common.BaseConnectorBundle.prototype.traceFork=function(a,b,c,d,f,e,g,h,i){var j,k,l,m=[],n,p,r;if(e){m=[];e=0;for(k=f.length;e<k;e+=1)if(l=f[e],l.x<d.x&&!l.isSquared)m.push(l);else break;k=m.length;0<k&&(l=m[k-1],l=l.x==d.x?d:new this.ConnectorDestination({id:l.bundleid,x:l.x,y:d.y}),this.traceAngularSegments(a,b,c,l,m,!1));m=[];for(j=f.length-1;j>=e;j-=1)if(l=f[j],l.x>d.x&&!l.isSquared)m.push(l);else break;k=m.length;0<k&&(l=m[k-1],l=l.x==d.x?d:new this.ConnectorDestination({id:l.bundleid,
x:l.x,y:d.y}),this.traceAngularSegments(a,b,c,l,m,!1));for(m=e;m<=j;m+=1){l=f[m];k=c.bevelSize;2>k&&(k=0);if(b.hasGraphics)switch(c.elbowType){case 2:case 3:0<k&&(Math.abs(d.x-l.x)>k&&Math.abs(d.y-l.y)>k)&&(l.hasElbow=!0,l.elbowPoint1=new primitives.common.Point(l.x,d.y+(d.y>l.y?-k:k)),l.elbowPoint2=new primitives.common.Point(l.x+(d.x>l.x?k:-k),d.y))}n=new primitives.common.Polyline;l.hasElbow?(b.transform.transform3Points(l.elbowPoint2.x,l.elbowPoint2.y,l.elbowPoint1.x,l.elbowPoint2.y,l.elbowPoint1.x,
l.elbowPoint1.y,!0,this,function(a,b,d,e,f,g){switch(c.elbowType){case 2:n.addSegment(new primitives.common.MoveSegment(a,b));n.addSegment(new primitives.common.LineSegment(f,g));break;case 3:n.addSegment(new primitives.common.MoveSegment(a,b)),n.addSegment(new primitives.common.CubicArcSegment(a,b,d,e,f,g))}}),b.transform.transformPoints(l.elbowPoint1.x,l.elbowPoint1.y,l.x,l.y,!0,this,function(a,b,c,d){n.addSegment(new primitives.common.LineSegment(c,d))})):b.transform.transformPoints(l.x,d.y,l.x,
l.y,!0,this,function(a,b,c,d){n.addSegment(new primitives.common.MoveSegment(a,b));n.addSegment(new primitives.common.LineSegment(c,d))});k=l.x==d.x?d.id:l.bundleid;p=4!==l.visibility;a.graph.addEdge(k,l.id,new this.ConnectorEdge(k,l.id,n,g&&p?l.id:null,!g&&p?l.id:null,null,p?1E3:10,h))}e=Math.max(e-1,0);j=Math.min(j+1,f.length-1);l=d;k=d.id;for(m=e;m<=j;m+=1)p=f[m],r=p.bundleid,p.x>l.x&&(n=new primitives.common.Polyline,b.transform.transformPoints(l.x,d.y,null!=p.elbowPoint2?p.elbowPoint2.x:p.x,
d.y,!0,this,function(a,b,c,d){n.addSegment(new primitives.common.MoveSegment(a,b));n.addSegment(new primitives.common.LineSegment(c,d))}),a.graph.addEdge(k,r,new this.ConnectorEdge(k,r,n,null,null,k,Math.abs(p.x-l.x)/1E4,h,i,g?r:k)),l=p,k=r);l=d;k=d.id;for(m=j;m>=e;m-=1)p=f[m],r=p.bundleid,p.x<l.x&&(n=new primitives.common.Polyline,b.transform.transformPoints(l.x,d.y,null!=p.elbowPoint2?p.elbowPoint2.x:p.x,d.y,!0,this,function(a,b,c,d){n.addSegment(new primitives.common.MoveSegment(a,b));n.addSegment(new primitives.common.LineSegment(c,
d))}),a.graph.addEdge(k,r,new this.ConnectorEdge(k,r,n,null,null,k,Math.abs(p.x-l.x)/1E4,h,i,g?r:k)),l=p,k=r)}else this.traceAngularSegments(a,b,c,d,f,!0)};
primitives.common.BaseConnectorBundle.prototype.traceAngularSegments=function(a,b,c,d,f,e){var g,h,i,j,k;g=0;for(h=f.length;g<h;g+=1){j=f[g];k=new primitives.common.Polyline;b.transform.transformPoint(d.x,d.y,!0,this,function(a,b){k.addSegment(new primitives.common.MoveSegment(a,b))});switch(c.connectorType){case 1:b.transform.transformPoint(j.x,j.y,!0,this,function(a,b){k.addSegment(new primitives.common.LineSegment(a,b))});break;case 2:i=new primitives.common.Rect(d,j),e?d.x>i.x?b.transform.transform3Points(i.right(),
i.verticalCenter(),i.x,i.verticalCenter(),i.x,i.bottom(),!0,this,function(a,b,c,d,e,f){k.addSegment(new primitives.common.CubicArcSegment(a,b,c,d,e,f))}):b.transform.transform3Points(i.x,i.verticalCenter(),i.right(),i.verticalCenter(),i.right(),i.bottom(),!0,this,function(a,b,c,d,e,f){k.addSegment(new primitives.common.CubicArcSegment(a,b,c,d,e,f))}):d.x>i.x?b.transform.transformPoints(i.x,i.y,i.x,i.bottom(),!0,this,function(a,b,c,d){k.addSegment(new primitives.common.QuadraticArcSegment(a,b,c,d))}):
b.transform.transformPoints(i.right(),i.y,i.right(),i.bottom(),!0,this,function(a,b,c,d){k.addSegment(new primitives.common.QuadraticArcSegment(a,b,c,d))})}i=4!==j.visibility;a.graph.addEdge(d.id,j.id,new this.ConnectorEdge(d.id,j.id,k,null,i?j.id:null,i?1E3:10))}};primitives.common.HorizontalConnectorBundle=function(a,b){this.fromItem=a;this.toItem=b};primitives.common.HorizontalConnectorBundle.prototype=new primitives.common.BaseConnectorBundle;
primitives.common.HorizontalConnectorBundle.prototype.trace=function(a,b){var c=this.fromItem,d=this.toItem,f=b.treeItemsPositions[c],e=b.treeItemsPositions[d],g=new primitives.common.Polyline;f.actualPosition.x<e.actualPosition.x?b.transform.transformPoints(f.actualPosition.right(),f.horizontalConnectorsShift,e.actualPosition.x,e.horizontalConnectorsShift,!0,this,function(a,b,c,d){g.addSegment(new primitives.common.MoveSegment(a,b));g.addSegment(new primitives.common.LineSegment(c,d))}):b.transform.transformPoints(f.actualPosition.x,
f.horizontalConnectorsShift,e.actualPosition.right(),f.horizontalConnectorsShift,!0,this,function(a,b,c,d){g.addSegment(new primitives.common.MoveSegment(a,b));g.addSegment(new primitives.common.LineSegment(c,d))});e=4!==e.actualVisibility;f=4!==f.actualVisibility;a.graph.addEdge(c,d,new this.ConnectorEdge(c,d,g,e?d:null,f?c:null,e||f?1E3:10))};
primitives.common.MatrixConnectorBundle=function(a,b,c,d,f){this.isChildren=a;this.items=b;this.len=b.length;this.matrixNodeId=c;this.connectionId=d;this.matrixWidth=f;this.blocksCount=Math.ceil(this.matrixWidth/2);this.rowsCount=Math.ceil(this.len/this.matrixWidth)};primitives.common.MatrixConnectorBundle.prototype=new primitives.common.BaseConnectorBundle;
primitives.common.MatrixConnectorBundle.prototype.trace=function(a,b,c){this.isChildren?this.traceChildrenLayout(a,b,c):this.traceParentsLayout(a,b,c)};
primitives.common.MatrixConnectorBundle.prototype.traceChildrenLayout=function(a,b,c){for(var d,f=[],e=0;e<this.blocksCount;e+=1){for(var g=null,h=this.rowsCount-1;0<=h;h-=1){var i=this.getNodeIndex(e,h,!0,!0),j=null;d=null;i<this.len&&(j=this.items[i],d=b.treeItemsPositions[j]);var k=this.getNodeIndex(e,h,!1,!0),l=null,i=null;k<this.len&&(l=this.items[k],i=b.treeItemsPositions[l]);var m=null;null==m&&null!=d&&(m=new this.ConnectorDestination({id:this.getId(a),x:d.actualPosition.horizontalCenter()+
d.rightMedianOffset,y:d.horizontalConnectorsShift}));null==m&&null!=i&&(m=new this.ConnectorDestination({id:this.getId(a),x:i.actualPosition.horizontalCenter()-i.leftMedianOffset,y:i.horizontalConnectorsShift}));null!=d&&(d=d.actualPosition,b.transform.transformPoints(d.right(),d.verticalCenter(),m.x,m.y,!0,this,function(b,c,d,e){var f=new primitives.common.Polyline;f.addSegment(new primitives.common.MoveSegment(b,c));f.addSegment(new primitives.common.LineSegment(d,e));a.graph.addEdge(j,m.id,new this.ConnectorEdge(j,
m.id,f,null,j,null,10))}));null!=i&&(d=i.actualPosition,b.transform.transformPoints(d.left(),d.verticalCenter(),m.x,m.y,!0,this,function(b,c,d,e){var f=new primitives.common.Polyline;f.addSegment(new primitives.common.MoveSegment(b,c));f.addSegment(new primitives.common.LineSegment(d,e));a.graph.addEdge(l,m.id,new this.ConnectorEdge(l,m.id,f,null,l,null,10))}));null!=g&&null!=m&&b.transform.transformPoints(g.x,g.y,m.x,m.y,!0,this,function(b,c,d,e){var f=new primitives.common.Polyline;f.addSegment(new primitives.common.MoveSegment(b,
c));f.addSegment(new primitives.common.LineSegment(d,e));a.graph.addEdge(g.id,m.id,new this.ConnectorEdge(g.id,m.id,f,null,null,null,0))});null!=m&&(g=m)}null!=g&&f.push(new this.ConnectorDestination({id:g.id,bundleid:this.getId(a),x:g.x,y:g.y,isSquared:!0,visibility:4}))}d=b.treeItemsPositions[this.matrixNodeId].actualPosition;e=new this.ConnectorDestination({id:this.matrixNodeId,x:d.horizontalCenter(),y:d.top()});this.traceFork(a,b,c,e,f,!0,!1,0,c.showExtraArrows)};
primitives.common.MatrixConnectorBundle.prototype.traceParentsLayout=function(a,b,c){for(var d,f=[],e=0;e<=this.blocksCount;e+=1){for(var g=null,h=0;h<this.rowsCount;h+=1){var i=this.getNodeIndex(e,h,!0,!1),j=null;d=null;i<this.len&&(j=this.items[i],d=b.treeItemsPositions[j]);var k=this.getNodeIndex(e,h,!1,!1),l=null,i=null;k<this.len&&(l=this.items[k],i=b.treeItemsPositions[l]);var m=null;null==m&&null!=d&&(m=new this.ConnectorDestination({id:this.getId(a),x:d.actualPosition.horizontalCenter()+d.rightMedianOffset,
y:d.horizontalConnectorsShift}));null==m&&null!=i&&(m=new this.ConnectorDestination({id:this.getId(a),x:i.actualPosition.horizontalCenter()-i.leftMedianOffset,y:i.horizontalConnectorsShift}));null!=d&&(d=d.actualPosition,b.transform.transformPoints(d.right(),d.verticalCenter(),m.x,m.y,!0,this,function(b,c,d,e){var f=new primitives.common.Polyline;f.addSegment(new primitives.common.MoveSegment(b,c));f.addSegment(new primitives.common.LineSegment(d,e));a.graph.addEdge(j,m.id,new this.ConnectorEdge(j,
m.id,f,j,null,null,10))}));null!=i&&(d=i.actualPosition,b.transform.transformPoints(d.left(),d.verticalCenter(),m.x,m.y,!0,this,function(b,c,d,e){var f=new primitives.common.Polyline;f.addSegment(new primitives.common.MoveSegment(b,c));f.addSegment(new primitives.common.LineSegment(d,e));a.graph.addEdge(l,m.id,new this.ConnectorEdge(l,m.id,f,l,null,null,10))}));null!=g&&null!=m&&b.transform.transformPoints(g.x,g.y,m.x,m.y,!0,this,function(b,c,d,e){var f=new primitives.common.Polyline;f.addSegment(new primitives.common.MoveSegment(b,
c));f.addSegment(new primitives.common.LineSegment(d,e));a.graph.addEdge(g.id,m.id,new this.ConnectorEdge(g.id,m.id,f,null,null,null,0))});null!=m&&(g=m)}null!=g&&f.push(new this.ConnectorDestination({id:g.id,bundleid:this.getId(a),x:g.x,y:g.y,isSquared:!0,visibility:4}))}d=b.treeItemsPositions[this.matrixNodeId].actualPosition;e=new this.ConnectorDestination({id:this.connectionId,x:d.horizontalCenter(),y:d.bottom()});this.traceFork(a,b,c,e,f,!0,!0,0,c.showExtraArrows)};
primitives.common.MatrixConnectorBundle.prototype.getNodeIndex=function(a,b,c,d){var f=null;d?(a=2*a+(c?0:1),this.matrixWidth>a&&(f=b*this.matrixWidth+a)):(a=2*a+(c?-1:0),0<=a&&a<this.matrixWidth&&(f=b*this.matrixWidth+a));return f};primitives.common.VerticalConnectorBundle=function(a,b){this.fromItems=a;this.toItems=b;this.childConnectorId={};this.fromStackSize=this.fromOffset=0};primitives.common.VerticalConnectorBundle.prototype=new primitives.common.BaseConnectorBundle;
primitives.common.VerticalConnectorBundle.prototype.trace=function(a,b,c){var d,f,e,g,h,i,j,k,l,m=0===c.connectorType;d=[];if(0<this.fromItems.length){e=this.fromItems;i=0;for(f=e.length;i<f;i+=1)g=e[i],h=b.treeItemsPositions[g],g=new this.ConnectorDestination({id:b.nestedLayoutBottomConnectorIds.hasOwnProperty(g)?b.nestedLayoutBottomConnectorIds[g]:g,bundleid:this.getId(a),x:h.actualPosition.horizontalCenter(),y:h.actualPosition.bottom(),isSquared:!0,visibility:h.actualVisibility}),d.push(g);d.sort(function(a,
b){return a.x-b.x});l=h.bottomConnectorShift-h.bottomConnectorInterval*(this.fromStackSize-this.fromOffset+1)}f=[];if(0<this.toItems.length){k=!1;e=this.toItems;for(i=0;i<e.length;i+=1){g=e[i];h=b.treeItemsPositions[g];j=!0;if(b.hasGraphics)switch(h.actualVisibility){case 2:case 3:j=m}g=new this.ConnectorDestination({id:g,bundleid:this.getId(a),x:h.actualPosition.horizontalCenter()+0,y:h.actualPosition.top(),isSquared:j,visibility:h.actualVisibility});f.push(g);k=k||g.isSquared}f.sort(function(a,
b){return a.x-b.x});j=h.topConnectorShift}e=1==f.length?f[0].x:1==d.length?d[0].x:0<f.length&&0<d.length?(d[0].x+d[d.length-1].x+f[0].x+f[f.length-1].x)/4:0<f.length?(f[0].x+f[f.length-1].x)/2:(d[0].x+d[d.length-1].x)/2;var n=null;0<d.length&&(n=new this.ConnectorDestination({id:this.getId(a),x:e,y:l}),this.traceFork(a,b,c,n,d,!0,!0,this.fromOffset,c.showExtraArrows&&0<f.length));var p=null;0<f.length&&(p=new this.ConnectorDestination({id:this.getId(a),x:e,y:j}),null!=n&&p.y==n.y&&(p=n),this.traceFork(a,
b,c,p,f,k,!1,0,c.showExtraArrows&&0<d.length));null!=n&&(null!=p&&n.id!=p.id)&&b.transform.transformPoints(n.x,n.y,p.x,p.y,!0,this,function(b,c,d,e){var f=new primitives.common.Polyline;f.addSegment(new primitives.common.MoveSegment(b,c));f.addSegment(new primitives.common.LineSegment(d,e));a.graph.addEdge(n.id,p.id,new this.ConnectorEdge(n.id,p.id,f,null,null,null,0))})};primitives.orgdiagram.LevelVisibility=function(a,b){this.level=a;this.currentvisibility=b};
primitives.orgdiagram.OrgItem=function(a){var b,c,d;this.id=null;this.isActive=this.isVisible=!0;this.hasVisibleChildren=!1;this.childrenPlacementType=this.adviserPlacementType=this.itemType=0;this.level=null;this.hideChildrenConnection=this.hideParentConnection=!1;this.childIndex=null;var f="id parent isVisible isActive itemType adviserPlacementType childrenPlacementType".split(" ");b=0;for(c=f.length;b<c;b+=1)d=f[b],a.hasOwnProperty(d)&&(this[d]=a[d])};
primitives.orgdiagram.Template=function(a,b){this.cursorTemplate=this.dotHighlightTemplate=this.highlightTemplate=this.itemTemplate=this.templateConfig=null;null!=b&&(this.templateConfig=b,this.itemTemplate=primitives.common.isNullOrEmpty(b.itemTemplate)?new primitives.common.ItemTemplate(a,b):new primitives.common.UserTemplate(a,b.itemTemplate,a.onItemRender),this.highlightTemplate=primitives.common.isNullOrEmpty(b.highlightTemplate)?new primitives.common.HighlightTemplate(a,b):new primitives.common.UserTemplate(a,
b.highlightTemplate,a.onHighlightRender),this.dotHighlightTemplate=new primitives.common.DotHighlightTemplate(a,b),this.cursorTemplate=primitives.common.isNullOrEmpty(b.cursorTemplate)?new primitives.common.CursorTemplate(a,b):new primitives.common.UserTemplate(a,b.cursorTemplate,a.onCursorRender))};primitives.orgdiagram.TemplateParams=function(){this.template=null;this.hasGroupTitle=this.hasButtons=this.hasSelectorCheckbox=this.isActive=!1;this.buttons=[]};
primitives.orgdiagram.TreeItem=function(){this.visualAggregatorId=this.id=null;this.visualDepth=1;this.partners=[];this.visibility=1;this.actualItemType=null;this.relationDegree=this.gravity=this.connectorPlacement=0};
primitives.orgdiagram.TreeItemPosition=function(a){this.partnerConnectorOffset=0;this.levelPosition=this.level=null;this.rightPadding=this.leftPadding=this.offset=0;this.actualVisibility=1;this.topConnectorShift=this.horizontalConnectorsShift=this.contentPosition=this.actualPosition=this.actualSize=null;this.topConnectorInterval=0;this.bottomConnectorShift=null;this.bottomConnectorInterval=0;this.rightMedianOffset=this.leftMedianOffset=null;if(null!=a)for(var b in a)if(a.hasOwnProperty(b))switch(b){case "actualPosition":this.actualPosition=
new primitives.common.Rect(a.actualPosition);break;default:this[b]=a[b]}};primitives.orgdiagram.TreeLevelConnectorStackSize=function(){this.parentsStackSize=0};
primitives.orgdiagram.TreeLevelPosition=function(a){this.actualVisibility=this.currentvisibility=1;this.currentOffset=this.levelSpace=this.connectorShift=this.topConnectorShift=this.horizontalConnectorsDepth=this.nextLevelShift=this.depth=this.shift=0;this.labels=[];this.labelsRect=null;this.showLabels=!0;this.hasFixedLabels=!1;if(null!=a)for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b])};
primitives.orgdiagram.TreeLevelPosition.prototype.setShift=function(a,b,c,d,f){this.shift=a;this.levelSpace=b;this.topConnectorShift=-b/2-c;this.connectorShift=this.depth+d+(f+1)*(b/2);return this.nextLevelShift=c+this.depth+d+b+f*b/2};primitives.orgdiagram.TreeLevelPosition.prototype.shiftDown=function(a){this.shift+=a};primitives.orgdiagram.TreeLevelPosition.prototype.toString=function(){return this.currentvisibility};
primitives.orgdiagram.AlignDiagramTask=function(a,b,c,d,f,e,g,h){function i(){var a=[],b={},c;for(c in j.treeItemsPositions)if(j.treeItemsPositions.hasOwnProperty(c)){var d=j.treeItemsPositions[c];switch(d.actualVisibility){case 1:case 2:case 3:d=d.actualPosition,d=Math.max(d.width,d.height),b.hasOwnProperty(d)||(b[d]=!0,a.push(d))}}return a}var j={treeItemsPositions:{},panelSize:null},k,l,m,n,p,r,q,s;return{process:function(){var i=new primitives.common.Size(g.getContentSize()),t=new primitives.common.Size(f.getOptimalPanelSize());
s=q=null;k=null!=e?e.getActiveItems():{};l=g.getItemsPositions();m=b.getOptions();n=a.getOptions();p=c.getOptions();r=d.getOptions();switch(n.orientationType){case 2:case 3:t.invert()}t.scale(1/r.scale);j.panelSize=t;j.treeItemsPositions=l;switch(m.pageFitMode){case 5:j.panelSize=new primitives.common.Size(i);break;default:j.panelSize=new primitives.common.Size(i);if(i.width<t.width){j.treeItemsPositions={};var y=i.width,v=t.width,A;if(h)A=(v-y)/2;else switch(p.horizontalAlignment){case 1:A=0;break;
case 2:A=v-y;break;case 0:A=(v-y)/2}var y=j.treeItemsPositions,w;for(w in l)l.hasOwnProperty(w)&&(v=new primitives.orgdiagram.TreeItemPosition(l[w]),v.actualPosition.translate(A,0),y[w]=v);j.panelSize.width=t.width}i.height<t.height&&(j.panelSize.height=t.height)}switch(n.orientationType){case 2:case 3:j.panelSize.invert()}return!0},getItemPosition:function(a){return j.treeItemsPositions[a]},getItemsPositions:function(){return j.treeItemsPositions},getContentSize:function(){return j.panelSize},getTreeItemForMousePosition:function(a,
b,c){var d=null,e=null,f=r.scale,g;if(null==q)for(g in q=primitives.common.SpatialIndex(i()),j.treeItemsPositions)if(j.treeItemsPositions.hasOwnProperty(g)){var h=j.treeItemsPositions[g];if(k.hasOwnProperty(g))switch(h.actualVisibility){case 1:case 2:case 3:h=new primitives.common.Rect(h.actualPosition),h.context=g,q.addRect(h)}}g=q;var l,a=a/f,b=b/f,f=new primitives.common.Rect(a,b,0,0);l=new primitives.common.Point(a,b);f.offset(c,c,c,c);g.loopArea(this,f,function(c){var f=c.context;if(c.contains(a,
b))return d=f,!0;switch(j.treeItemsPositions[f].actualVisibility){case 2:case 3:if(c=l.distanceTo(c.horizontalCenter(),c.verticalCenter()),null==e||c<e)e=c,d=f}});return d},getNextItem:function(a,b){var c;if(null==s)for(c in s=primitives.common.KeyboardNavigationManager(),j.treeItemsPositions)if(j.treeItemsPositions.hasOwnProperty(c)){var d=j.treeItemsPositions[c];if(k.hasOwnProperty(c))switch(d.actualVisibility){case 1:d=new primitives.common.Rect(d.actualPosition),s.addRect(d,c)}}c=s;var e;switch(b){case 0:e=
c.getItemAbove(a);break;case 1:e=c.getItemBelow(a);break;case 2:e=c.getItemOnLeft(a);break;case 3:e=c.getItemOnRight(a)}return e}}};
primitives.orgdiagram.ApplyLayoutChangesTask=function(a,b,c,d,f,e){var g=null,h;return{process:function(){var i=b(),j=a(),k=f.getOptions().scale;h=c.getOptions();var l=new primitives.common.Size(e.getContentSize());l.scale(1*k);i.mousePanel.css(l.getCSS());var m=new primitives.common.Size(e.getContentSize());i.placeholder.css(m.getCSS());j.resize("placeholder",m.width,m.height);switch(h.pageFitMode){case 5:g=new primitives.common.Size(l.width+25,l.height+25);g.cropBySize(h.autoSizeMaximum);g.addSize(h.autoSizeMinimum);
i.element.css({width:g.width+"px",height:g.height+"px"});break;default:g=new primitives.common.Size(d.getScrollPanelSize())}j=i.element.offset();i.scrollPanel.css({top:"0px",left:"0px",width:g.width+"px",height:g.height+"px","margin-bottom":"0px","margin-right":"0px","margin-top":-j.top+Math.floor(j.top)+"px","margin-left":-j.left+Math.floor(j.left)+"px"});k="scale("+k+","+k+")";i.placeholder.css({"transform-origin":"0 0",transform:k,"-ms-transform":k,"-webkit-transform":k,"-o-transform":k,"-moz-transform":k});
return!0},getOptimalPanelSize:function(){return new primitives.common.Size(g.width-25,g.height-25)}}};
primitives.orgdiagram.CenterOnCursorTask=function(a,b,c,d,f,e,g){function h(a){var b=!1;j.transformRect(a.x,a.y,a.width,a.height,!0,this,function(a,c,d,e){b=new primitives.common.Rect(a,c,d,e)});return b}var i=null,j;return{process:function(){var k;k=a();var l=d.getCursorTreeItem(),m=f.getItemPosition(l),l=f.getContentSize(),n;n=g.getOptions().scale;i=c.getPlaceholderOffset();k.forceCenterOnCursor&&(j=e.getTransform(),null!=m&&(k=h(m.actualPosition),k.scale(n),l.scale(n),n=b.getScrollPanelSize(),
i=new primitives.common.Point(Math.max(Math.min(k.horizontalCenter()-n.width/2,l.width-n.width),0),Math.max(Math.min(k.verticalCenter()-n.height/2,l.height-n.height),0))));return!0},getPlaceholderOffset:function(){return i}}};
primitives.orgdiagram.CreateTransformTask=function(a,b){var c=null;return{process:function(){var d=a.getOptions(),f=new primitives.common.Size(b.getContentSize());c=new primitives.common.Transform;c.setOrientation(d.orientationType);c.size=new primitives.common.Size(f);return!0},getTransform:function(){return c},getTreeItemForMousePosition:function(a,f,e){var g=null;c.transformPoint(a,f,!1,this,function(a,c){g=b.getTreeItemForMousePosition(a,c,e)});return g},description:"Create oordiante system tranfromation object."}};
primitives.orgdiagram.CurrentControlSizeTask=function(a,b,c){var d={scrollPanelSize:null},f={},e=new primitives.common.ObjectReader({scrollPanelSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!0),height:new primitives.common.ValueReader(["number"],!0)},!0)});return{process:function(){var b={isChanged:!1,hash:f},h=a(),h={scrollPanelSize:new primitives.common.Size(h.element.outerWidth(),h.element.outerHeight())},i=!1,j=c.getOptions();d=e.read(d,h,"layout",
b);switch(j.pageFitMode){case 1:case 2:case 3:i=b.isChanged}return i},getScrollPanelSize:function(){return d.scrollPanelSize},getOptimalPanelSize:function(){return new primitives.common.Size(d.scrollPanelSize.width-25,d.scrollPanelSize.height-25)}}};
primitives.orgdiagram.CurrentScrollPositionTask=function(a){var b={placeholderOffset:null},c={},d=new primitives.common.ObjectReader({placeholderOffset:new primitives.common.ObjectReader({x:new primitives.common.ValueReader(["number"],!0),y:new primitives.common.ValueReader(["number"],!0)},!0)});return{process:function(){var f={isChanged:!1,hash:c},e=a(),e={placeholderOffset:new primitives.common.Point(e.scrollPanel.scrollLeft(),e.scrollPanel.scrollTop())};b=d.read(b,e,"layout",f);return f.isChanged},
getPlaceholderOffset:function(){return b.placeholderOffset}}};
primitives.orgdiagram.BackgroundAnnotationOptionTask=function(a,b){var c=[],d={},f=new primitives.common.ArrayReader(new primitives.common.ObjectReader({items:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0),includeChildren:new primitives.common.ValueReader(["boolean"],!1,b.includeChildren),zOrderType:new primitives.common.EnumerationReader(primitives.common.ZOrderType,!1,b.zOrderType),offset:new primitives.common.ObjectReader({left:new primitives.common.ValueReader(["number"],!1,
b.offset.left),top:new primitives.common.ValueReader(["number"],!1,b.offset.top),right:new primitives.common.ValueReader(["number"],!1,b.offset.right),bottom:new primitives.common.ValueReader(["number"],!1,b.offset.bottom)},!1,b.offset),lineWidth:new primitives.common.ValueReader(["number"],!1,b.lineWidth),opacity:new primitives.common.ValueReader(["number"],!1,b.opacity),borderColor:new primitives.common.ValueReader(["string"],!1,b.borderColor),fillColor:new primitives.common.ValueReader(["string"],
!1,b.fillColor),lineType:new primitives.common.EnumerationReader(primitives.common.LineType,!1,b.lineType),selectItems:new primitives.common.ValueReader(["boolean"],!1,b.selectItems)}),!1);return{process:function(){var b={isChanged:!1,hash:d};c=f.read(c,a.getAnnotations(4,null),"annotations",b);return b.isChanged},getAnnotations:function(){return c}}};
primitives.orgdiagram.ConnectorAnnotationOptionTask=function(a,b,c){var d=[],f={},e=new primitives.common.ArrayReader(new primitives.common.ObjectReader({zOrderType:new primitives.common.EnumerationReader(primitives.common.ZOrderType,!1,b.zOrderType),fromItem:new primitives.common.ValueReader(["string","number"],!0),toItem:new primitives.common.ValueReader(["string","number"],!0),connectorShapeType:new primitives.common.EnumerationReader(primitives.common.ShapeType,!1,b.connectorShapeType),connectorPlacementType:new primitives.common.EnumerationReader(primitives.common.ConnectorPlacementType,
!1,b.connectorPlacementType),labelPlacementType:new primitives.common.EnumerationReader(primitives.common.ConnectorLabelPlacementType,!1,b.labelPlacementType),offset:new primitives.common.ObjectReader({left:new primitives.common.ValueReader(["number"],!1,b.offset.left),top:new primitives.common.ValueReader(["number"],!1,b.offset.top),right:new primitives.common.ValueReader(["number"],!1,b.offset.right),bottom:new primitives.common.ValueReader(["number"],!1,b.offset.bottom)},!1,b.offset),lineWidth:new primitives.common.ValueReader(["number"],
!1,b.lineWidth),color:new primitives.common.ValueReader(["string"],!1,b.color),lineType:new primitives.common.EnumerationReader(primitives.common.LineType,!1,b.lineType),selectItems:new primitives.common.ValueReader(["boolean"],!1,b.selectItems),label:new primitives.common.ValueReader(["string"],!1,b.label),labelSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,b.labelSize.width),height:new primitives.common.ValueReader(["number"],!1,b.labelSize.height)},
!1,b.labelSize)}),!1);return{process:function(){var b={isChanged:!1,hash:f};d=e.read(d,a.getAnnotations(0,c),"annotations",b);return b.isChanged},getAnnotations:function(){return d}}};
primitives.orgdiagram.HighlightPathAnnotationOptionTask=function(a,b,c){var d=[],f={},e=new primitives.common.ArrayReader(new primitives.common.ObjectReader({zOrderType:new primitives.common.EnumerationReader(primitives.common.ZOrderType,!1,b.zOrderType),lineWidth:new primitives.common.ValueReader(["number"],!1,b.lineWidth),opacity:new primitives.common.ValueReader(["number"],!1,b.opacity),color:new primitives.common.ValueReader(["string"],!1,b.color),lineType:new primitives.common.EnumerationReader(primitives.common.LineType,
!1,b.lineType),items:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!1),selectItems:new primitives.common.ValueReader(["boolean"],!1,b.selectItems),showArrows:new primitives.common.ValueReader(["boolean"],!1,b.showArrows)},!1));return{process:function(){var b={isChanged:!1,hash:f};d=e.read(d,a.getAnnotations(2,c),"annotations",b);return b.isChanged},getAnnotations:function(){return d}}};
primitives.orgdiagram.ShapeAnnotationOptionTask=function(a,b,c){var d=[],f={},e=new primitives.common.ArrayReader(new primitives.common.ObjectReader({zOrderType:new primitives.common.EnumerationReader(primitives.common.ZOrderType,!1,b.zOrderType),items:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0),shapeType:new primitives.common.EnumerationReader(primitives.common.ShapeType,!1,b.shapeType),offset:new primitives.common.ObjectReader({left:new primitives.common.ValueReader(["number"],
!1,b.offset.left),top:new primitives.common.ValueReader(["number"],!1,b.offset.top),right:new primitives.common.ValueReader(["number"],!1,b.offset.right),bottom:new primitives.common.ValueReader(["number"],!1,b.offset.bottom)},!1,b.offset),lineWidth:new primitives.common.ValueReader(["number"],!1,b.lineWidth),cornerRadius:new primitives.common.ValueReader(["string"],!1,b.cornerRadius),opacity:new primitives.common.ValueReader(["number"],!1,b.opacity),borderColor:new primitives.common.ValueReader(["string"],
!1,b.borderColor),fillColor:new primitives.common.ValueReader(["string"],!1,b.fillColor),lineType:new primitives.common.EnumerationReader(primitives.common.LineType,!1,b.lineType),selectItems:new primitives.common.ValueReader(["boolean"],!1,b.selectItems),label:new primitives.common.ValueReader(["string"],!1,b.label),labelSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,b.labelSize.width),height:new primitives.common.ValueReader(["number"],!1,b.labelSize.height)},
!1,b.labelSize),labelPlacement:new primitives.common.EnumerationReader(primitives.common.PlacementType,!1,b.labelPlacement),labelOffset:new primitives.common.ValueReader(["number"],!1,b.labelOffset)},!1));return{process:function(){var b={isChanged:!1,hash:f};d=e.read(d,a.getAnnotations(1,c),"annotations",b);return b.isChanged},getAnnotations:function(){return d}}};
primitives.orgdiagram.SplitAnnotationsOptionTask=function(a){var b={};return{process:function(){var c=a.getOptions().annotations,d,f,e,g,h,i={};if(primitives.common.isArray(c)){d=0;for(f=c.length;d<f;d+=1){e=c[d];g=e.annotationType;switch(g){case 1:case 0:case 2:switch(e.zOrderType){case 1:h=1;break;default:h=2}break;default:h=null}null!=g&&(g=1E3*g+(h||0),i.hasOwnProperty(g)||(i[g]=[]),i[g].push(e))}}b=i;return!0},getAnnotations:function(a,d){return b[1E3*a+(d||0)]}}};
primitives.orgdiagram.CursorItemOptionTask=function(a,b){var c={},d=new primitives.common.ObjectReader({cursorItem:new primitives.common.ValueReader(["string","number"],!0),navigationMode:new primitives.common.EnumerationReader(primitives.common.NavigationMode,!1,b.navigationMode)});return{process:function(){var b={isChanged:!1};c=d.read(c,a.getOptions(),"options",b);return b.isChanged},getCursorItem:function(){return c.cursorItem},hasCursorEnabled:function(){switch(c.navigationMode){case 0:case 1:return!0}return!1},
description:"Checks currenct cursor item option."}};primitives.orgdiagram.CursorSelectionPathModeOptionTask=function(a,b){var c={},d=new primitives.common.ObjectReader({selectionPathMode:new primitives.common.EnumerationReader(primitives.common.SelectionPathMode,!1,b.selectionPathMode)});return{process:function(){var b={isChanged:!1};c=d.read(c,a.getOptions(),"options",b);return b.isChanged},getSelectionPathMode:function(){return c.selectionPathMode},description:"Checks cursor selection path option."}};
primitives.orgdiagram.HighlightItemOptionTask=function(a,b){var c={},d=new primitives.common.ObjectReader({highlightItem:new primitives.common.ValueReader(["string","number"],!0),navigationMode:new primitives.common.EnumerationReader(primitives.common.NavigationMode,!1,b.navigationMode),highlightGravityRadius:new primitives.common.ValueReader(["number"],!1,b.highlightGravityRadius)});return{process:function(){var b={isChanged:!1};c=d.read(c,a.getOptions(),"options",b);return b.isChanged},getHighlightItem:function(){return c.highlightItem},
hasHighlightEnabled:function(){switch(c.navigationMode){case 0:case 3:return!0}return!1},getGravityRadius:function(){return c.highlightGravityRadius},description:"Checks highlight item option."}};
primitives.orgdiagram.SelectedItemsOptionTask=function(a){var b={},c={},d=new primitives.common.ObjectReader({selectedItems:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0)});return{process:function(){var f={isChanged:!1,hash:c},e=a.getOptions();b=d.read(b,e,"options",f);return f.isChanged},getSelectedItems:function(){return b.selectedItems},description:"Checks user selected items option."}};
primitives.orgdiagram.CalloutOptionTask=function(a,b){var c={},d={},f=new primitives.common.ObjectReader({calloutMaximumVisibility:new primitives.common.EnumerationReader(primitives.common.Visibility,!1,b.calloutMaximumVisibility),showCallout:new primitives.common.ValueReader(["boolean"],!1,b.showCallout),calloutPlacementOffset:new primitives.common.ValueReader(["number"],!1,b.calloutPlacementOffset),orientationType:new primitives.common.EnumerationReader(primitives.common.OrientationType,!1,b.orientationType),
defaultTemplateName:new primitives.common.ValueReader(["string"],!0),defaultCalloutTemplateName:new primitives.common.ValueReader(["string"],!0),calloutfillColor:new primitives.common.ValueReader(["string"],!1,b.calloutfillColor),calloutBorderColor:new primitives.common.ValueReader(["string"],!0),calloutOffset:new primitives.common.ValueReader(["number"],!1,b.calloutOffset),calloutCornerRadius:new primitives.common.ValueReader(["string"],!1,b.calloutCornerRadius),calloutPointerWidth:new primitives.common.ValueReader(["string"],
!1,b.calloutPointerWidth),calloutLineWidth:new primitives.common.ValueReader(["number"],!1,b.calloutLineWidth),calloutOpacity:new primitives.common.ValueReader(["number"],!1,b.calloutOpacity),items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string","number"],!0),showCallout:new primitives.common.EnumerationReader(primitives.common.Enabled,!1,b.showCallout),calloutTemplateName:new primitives.common.ValueReader(["string"],!0),templateName:new primitives.common.ValueReader(["string"],
!0)}),!0,"id")});return{process:function(){var b={isChanged:!1,hash:d};c=f.read(c,a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return c},getItemOptions:function(a){return d["options-items"][a]},description:"Checks item callout options."}};
primitives.orgdiagram.ConnectorsOptionTask=function(a,b){var c={},d={},f=new primitives.common.ObjectReader({arrowsDirection:new primitives.common.EnumerationReader(primitives.common.GroupByType,!1,b.arrowsDirection),showExtraArrows:new primitives.common.ValueReader(["boolean"],!1,b.showExtraArrows),extraArrowsMinimumSpace:new primitives.common.ValueReader(["number"],!1,b.extraArrowsMinimumSpace),connectorType:new primitives.common.EnumerationReader(primitives.common.ConnectorType,!1,b.hasOwnProperty("connectorType")?
b.connectorType:0),showNeigboursConnectorsHighlighted:new primitives.common.EnumerationReader(primitives.common.ConnectorType,!1,b.hasOwnProperty("showNeigboursConnectorsHighlighted")?b.showNeigboursConnectorsHighlighted:!1),elbowType:new primitives.common.EnumerationReader(primitives.common.ElbowType,!1,b.elbowType),bevelSize:new primitives.common.ValueReader(["number"],!1,b.bevelSize),elbowDotSize:new primitives.common.ValueReader(["number"],!1,b.elbowDotSize),linesColor:new primitives.common.ValueReader(["string"],
!1,b.linesColor),linesWidth:new primitives.common.ValueReader(["number"],!1,b.linesWidth),linesType:new primitives.common.EnumerationReader(primitives.common.LineType,!1,b.linesType),highlightLinesColor:new primitives.common.ValueReader(["string"],!1,b.highlightLinesColor),highlightLinesWidth:new primitives.common.ValueReader(["number"],!1,b.highlightLinesWidth),highlightLinesType:new primitives.common.EnumerationReader(primitives.common.LineType,!1,b.highlightLinesType)});return{process:function(){var b=
{isChanged:!1,hash:d};c=f.read(c,a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return c},description:"Checks connector lines drawing options."}};
primitives.orgdiagram.ItemsOptionTask=function(a,b){var c={},d={},f={},e=new primitives.common.ObjectReader({items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string","number"],!0),parent:new primitives.common.ValueReader(["string","number"],!0),itemType:new primitives.common.EnumerationReader(primitives.orgdiagram.ItemType,!1,b.itemType),adviserPlacementType:new primitives.common.EnumerationReader(primitives.common.AdviserPlacementType,
!1,b.adviserPlacementType),childrenPlacementType:new primitives.common.EnumerationReader(primitives.common.ChildrenPlacementType,!1,b.childrenPlacementType),isVisible:new primitives.common.ValueReader(["boolean"],!1,b.isVisible),isActive:new primitives.common.ValueReader(["boolean"],!1,b.isActive)}),!0,"id",!0,!0)});return{process:function(){var b={isChanged:!1,hash:d,sourceHash:f};c=e.read(c,a.getOptions(),"options",b);return b.isChanged},getItems:function(){return c.items},getConfig:function(a){return f["options-items"][a]},
description:"Checks items configuration options effecting their placement in layout."}};
primitives.orgdiagram.ItemsSizesOptionTask=function(a,b,c,d){var f={},e={},g=new primitives.common.ObjectReader({defaultTemplateName:new primitives.common.ValueReader(["string"],!0),defaultLabelAnnotationTemplate:new primitives.common.ValueReader(["string"],!0),hasSelectorCheckbox:new primitives.common.EnumerationReader(primitives.common.Enabled,!1,b.hasSelectorCheckbox),hasButtons:new primitives.common.EnumerationReader(primitives.common.Enabled,!1,b.hasButtons),buttonsPanelSize:new primitives.common.ValueReader(["number"],
!1,b.buttonsPanelSize),groupTitlePanelSize:new primitives.common.ValueReader(["number"],!1,b.groupTitlePanelSize),groupTitlePlacementType:new primitives.common.EnumerationReader(primitives.common.AdviserPlacementType,!1,b.groupTitlePlacementType),checkBoxPanelSize:new primitives.common.ValueReader(["number"],!1,b.checkBoxPanelSize),selectCheckBoxLabel:new primitives.common.ValueReader(["string"],!1,b.selectCheckBoxLabel),buttons:new primitives.common.ArrayReader(new primitives.common.ObjectReader({name:new primitives.common.ValueReader(["string"],
!0),icon:new primitives.common.ValueReader(["string"],!0),text:new primitives.common.ValueReader(["boolean"],!1,!1),tooltip:new primitives.common.ValueReader(["string"],!0),size:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,d.size.width),height:new primitives.common.ValueReader(["number"],!1,d.size.height)},!1,d.size)}),!0,"name"),pageFitMode:new primitives.common.EnumerationReader(primitives.common.PageFitMode,!1,b.pageFitMode),minimalVisibility:new primitives.common.EnumerationReader(primitives.common.Visibility,
!1,b.minimalVisibility),selectionPathMode:new primitives.common.EnumerationReader(primitives.common.SelectionPathMode,!1,b.selectionPathMode),autoSizeMinimum:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,b.autoSizeMinimum.width),height:new primitives.common.ValueReader(["number"],!1,b.autoSizeMinimum.height)},!1,b.autoSizeMinimum),autoSizeMaximum:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,b.autoSizeMaximum.width),
height:new primitives.common.ValueReader(["number"],!1,b.autoSizeMaximum.height)},!1,b.autoSizeMaximum),scale:new primitives.common.ValueReader(["number"],!1,b.scale),maximumScale:new primitives.common.ValueReader(["number"],!1,b.maximumScale),minimumScale:new primitives.common.ValueReader(["number"],!1,b.minimumScale),normalLevelShift:new primitives.common.ValueReader(["number"],!1,b.normalLevelShift),dotLevelShift:new primitives.common.ValueReader(["number"],!1,b.dotLevelShift),lineLevelShift:new primitives.common.ValueReader(["number"],
!1,b.lineLevelShift),normalItemsInterval:new primitives.common.ValueReader(["number"],!1,b.normalItemsInterval),dotItemsInterval:new primitives.common.ValueReader(["number"],!1,b.dotItemsInterval),lineItemsInterval:new primitives.common.ValueReader(["number"],!1,b.lineItemsInterval),cousinsIntervalMultiplier:new primitives.common.ValueReader(["number"],!1,b.cousinsIntervalMultiplier),verticalAlignment:new primitives.common.EnumerationReader(primitives.common.VerticalAlignmentType,!1,b.verticalAlignment),
items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string","number"],!0),groupTitle:new primitives.common.ValueReader(["string","number"],!0),isVisible:new primitives.common.ValueReader(["boolean","number"],!1,c.isVisible),isActive:new primitives.common.ValueReader(["boolean","number"],!1,c.isActive),hasSelectorCheckbox:new primitives.common.EnumerationReader(primitives.common.Enabled,!1,c.hasSelectorCheckbox),hasButtons:new primitives.common.EnumerationReader(primitives.common.Enabled,
!1,c.hasButtons),templateName:new primitives.common.ValueReader(["string"],!0)}),!0,"id")});return{process:function(){var b={isChanged:!1,hash:e};f=g.read(f,a.getOptions(),"options",b);return b.isChanged},getItemOptions:function(a){return e["options-items"][a]},getOptions:function(){return f},description:"Checks items size options."}};
primitives.orgdiagram.LabelsOptionTask=function(a,b,c){var d={},f={},e=new primitives.common.ObjectReader({showLabels:new primitives.common.EnumerationReader(primitives.common.Enabled,!1,b.showLabels),labelOffset:new primitives.common.ValueReader(["number"],!1,b.labelOffset),labelFontSize:new primitives.common.ValueReader(["string"],!1,b.labelFontSize),labelFontFamily:new primitives.common.ValueReader(["string"],!1,b.labelFontFamily),labelFontStyle:new primitives.common.ValueReader(["string"],!1,
b.labelFontStyle),labelFontWeight:new primitives.common.ValueReader(["string"],!1,b.labelFontWeight),labelColor:new primitives.common.ValueReader(["string"],!1,b.labelColor),labelSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,b.labelSize.width),height:new primitives.common.ValueReader(["number"],!1,b.labelSize.height)},!1,b.labelSize),labelOrientation:new primitives.common.EnumerationReader(primitives.text.TextOrientationType,!1,b.labelOrientation),
labelPlacement:new primitives.common.EnumerationReader(primitives.common.PlacementType,!1,b.labelPlacement),arrowsDirection:new primitives.common.EnumerationReader(primitives.common.GroupByType,!1,b.arrowsDirection),items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string","number"],!0),label:new primitives.common.ValueReader(["string","number"],!0),showLabel:new primitives.common.EnumerationReader(primitives.common.Enabled,!1,c.showLabel),
labelSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,0),height:new primitives.common.ValueReader(["number"],!1,0)},!0),labelOrientation:new primitives.common.EnumerationReader(primitives.text.TextOrientationType,!1,c.labelOrientation),labelPlacement:new primitives.common.EnumerationReader(primitives.common.PlacementType,!1,c.labelPlacement)}),!0,"id")});return{process:function(){var b={isChanged:!1,hash:f};d=e.read(d,a.getOptions(),"options",b);return b.isChanged},
getItemOptions:function(a){return f["options-items"][a]},getItemsOptions:function(){return f["options-items"]},getOptions:function(){return d},description:"Checks items labels options."}};
primitives.orgdiagram.MinimizedItemsOptionTask=function(a){var b={},c={},d=new primitives.common.ObjectReader({minimizedItemShapeType:new primitives.common.EnumerationReader(primitives.common.ShapeType,!0),items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string","number"],!0),minimizedItemShapeType:new primitives.common.EnumerationReader(primitives.common.ShapeType,!0),itemTitleColor:new primitives.common.ValueReader(["string"],!0)}),
!0,"id")});return{process:function(){var f={isChanged:!1,hash:c};b=d.read(b,a.getOptions(),"options",f);return f.isChanged},getItemOptions:function(a){return c["options-items"][a]},getOptions:function(){return b},description:"Checks minimized items drawing options."}};primitives.orgdiagram.OptionsTask=function(a){return{process:function(){return!0},getOptions:a,description:"Raw options."}};
primitives.orgdiagram.OrientationOptionTask=function(a,b){var c={},d={},f=new primitives.common.ObjectReader({orientationType:new primitives.common.EnumerationReader(primitives.common.OrientationType,!1,b.orientationType)});return{process:function(){var b={isChanged:!1,hash:d};c=f.read(c,a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return c},description:"Checks diagram orientation options."}};
primitives.orgdiagram.ScaleOptionTask=function(a,b){var c={},d={},f=new primitives.common.ObjectReader({scale:new primitives.common.ValueReader(["number"],!1,b.scale),minimumScale:new primitives.common.ValueReader(["number"],!1,b.minimumScale),maximumScale:new primitives.common.ValueReader(["number"],!1,b.maximumScale)});return{process:function(){var b={isChanged:!1,hash:d};c=f.read(c,a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return c},description:"Checks control scale options."}};
primitives.orgdiagram.TemplatesOptionTask=function(a,b,c,d){var f={},e={},g=new primitives.common.ObjectReader({groupTitleVerticalAlignment:new primitives.common.EnumerationReader(primitives.common.VerticalAlignmentType,!1,b.groupTitleVerticalAlignment),groupTitleHorizontalAlignment:new primitives.common.EnumerationReader(primitives.common.HorizontalAlignmentType,!1,b.groupTitleHorizontalAlignment),groupTitleOrientation:new primitives.common.EnumerationReader(primitives.text.TextOrientationType,!1,
b.groupTitleOrientation),groupTitleFontSize:new primitives.common.ValueReader(["string"],!1,b.groupTitleFontSize),groupTitleFontFamily:new primitives.common.ValueReader(["string"],!1,b.groupTitleFontFamily),groupTitleColor:new primitives.common.ValueReader(["string"],!1,b.groupTitleColor),groupTitleFontWeight:new primitives.common.ValueReader(["string"],!1,b.groupTitleFontWeight),groupTitleFontStyle:new primitives.common.ValueReader(["string"],!1,b.groupTitleFontStyle),itemTitleFirstFontColor:new primitives.common.ValueReader(["string"],
!1,b.itemTitleFirstFontColor),itemTitleSecondFontColor:new primitives.common.ValueReader(["string"],!1,b.itemTitleSecondFontColor),selectCheckBoxLabel:new primitives.common.ValueReader(["string"],!1,b.selectCheckBoxLabel),onItemRender:new primitives.common.FunctionReader,onCursorRender:new primitives.common.FunctionReader,onHighlightRender:new primitives.common.FunctionReader,templates:new primitives.common.ArrayReader(new primitives.common.ObjectReader({name:new primitives.common.ValueReader(["string"],
!0),isActive:new primitives.common.ValueReader(["boolean"],!1,d.isActive),itemSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,d.itemSize.width),height:new primitives.common.ValueReader(["number"],!1,d.itemSize.height)},!1,d.itemSize),itemBorderWidth:new primitives.common.ValueReader(["number"],!1,d.itemBorderWidth),itemTemplate:new primitives.common.ValueReader(["string"],!0),minimizedItemShapeType:new primitives.common.EnumerationReader(primitives.common.ShapeType,
!0),minimizedItemSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,d.minimizedItemSize.width),height:new primitives.common.ValueReader(["number"],!1,d.minimizedItemSize.height)},!1,d.minimizedItemSize),minimizedItemCornerRadius:new primitives.common.ValueReader(["number"],!0),minimizedItemLineWidth:new primitives.common.ValueReader(["number"],!1,d.minimizedItemLineWidth),minimizedItemBorderColor:new primitives.common.ValueReader(["string"],!0),minimizedItemLineType:new primitives.common.EnumerationReader(primitives.common.LineType,
!1,d.minimizedItemLineType),minimizedItemFillColor:new primitives.common.ValueReader(["string"],!0),minimizedItemOpacity:new primitives.common.ValueReader(["number"],!1,d.minimizedItemOpacity),highlightPadding:new primitives.common.ObjectReader({left:new primitives.common.ValueReader(["number"],!1,d.highlightPadding.left),top:new primitives.common.ValueReader(["number"],!1,d.highlightPadding.top),right:new primitives.common.ValueReader(["number"],!1,d.highlightPadding.right),bottom:new primitives.common.ValueReader(["number"],
!1,d.highlightPadding.bottom)},!1,d.highlightPadding),highlightBorderWidth:new primitives.common.ValueReader(["number"],!1,d.highlightBorderWidth),highlightTemplate:new primitives.common.ValueReader(["string"],!0),cursorPadding:new primitives.common.ObjectReader({left:new primitives.common.ValueReader(["number"],!1,d.cursorPadding.left),top:new primitives.common.ValueReader(["number"],!1,d.cursorPadding.top),right:new primitives.common.ValueReader(["number"],!1,d.cursorPadding.right),bottom:new primitives.common.ValueReader(["number"],
!1,d.cursorPadding.bottom)},!1,d.cursorPadding),cursorBorderWidth:new primitives.common.ValueReader(["number"],!1,d.cursorBorderWidth),cursorTemplate:new primitives.common.ValueReader(["string"],!0),buttons:new primitives.common.ArrayReader(new primitives.common.ObjectReader({name:new primitives.common.ValueReader(["string"],!0),icon:new primitives.common.ValueReader(["string"],!0),text:new primitives.common.ValueReader(["boolean"],!1,!1),tooltip:new primitives.common.ValueReader(["string"],!0),size:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],
!1,c.size.width),height:new primitives.common.ValueReader(["number"],!1,c.size.height)},!1,c.size)}),!0,"name")}),!0,"name")});return{process:function(){var b={isChanged:!1,hash:e};f=g.read(f,a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return f},description:"Checks items template options."}};
primitives.orgdiagram.VisualTreeOptionTask=function(a,b){var c={},d={},f=new primitives.common.ObjectReader({leavesPlacementType:new primitives.common.EnumerationReader(primitives.common.ChildrenPlacementType,!1,b.leavesPlacementType),childrenPlacementType:new primitives.common.EnumerationReader(primitives.common.ChildrenPlacementType,!1,b.childrenPlacementType),maximumColumnsInMatrix:new primitives.common.ValueReader(["number"],!1,b.maximumColumnsInMatrix),horizontalAlignment:new primitives.common.EnumerationReader(primitives.common.HorizontalAlignmentType,
!1,b.horizontalAlignment)});return{process:function(){var b={isChanged:!1,hash:d};c=f.read(c,a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return c},description:"Checks items layout options."}};
primitives.orgdiagram.CollinearVectorBundle=function(){var a=new primitives.common.Rect,b=[],c=[];return{addVector:function(d,f){b.push(d);c.push(f);a.addRect(d.from.x,d.from.y);a.addRect(d.to.x,d.to.y)},resolve:function(){if(1==b.length)c[0](0,1,1);else{var d=primitives.common.pile(),f,e,g;if(a.width>a.height){f=0;for(e=b.length;f<e;f+=1)g=b[f],d.add(g.from.x,g.to.x,c[f])}else{f=0;for(e=b.length;f<e;f+=1)g=b[f],d.add(g.from.y,g.to.y,c[f])}d.resolve(this,function(a,b,c,d,e,f){c(d,e,f)})}}}};
primitives.orgdiagram.ConnectorAnnotationOffsetResolver=function(){var a={};return{getOffset:function(b,c){var d=b.getLineKey();a.hasOwnProperty(d)||(a[d]=new primitives.orgdiagram.CollinearVectorBundle);a[d].addVector(b,c)},resolve:function(){for(var b in a)a.hasOwnProperty(b)&&a[b].resolve()}}};
primitives.orgdiagram.DrawBackgroundAnnotationTask=function(a,b,c,d,f,e){function g(a,b,c){var d,f,g,i,s,u,t,y,v,A,w,x,b=0;for(d=a.length;b<d;b+=1)if(w=a[b],null!=w.items&&0<w.items.length){i=new primitives.common.MergedRectangles(h);i.transform=j;s=new primitives.orgdiagram.BackgroundAnnotationConfig;v=["opacity","lineWidth","borderColor","fillColor","lineType"];f=0;for(g=v.length;f<g;f+=1)A=v[f],i[A]=w.hasOwnProperty(A)?w[A]:s[A];h.activate("placeholder",2);u=[];y={};f=0;for(g=w.items.length;f<
g;f+=1)s=w.items[f],x=e.getItemPosition(s),null!=x&&(y[s]=!0,t=new primitives.common.Rect(x.actualPosition),t.offset(w.offset),u.push(t),w.includeChildren&&c.loopChildren(this,s,function(a){y[a]||(y[a]=!0,x=e.getItemPosition(a),t=new primitives.common.Rect(x.actualPosition),t.offset(w.offset),u.push(t))}));i.draw(u)}}var h,i,j;return{process:function(){var c=d.getAnnotations(),l;h=a();h.reset("placeholder",2);0<c.length&&(i=e.getItemsPositions(),j=b.getTransform(),l=f.getNavigationFamily(),g(c,i,
l));return!1}}};
primitives.orgdiagram.DrawConnectorAnnotationTask=function(a,b,c,d,f,e,g,h){function i(a,b){var c,d,e,f,g,i,v,A,w=new primitives.common.PolylinesBuffer,x=primitives.orgdiagram.ConnectorAnnotationOffsetResolver(),z=0;switch(h){case 1:j.activate("placeholder",4);break;case 2:j.activate("placeholder",14)}c=0;for(d=a.length;c<d;c+=1)v=a[c],z=Math.max(z,v.lineWidth);c=0;for(d=a.length;c<d;c+=1)if(v=a[c],null!=v.fromItem&&null!=v.toItem&&(e=b(v.fromItem),f=b(v.toItem),null!=e&&null!=f)){e=e.actualPosition;
g=f.actualPosition;switch(v.connectorPlacementType){case 0:i=new primitives.common.ConnectorOffbeat;break;case 1:i=new primitives.common.ConnectorStraight}var E;k.transformRect(0,0,v.labelSize.width,v.labelSize.height,!1,this,function(a,b,c,d){E=new primitives.common.Size(c,d)});var D=null;k.transformRect(0,0,m.width,m.height,!1,this,function(a,b,c,d){D=new primitives.common.Size(c,d)});f=new primitives.common.PaletteItem({lineColor:v.color,lineWidth:v.lineWidth,lineType:v.lineType});var B=!primitives.common.isNullOrEmpty(v.label);
e=(new primitives.common.Rect(e)).offset(v.offset);g=(new primitives.common.Rect(g)).offset(v.offset);i.draw(w,f,e,g,3*v.lineWidth,6*z,E,D,v.connectorShapeType,4,v.labelPlacementType,B,x,function(a){B&&null!=a&&(k.transformRect(a.x,a.y,a.width,a.height,!0,this,function(b,c,d,e){a=new primitives.common.Rect(b,c,d,e)}),A=new primitives.common.RenderEventArgs,A.context=v,j.template(a.x,a.y,0,0,0,0,a.width,a.height,l.template(),l.getHashCode(),l.render,A,null))})}x.resolve();w.transform(k,!0);j.polylinesBuffer(w)}
var j,k,l,m;return{process:function(){j=a();k=b.getTransform();d.getOptions();l=g.getTemplate();m=new primitives.common.Size(e.getContentSize());switch(h){case 1:j.reset("placeholder",4);break;case 2:j.reset("placeholder",14)}i(f.getAnnotations(),e.getItemPosition);return!1}}};
primitives.orgdiagram.DrawConnectorsTask=function(a,b,c,d,f){return{process:function(){var e=a(),g=b.getGraph(),h=c.getOptions(),i=f.getPaletteManager();e.reset("placeholder",6);e.activate("placeholder",6);var j=new primitives.common.PolylinesBuffer,k=Math.round(h.elbowDotSize/2),l={},m={};g.loopNodes(this,null,function(a){g.loopNodeEdges(this,a,function(b,c){if(!l.hasOwnProperty(b)){var e=null;1>=c.fromOffset?e=i.getPalette(1):(i.selectPalette(c.fromOffset),e=i.getPalette(0));var f=j.getPolyline(e);
if(d&&null!=c.dotId&&0!=h.elbowType&&!m.hasOwnProperty(c.dotId)){var e=j.getPolyline(f.arrowPaletteItem),g=c.dotId==c.from?c.polyline.getStartPoint():c.polyline.getEndPoint();e.addSegment(new primitives.common.DotSegment(g.x-k,g.y-k,2*k,2*k,k));m[c.dotId]=!0}e=null;null!=c.parentsArrowId&&1==h.arrowsDirection?e=c.parentsArrowId:null!=c.childrenArrowId&&2==h.arrowsDirection&&(e=c.childrenArrowId);null==e?(e=c.polyline.clone(),c.hasMiddle&&0!=h.arrowsDirection&&(g=!0,g=c.from==c.middleParent?2==h.arrowsDirection:
1==h.arrowsDirection,e.addOffsetArrow(g,h.linesWidth,0.4,h.extraArrowsMinimumSpace,function(a){a.mergeTo(j.getPolyline(f.arrowPaletteItem))})),c.from==a?e.mergeTo(f):f.addInverted(e)):(e==c.to?c.polyline.clone().mergeTo(f):f.addInverted(c.polyline.clone()),f.addArrow(h.linesWidth,function(a){a.mergeTo(j.getPolyline(a.paletteItem))}))}});l[a]=!0});e.polylinesBuffer(j);return!1}}};
primitives.orgdiagram.DrawCursorTask=function(a,b,c,d,f,e,g,h){function i(a){var b;j.activate("placeholder",11);var c=f.getItemPosition(a),g=c.actualPosition,i=new primitives.common.Rect(c.contentPosition),q=e.getTemplateParams(a).template,s=q.templateConfig,c=s.cursorPadding;i.offset(c.left,c.top,c.right,c.bottom);b=new primitives.common.RenderEventArgs;b.context=d.getConfig(a);b.isCursor=!0;b.isSelected=h.isSelected(a);b.templateName=s.name;k.transformRect(g.x,g.y,g.width,g.height,!0,this,function(a,
c,d,e){j.template(a,c,d,e,i.x,i.y,i.width,i.height,q.cursorTemplate.template(),q.cursorTemplate.getHashCode(),q.cursorTemplate.render,b,{"border-width":s.cursorBorderWidth})})}var j,k;return{process:function(){var c=g.getCursorTreeItem();j=a();j.reset("placeholder",11);null!=c&&(k=b.getTransform(),i(c));return!1}}};
primitives.orgdiagram.DrawHighlightAnnotationTask=function(a,b,c,d,f,e,g,h,i,j,k,l,m){function n(a){var b,c,k,n,x,z,E=!0,D,B=i.getItemPosition(a),C=B.actualPosition;switch(B.actualVisibility){case 2:case 3:case 1:b=g.getItemOptions(a);switch(b.showCallout){case 2:E=!1;break;case 1:E=!1;break;default:E=s.showCallout}E?(p.activate("placeholder",12),r.transformRect(C.x,C.y,C.width,C.height,!0,this,function(g,r,F,G){var r=new primitives.common.Rect(g,r,F,G),g=new primitives.common.Point(r.horizontalCenter(),
r.verticalCenter()),F=f.getOptions().scale,G=new primitives.common.Point(j.getPlaceholderOffset()),I=i.getContentSize(),E=d.getOptimalPanelSize();G.scale(1/F);E.scale(1/F);F=new primitives.common.Rect(G.x,G.y,Math.min(E.width,I.width),Math.min(E.height,I.height));if(B.actualVisibility>=s.calloutMaximumVisibility&&4!=B.actualVisibility||!F.overlaps(r)){x=!primitives.common.isNullOrEmpty(b.calloutTemplateName)?b.calloutTemplateName:!primitives.common.isNullOrEmpty(b.templateName)?b.templateName:!primitives.common.isNullOrEmpty(s.defaultCalloutTemplateName)?
s.defaultCalloutTemplateName:s.defaultTemplateName;z=h.getTemplate(x,h.DefaultWidgetTemplateName);r=z.templateConfig.itemSize;G=new primitives.common.Rect(g.x,g.y,r.width,r.height);switch(s.orientationType){case 0:case 1:G.y-=r.height/4;G.x=g.x<F.horizontalCenter()?G.x+s.calloutPlacementOffset:G.x-(s.calloutPlacementOffset+r.width);break;default:G.x-=r.width/4,G.y=g.y<F.verticalCenter()?G.y+s.calloutPlacementOffset:G.y-(s.calloutPlacementOffset+r.height)}G.x<F.x?G.x=F.x+5:G.right()>F.right()&&(G.x-=
G.right()-F.right()+5);G.y<F.y?G.y=F.y+5:G.bottom()>F.bottom()&&(G.y-=G.bottom()-F.bottom()+5);k=G;c=new primitives.common.Rect(k);c.addRect(g.x,g.y);c.offset(50);D=c.getCSS();D.display="inherit";D.visibility="inherit";u.calloutPlaceholder.css(D);g.x-=c.x;g.y-=c.y;k.x-=c.x;k.y-=c.y;n=new primitives.common.RenderEventArgs;n.context=e.getConfig(a);n.isCursor=l.getCursorTreeItem()==a;n.isSelected=m.isSelected(a);n.templateName=z.templateConfig.name;p.resize("calloutplaceholder",c.width,c.height);p.activate("calloutplaceholder",
15);p.template(k.x,k.y,k.width,k.height,0,0,k.width,k.height,z.itemTemplate.template(),z.itemTemplate.getHashCode(),z.itemTemplate.render,n,null);q.pointerPlacement=0;q.cornerRadius=s.calloutCornerRadius;q.offset=s.calloutOffset;q.opacity=s.calloutOpacity;q.lineWidth=s.calloutLineWidth;q.pointerWidth=s.calloutPointerWidth;q.borderColor=s.calloutBorderColor;q.fillColor=s.calloutfillColor;q.draw(g,k)}else u.calloutPlaceholder.css({display:"none",visibility:"hidden"})})):u.calloutPlaceholder.css({display:"none",
visibility:"hidden"});break;case 4:u.calloutPlaceholder.css({display:"none",visibility:"hidden"})}}var p,r,q=new primitives.common.Callout(b()),s,u;return{process:function(){var d=k.getHighlightTreeItem();p=b();p.reset("calloutplaceholder",15);null!==d&&(r=c.getTransform(),s=g.getOptions(),u=a(),n(d));return!1}}};
primitives.orgdiagram.DrawHighlightPathAnnotationTask=function(a,b,c,d,f){function e(a,b,c,d){var e,l,m,n,p,r,q,s,u,t,y,v,A;if(0<c.length){y=new primitives.common.PolylinesBuffer;switch(f){case 1:a.activate("placeholder",5);break;case 2:a.activate("placeholder",7)}var w={};e=0;for(l=c.length;e<l;e+=1)if(t=c[e],null!=t.items&&0<t.items.length&&(s=t.items.slice(0),p=s[0],d.hasNode(p))){m=1;for(n=s.length;m<n;m+=1)r=s[m],d.hasNode(r)&&(w.hasOwnProperty(p)?w[p].push(r):w[p]=[r],p=r)}var x={};for(v in w)x[v]=
{},w.hasOwnProperty(v)&&d.getShortestPath(this,v,w[v],function(a){return a.weight},function(a,b){x[v][b]=a});e=0;for(l=c.length;e<l;e+=1)if(t=c[e],m=new primitives.common.PaletteItem({lineColor:null!=t.color?t.color:b.highlightLinesColor,lineWidth:null!=t.lineWidth?t.lineWidth:b.highlightLinesWidth,lineType:null!=t.lineType?t.lineType:b.highlightLinesType,fillColor:null,opacity:t.opacity}),w=y.getPolyline(m),null!=t.items&&0<t.items.length&&(s=t.items.slice(0),p=s[0],d.hasNode(p))){m=1;for(n=s.length;m<
n;m+=1)if(r=s[m],d.hasNode(r)){q=x[p][r]||[];for(p=q.length-2;0<=p;p-=1)v=q[p+1],A=q[p],u=d.edge(v,A),u.from==v?u.polyline.clone().mergeTo(w):w.addInverted(u.polyline.clone()),t.showArrows&&(A==u.parentsArrowId||A==u.childrenArrowId)&&w.addArrow(t.lineWidth,function(a){a.mergeTo(y.getPolyline(a.paletteItem))});p=r}}a.polylinesBuffer(y)}}return{process:function(){var g=d.getGraph(),h=b.getOptions(),i=c.getAnnotations(),j=a();switch(f){case 1:j.reset("placeholder",5);break;case 2:j.reset("placeholder",
7)}e(j,h,i,g);return!1}}};
primitives.orgdiagram.DrawHighlightTask=function(a,b,c,d,f,e,g,h,i){function j(a){var b;k.activate("placeholder",8);var c=f.getItemPosition(a),g=c.actualPosition,j=e.getTemplateParams(a).template,s=j.templateConfig,u=s.highlightPadding;b=new primitives.common.RenderEventArgs;b.context=d.getConfig(a);b.isCursor=h.getCursorTreeItem()==a;b.isSelected=i.isSelected(a);b.templateName=s.name;l.transformRect(g.x,g.y,g.width,g.height,!0,this,function(a,d,e,f){var g=new primitives.common.Rect(0,0,Math.round(e),
Math.round(f));g.offset(u.left,u.top,u.right,u.bottom);1==c.actualVisibility?k.template(a,d,e,f,g.x,g.y,g.width,g.height,j.highlightTemplate.template(),j.highlightTemplate.getHashCode(),j.highlightTemplate.render,b,null):k.template(a,d,e,f,g.x,g.y,g.width-1,g.height-1,j.dotHighlightTemplate.template(),j.dotHighlightTemplate.getHashCode(),j.dotHighlightTemplate.render,b,null)})}var k,l;return{process:function(){var c=g.getHighlightTreeItem();k=a();k.reset("placeholder",8);null!=c&&(l=b.getTransform(),
j(c));return!1}}};
primitives.orgdiagram.DrawItemLabelsTask=function(a,b,c,d,f){function e(a,b){var c=[];if(0==b.showLabels||1==b.showLabels)for(var d in a.treeItemsPositions)if(a.treeItemsPositions.hasOwnProperty(d)){var e=b.itemsOptions[d],f=a.treeItemsPositions[d],m=f.actualPosition;null!=e&&a.transform.transformRect(m.x,m.y,m.width,m.height,!0,this,function(a,d,g,j){var m;switch(f.actualVisibility){case 1:0==b.showLabels&&(n=new primitives.common.Label(a,d,g,j),n.weight=1E4,n.labelType=1,c.push(n));break;case 2:case 3:var n;
n=e;var p=f,A=null,w,x,z,E;if(!primitives.common.isNullOrEmpty(n.label)){var D;D=3;switch(n.showLabel){case 0:switch(b.showLabels){case 0:switch(p.actualVisibility){case 3:case 2:D=0}break;case 1:D=2}break;case 1:D=2}switch(D){case 0:E=p.leftPadding+p.rightPadding;break;case 2:E=1E4;break;case 3:E=0}if(3!=D){z=null!=n.labelSize?n.labelSize:b.labelSize;p=3!=n.labelOrientation?n.labelOrientation:3!=b.labelOrientation?b.labelOrientation:0;A=0!=n.labelPlacement?n.labelPlacement:0!=b.labelPlacement?b.labelPlacement:
1;switch(p){case 0:w=z.width;x=z.height;break;case 1:case 2:x=z.width,w=z.height}z=b.labelOffset;var B,C;switch(A){case 0:case 1:B=new primitives.common.Rect(a+g/2-w/2,d-z-x,w,x);switch(p){case 0:C=0;m=2;break;case 1:m=C=1;break;case 2:C=2,m=1}break;case 2:case 11:B=new primitives.common.Rect(a+g+z,d-z-x,w,x);switch(p){case 0:C=1;m=2;break;case 1:C=1;m=0;break;case 2:m=C=2}break;case 3:B=new primitives.common.Rect(a+g+z,d+j/2-x/2,w,x);switch(p){case 0:m=C=1;break;case 1:m=C=0;break;case 2:C=0,m=2}break;
case 4:case 12:B=new primitives.common.Rect(a+g+z,d+j+z,w,x);switch(p){case 0:C=1;m=0;break;case 1:C=2;m=0;break;case 2:C=1,m=2}break;case 5:B=new primitives.common.Rect(a+g/2-w/2,d+j+z,w,x);switch(p){case 0:m=C=0;break;case 1:C=2;m=1;break;case 2:m=C=1}break;case 6:case 10:B=new primitives.common.Rect(a-w-z,d+j+z,w,x);switch(p){case 0:C=2;m=0;break;case 1:m=C=2;break;case 2:C=1,m=0}break;case 7:B=new primitives.common.Rect(a-w-z,d+j/2-x/2,w,x);switch(p){case 0:C=2;m=1;break;case 1:C=0;m=2;break;
case 2:m=C=0}break;case 8:case 9:switch(B=new primitives.common.Rect(a-w-z,d-z-x,w,x),p){case 0:m=C=2;break;case 1:C=1;m=2;break;case 2:C=2,m=0}}a=C;A=new primitives.common.Label(B);A.labelType=D;A.weight=E;A.text=n.label;A.labelOrientation=p;A.horizontalAlignmentType=a;A.verticalAlignmentType=m}}n=A;null!=n&&c.push(n)}})}0==b.showLabels&&primitives.common.getCrossingRectangles(this,c,function(a,b){if(a.isActive&&b.isActive)switch(a.labelType){case 1:switch(b.labelType){case 0:b.isActive=!1;break;
case 2:b.isActive=!1}break;case 2:switch(b.labelType){case 1:a.isActive=!1;break;case 0:b.isActive=!1}break;case 0:switch(b.labelType){case 1:a.isActive=!1;break;case 0:a.weight<=b.weight?a.isActive=!1:b.isActive=!1;break;case 2:a.isActive=!1}}});a.graphics.activate("placeholder",10);d={"font-size":b.labelFontSize,"font-family":b.labelFontFamily,"font-style":b.labelFontStyle,"font-weight":b.labelFontWeight,"font-color":b.labelColor};for(var m=0,n=c.length;m<n;m+=1){var p=c[m];if(p.isActive)switch(p.labelType){case 0:case 2:a.graphics.text(p.x,
p.y,p.width,p.height,p.text,p.labelOrientation,p.horizontalAlignmentType,p.verticalAlignmentType,d)}}}return{process:function(){var c=d.getOptions(),h={graphics:a(),transform:b.getTransform(),treeItemsPositions:f.getItemsPositions()},c={showLabels:c.showLabels,labelFontSize:c.labelFontSize,labelFontFamily:c.labelFontFamily,labelFontStyle:c.labelFontStyle,labelFontWeight:c.labelFontWeight,labelColor:c.labelColor,itemsOptions:d.getItemsOptions(),labelSize:c.labelSize,labelOrientation:c.labelOrientation,
labelPlacement:c.labelPlacement,labelOffset:c.labelOffset};h.graphics.reset("placeholder",10);e(h,c);return!1}}};
primitives.orgdiagram.DrawMinimizedItemsTask=function(a,b,c,d,f,e){function g(){var a=new primitives.common.PolylinesBuffer,b={},c,e=new primitives.common.Marker,g,s,u,t,y,v,A,w,x,z;for(z in l)l.hasOwnProperty(z)&&(y=l[z],v=y.actualPosition,A=d.getItemOptions(z),i.transformRect(v.x,v.y,v.width,v.height,!0,this,function(d,h,l,i){switch(y.actualVisibility){case 2:w=f.getTemplateParams(z);x=w.template.templateConfig;u=s=g=null;t=0;null!=A&&(s=g=A.itemTitleColor,u=A.minimizedItemShapeType);g=g||x.minimizedItemBorderColor||
"#000080";s=s||x.minimizedItemFillColor||"#000080";null==u&&(u=null!==x.minimizedItemShapeType?x.minimizedItemShapeType:k.minimizedItemShapeType);t=null===x.minimizedItemCornerRadius?x.minimizedItemSize.width/2:x.minimizedItemCornerRadius;null==u||6==u?(c=a.getPolyline(new primitives.common.PaletteItem({lineColor:g,lineWidth:x.minimizedItemLineWidth,lineType:x.minimizedItemLineType,fillColor:s,opacity:x.minimizedItemOpacity})),c.addSegment(new primitives.common.DotSegment(d,h,l,i,t))):e.draw(a,u,
new primitives.common.Rect(d,h,l,i),new primitives.common.PaletteItem({lineColor:g,lineWidth:x.minimizedItemLineWidth,lineType:x.minimizedItemLineType,fillColor:s,opacity:x.minimizedItemOpacity}));break;default:j&&(g="#ff0000",b.hasOwnProperty(g)||(b[g]=new primitives.common.PaletteItem({lineColor:g,lineWidth:1,lineType:0,fillColor:g,opacity:1})),c=a.getPolyline(b[g]),c.addSegment(new primitives.common.DotSegment(d-1,h-1,2,2,1)))}}));h.activate("placeholder",9);h.polylinesBuffer(a)}var h,i,j=!1,k,
l;return{process:function(){h=a();i=b.getTransform();k=d.getOptions();l=e.getItemsPositions();h.reset("placeholder",9);g();return!1}}};
primitives.orgdiagram.DrawShapeAnnotationTask=function(a,b,c,d,f,e,g,h){function i(a,b){var c,d,e,f,g,i,v,A,w,x,z,E;switch(h){case 1:c=j.activate("placeholder",3);break;case 2:c=j.activate("placeholder",13)}d=0;for(e=a.length;d<e;d+=1)if(z=a[d],null!=z.items&&0<z.items.length){A=new primitives.common.Rect;f=0;for(g=z.items.length;f<g;f+=1)v=b(z.items[f]),null!=v&&A.addRect(v.actualPosition);if(!A.isEmpty()){i=new primitives.common.Shape(j);v=new primitives.orgdiagram.ShapeAnnotationConfig;w="opacity cornerRadius shapeType offset lineWidth borderColor fillColor lineType labelSize labelOffset labelPlacement zOrderType".split(" ");
f=0;for(g=w.length;f<g;f+=1)x=w[f],i[x]=z.hasOwnProperty(x)?z[x]:v[x];i.position=A;i.orientationType=l.orientationType;i.panelSize=c.size;i.labelTemplate=m;i.hasLabel=null!=z.templateName||null!=z.label;E=new primitives.common.RenderEventArgs;E.context=z;E.templateName=i.labelTemplate;k.transformRect(A.x,A.y,A.width,A.height,!0,this,function(a,b,c,d){a=new primitives.common.Rect(a,b,c,d);i.draw(a,E)})}}}var j,k,l,m;return{process:function(){j=a();k=b.getTransform();l=d.getOptions();m=g.getTemplate();
switch(h){case 1:j.reset("placeholder",3);break;case 2:j.reset("placeholder",13)}i(f.getAnnotations(),e.getItemPosition);return!1}}};
primitives.orgdiagram.DrawTreeItemsTask=function(a,b,c,d,f,e,g,h,i,j,k,l){function m(){var a,b=h.getCursorTreeItem(),c,d,e;for(e in n)n.hasOwnProperty(e)&&(c=n[e],d=c.actualPosition,1==c.actualVisibility&&r.transformRect(d.x,d.y,d.width,d.height,!0,this,function(d,h,k,j){var l=g.getTemplateParams(e),m=l.template;a=new primitives.common.RenderEventArgs;a.context=f.getConfig(e);a.isCursor=e==b;a.isSelected=i.isSelected(e);a.templateName=m.templateConfig.name;p.activate("placeholder",12);p.template(d,
h,k,j,c.contentPosition.x,c.contentPosition.y,c.contentPosition.width,c.contentPosition.height,m.itemTemplate.template(),m.itemTemplate.getHashCode(),m.itemTemplate.render,a,{"border-width":m.templateConfig.itemBorderWidth});if(l.hasGroupTitle){var n=0;switch(q.groupTitlePlacementType){case 2:case 0:n=2;break;case 3:n=k-(q.groupTitlePanelSize-4)}p.template(d,h,k,j,n,c.contentPosition.y,q.groupTitlePanelSize-4,c.contentPosition.height+2,t.template(),t.getHashCode(),t.render,a,null)}l.hasSelectorCheckbox&&
(p.activate("placeholder",16),p.template(d,h,k,j,c.contentPosition.x,j-(q.checkBoxPanelSize-4),c.contentPosition.width,q.checkBoxPanelSize-4,u.template(),u.getHashCode(),u.render,a,null));if(l.hasButtons){p.activate("placeholder",16);n=0;switch(q.groupTitlePlacementType){case 2:case 0:n=k-(q.buttonsPanelSize-4);break;case 3:n=2}p.template(d,h,k,j,n,c.contentPosition.y,q.buttonsPanelSize-4,Math.max(c.contentPosition.height,j-c.contentPosition.y),s.template(),m.templateConfig.name+s.getHashCode(),s.render,
l,null)}}))}var n,p,r,q,s,u,t;return{process:function(){p=a();q=d.getOptions();n=e.getItemsPositions();r=b.getTransform();s=l.getTemplate();u=k.getTemplate();t=j.getTemplate();p.reset("placeholder",12);p.reset("placeholder",16);m();return!1}}};
primitives.orgdiagram.ActiveItemsTask=function(a,b){var c={};return{process:function(){var d=a.getOptions(),f=d.items,e,g;c={};e=0;for(g=f.length;e<g;e+=1){var h=f[e],i=b.getTemplate(h.templateName,d.defaultTemplateName,b.DefaultWidgetTemplateName).templateConfig;h.isActive&&i.isActive&&(c[h.id]=!0)}return!0},getActiveItems:function(){return c}}};
primitives.orgdiagram.AnnotationLabelTemplateTask=function(){var a=null;return{process:function(){return!1},getTemplate:function(){null==a&&(a=new primitives.common.AnnotationLabelTemplate);return a}}};primitives.orgdiagram.ButtonsTemplateTask=function(){var a=null;return{process:function(){return!1},getTemplate:function(){null==a&&(a=new primitives.common.ButtonsTemplate);return a}}};
primitives.orgdiagram.CheckBoxTemplateTask=function(a){var b=null;return{process:function(){b=null;return!0},getTemplate:function(){var c;null==b&&(c=a.getOptions(),b=new primitives.common.CheckBoxTemplate(c.selectCheckBoxLabel));return b}}};primitives.orgdiagram.GroupTitleTemplateTask=function(a){var b=null;return{process:function(){b=null;return!0},getTemplate:function(){var c;null==b&&(c=a.getOptions(),b=new primitives.common.GroupTitleTemplate(c));return b}}};
primitives.orgdiagram.ItemTemplateParamsTask=function(a,b,c){function d(a,b,c){var d=!1;switch(b){case 0:switch(c){case 0:d=a;break;case 1:d=!0;break;case 2:d=!1}break;case 1:d=!0;break;case 2:d=!1}return d}var f={};return{process:function(){var e=a.getOptions(),g=0<e.buttons.length,h=b.getCursorItem(),i=e.items,j,k;f={};j=0;for(k=i.length;j<k;j+=1){var l=i[j],m=new primitives.orgdiagram.TemplateParams,n=h==l.id,p=c.getTemplate(l.templateName,e.defaultTemplateName,c.DefaultWidgetTemplateName),r=p.templateConfig,
q=null!=r.buttons&&0<r.buttons.length;m.template=p;m.isActive=l.isActive&&r.isActive;m.isActive&&(m.hasSelectorCheckbox=d(n,l.hasSelectorCheckbox,e.hasSelectorCheckbox),m.hasButtons=(g||q)&&d(n,l.hasButtons,e.hasButtons),m.hasButtons&&(m.buttons=q?r.buttons:e.buttons));m.hasGroupTitle=!primitives.common.isNullOrEmpty(l.groupTitle);f[l.id]=m}return!0},getTemplateParams:function(a){return f[a]}}};
primitives.orgdiagram.ReadTemplatesTask=function(a){var b={};return{process:function(){var c,d,f,e=a.getOptions(),g=e.templates;b={};b.DefaultWidgetTemplate=new primitives.orgdiagram.Template(e,new primitives.orgdiagram.TemplateConfig);c=new primitives.orgdiagram.TemplateConfig;c.name="DefaultWidgetLabelAnnotationTemplate";c.isActive=!1;c.itemSize=new primitives.common.Size(100,20);c.minimizedItemSize=new primitives.common.Size(0,0);d=new primitives.orgdiagram.Template;d.templateConfig=c;d.minimizedItemCornerRadius=
c.minimizedItemSize.width/2;d.itemTemplate=new primitives.common.LabelAnnotationTemplate;d.dotHighlightTemplate=new primitives.common.DotHighlightTemplate(e,c);b.DefaultWidgetLabelAnnotationTemplate=d;c=0;for(d=g.length;c<d;c+=1)f=g[c],b[f.name]=new primitives.orgdiagram.Template(e,f);return!0},getTemplate:function(a,d,f){return b[a]||b[d]||b[f]},DefaultWidgetTemplateName:"DefaultWidgetTemplate",DefaultWidgetLabelAnnotationTemplateName:"DefaultWidgetLabelAnnotationTemplate"}};
primitives.orgdiagram.CombinedNormalVisibilityItemsTask=function(a,b,c,d,f,e,g,h,i,j,k,l){function m(a){var b=[],c,d,e,f,g,h,k={};c=0;for(d=a.length;c<d;c+=1){e=a[c];g=e.getItems();e=0;for(f=g.length;e<f;e+=1)h=g[e],k.hasOwnProperty(h)||(b.push(h),k[h]=!0)}return b}var n=[],p={},r=[b,c,d,f,e,g,h,i,j,k,l],q=new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0);return{process:function(){var b={isChanged:!1,hash:p},c=a.getOptions();n=q.read(n,m(r),"items",b);
if(0==c.pageFitMode||1==c.minimalVisibility)b.isChanged=!1;return b.isChanged},isItemSelected:function(a){return p.items.hasOwnProperty(a)}}};primitives.orgdiagram.CursorItemTask=function(a,b){var c=null;return{process:function(){var d=a.getCursorItem(),f=null!=b?b.getActiveItems():{};c=null!=d&&f.hasOwnProperty(d)?d:null;return!0},getCursorTreeItem:function(){return c},getItems:function(){return null!=c?[c]:[]}}};
primitives.orgdiagram.CursorNeighboursTask=function(a,b){function c(a,b){var c=[];null!==a&&b.loopNeighbours(this,a,function(a,b){0===b.visibility&&c.push(a);return!0});return c}var d=[];return{process:function(){var f=b.getNavigationFamily(),e=a.getCursorTreeItem();d=c(e,f);return!0},getItems:function(){return d}}};
primitives.orgdiagram.HighlightItemTask=function(a,b){var c=null;return{process:function(){var d=a.getHighlightItem(),f=null!=b?b.getActiveItems():{};c=null!=d&&f.hasOwnProperty(d)?d:null;return!0},getHighlightTreeItem:function(){return c}}};
primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask=function(a){function b(a){var b=[],c={},d,f,k,l,m,n;d=0;for(f=a.length;d<f;d+=1)if(k=a[d],k.selectItems){m=k.items;k=0;for(l=m.length;k<l;k+=1)n=m[k],null!=n&&!c.hasOwnProperty(n)&&(b.push(n),c[n]=!0)}return b}var c=[],d={},f=new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0);return{process:function(){var e={isChanged:!1,hash:d},g=a.getAnnotations();c=f.read(c,b(g),"items",e);return e.isChanged},
getItems:function(){return c}}};
primitives.orgdiagram.NormalVisibilityItemsByConnectorAnnotationTask=function(a){function b(a){var b=[],c={},d,f,k;d=0;for(f=a.length;d<f;d+=1)k=a[d],k.selectItems&&(null!=k.fromItem&&!c.hasOwnProperty(k.fromItem)&&(b.push(k.fromItem),c[k.fromItem]=!0),null!=k.toItem&&!c.hasOwnProperty(k.toItem)&&(b.push(k.toItem),c[k.toItem]=!0));return b}var c=[],d={},f=new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0);return{process:function(){var e={isChanged:!1,hash:d},
g=a.getAnnotations();c=f.read(c,b(g),"items",e);return e.isChanged},getItems:function(){return c}}};
primitives.orgdiagram.SelectedItemsTask=function(a){function b(a){var b=[],c={},d,f,k;d=0;for(f=a.length;d<f;d+=1)k=a[d],null!=k&&!c.hasOwnProperty(k)&&(b.push(k),c[k]=!0);return b}var c=[],d={},f=new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0);return{process:function(){var e={isChanged:!1,hash:d},g=a.getSelectedItems();c=f.read(c,b(g),"items",e);return e.isChanged},getItems:function(){return c},isSelected:function(a){return d.items.hasOwnProperty(a)}}};
primitives.orgdiagram.SelectionPathItemsTask=function(a,b,c,d){function f(a,b,c){var d=[],e={},f,m,n;m=0;for(n=a.length;m<n;m+=1)switch(f=a[m],c){case 1:b.loopParents(this,f,function(a,c){if(null!=e[a])return b.SKIP;4!=c.visibility&&d.push(a);e[a]=!0})}return d}var e=[];return{process:function(){var g=d.getSelectionPathMode(),h=a.getNavigationFamily(),i=b.getCursorTreeItem(),j=c.getItems().slice(0);j.push(i);e=f(j,h,g);return!0},getItems:function(){return e}}};
primitives.orgdiagram.CombinedContextsTask=function(a,b){return{process:function(){return!0},getConfig:function(c){return a.getConfig(c)||null!=b&&b.getConfig(c)}}};
primitives.orgdiagram.ConnectionsGraphTask=function(a,b,c,d,f){var e={graph:null,nodeid:0};return{process:function(){for(var g=a().activate("placeholder",6),h=d.getBundles(),i=d.getNestedLayoutBottomConnectorIds(),j=c.getOptions(),k={graph:primitives.common.graph(),nodeid:0},g={treeItemsPositions:f.getItemsPositions(),nestedLayoutBottomConnectorIds:i,transform:b.getTransform(),hasGraphics:g.hasGraphics},j={connectorType:j.connectorType,showExtraArrows:j.showExtraArrows,bevelSize:j.bevelSize,elbowType:j.elbowType},
i=0,l=h.length;i<l;i+=1)h[i].trace(k,g,j);e=k;return!0},getGraph:function(){return e.graph}}};
primitives.orgdiagram.ItemsPositionsTask=function(a,b,c,d,f,e,g,h,i,j,k){var l,m;function n(a){var b=new primitives.common.Rect(0,0,0,0),c,d,e,f,g;switch(K.orientationType){case 2:case 3:a.invert()}if(!E.isEmpty())switch(I.pageFitMode){case 0:case 5:c=[new primitives.orgdiagram.LevelVisibility(0,1)];b=p(c,0);break;default:c=[new primitives.orgdiagram.LevelVisibility(0,1)];d=[];switch(I.minimalVisibility){case 2:d.push(2);break;case 0:case 3:case 4:d.push(2),d.push(3)}E.loopLevelsReversed(this,function(a){var b;
for(b=0;b<d.length;b+=1)c.push(new primitives.orgdiagram.LevelVisibility(a,d[b]))});e=p(c,c.length-1);e.addRect(a);e.offset(0,0,5,5);g=f=a=null;b=p(c,0);if(!r(b,e)&&(a=0,b=p(c,c.length-1),r(b,e))){for(g=f=c.length-1;1<f-a;)g=Math.floor((f+a)/2),b=p(c,g),r(b,e)?f=g:a=g;f!==g&&(b=p(c,f))}}return b}function p(a,b){var c,d;D=[];E.loopLevels(this,function(){var a=new primitives.orgdiagram.TreeLevelPosition;a.currentvisibility=1;D.push(a)});for(c=0;c<=b;c+=1)d=a[c],D[d.level].currentvisibility=d.currentvisibility;
u();v();t();c=I.lineLevelShift;var e,f,g,k,l=d=0;e=8*F.linesWidth;switch(F.arrowsDirection){case 1:d=e;l=0;break;case 2:d=0,l=e}e=0;for(f=D.length;e<f;e+=1)g=D[e],k=h.getConnectorsStacksSizes(e),c+=g.setShift(c,y(g.actualVisibility),l,d,k.parentsStackSize);return new primitives.common.Rect(0,0,Math.round(s()),Math.round(q()))}function r(a,b){var c=!1;switch(I.pageFitMode){case 1:b.width>=a.width&&(c=!0);break;case 2:b.height>=a.height&&(c=!0);break;case 3:b.height>=a.height&&b.width>=a.width&&(c=
!0)}return c}function q(){var a=D[D.length-1];return a.shift+a.nextLevelShift}function s(){var a=0,b,c;b=0;for(c=D.length;b<c;b+=1)a=Math.max(a,D[b].currentOffset);return a+=I.normalItemsInterval}function u(){var a=j.getCursorTreeItem();l={};E.loopLevels(this,function(b){var c=D[b];E.loopLevelItems(this,b,function(b,d){var e=new primitives.orgdiagram.TreeItemPosition,f=k.isItemSelected(b)?1:d.visibility,g=i.getTemplateParams(b),f=0===f?c.currentvisibility:f,h=a==b,j=I,m=K.orientationType,n,p,r;switch(f){case 1:n=
g.template.templateConfig;p=new primitives.common.Size(n.itemSize);r=new primitives.common.Rect(0,0,p.width,p.height);h&&(p.height+=n.cursorPadding.top+n.cursorPadding.bottom,p.width+=n.cursorPadding.left+n.cursorPadding.right,r.x=n.cursorPadding.left,r.y=n.cursorPadding.top);g.hasSelectorCheckbox&&(p.height+=j.checkBoxPanelSize);if(g.hasButtons)switch(p.width+=j.buttonsPanelSize,j.groupTitlePlacementType){case 3:r.x+=j.buttonsPanelSize}if(g.hasGroupTitle)switch(p.width+=j.groupTitlePanelSize,j.groupTitlePlacementType){case 3:break;
default:r.x+=j.groupTitlePanelSize}break;case 2:n=g.template.templateConfig;p=new primitives.common.Size(n.minimizedItemSize);break;case 3:case 4:p=new primitives.common.Size}switch(m){case 2:case 3:p.invert()}e.actualVisibility=f;e.actualSize=p;e.contentPosition=r;l[b]=e})})}function t(){var a,b;E.loopLevels(this,function(c){var d=D[c];d.shift=0;d.depth=0;d.actualVisibility=4;b=a=null;E.loopLevelItems(this,c,function(c){c=l[c];d.depth=Math.max(d.depth,c.actualSize.height);switch(c.actualVisibility){case 2:case 3:case 4:b=
!b?c.actualSize.height:Math.min(b,c.actualSize.height);break;default:a=!a?c.actualSize.height:Math.min(a,c.actualSize.height)}d.actualVisibility=Math.min(d.actualVisibility,c.actualVisibility)});null==a&&(a=d.depth);null!=b&&b>a&&(a=b);switch(I.verticalAlignment){case 0:d.horizontalConnectorsDepth=a/2;break;case 1:d.horizontalConnectorsDepth=d.depth/2;break;case 2:d.horizontalConnectorsDepth=d.depth-a/2}})}function y(a){var b=0;switch(a){case 1:b=I.normalLevelShift;break;case 2:b=I.dotLevelShift;
break;case 3:case 4:b=I.lineLevelShift}return b}function v(){var a,b;a=0;for(b=D.length;a<b;a+=1)D[a].currentOffset=0;B.loopPostOrder(this,function(a,b){var c=l[a],d=c.actualVisibility,e=E.getLevelIndex(a),e=D[e],d=J[0===d?e.currentvisibility:d]/2,f,g,k,h,j,i,m,n;f=8*F.linesWidth;c.leftPadding=d+(0<e.currentOffset?d*b.relationDegree*I.cousinsIntervalMultiplier:0);c.rightPadding=d;0!=F.arrowsDirection&&(b.connectorPlacement&8&&(c.leftPadding+=f),b.connectorPlacement&2&&(c.rightPadding+=f));c.offset=
e.currentOffset+c.leftPadding;e.currentOffset=c.offset+c.actualSize.width+c.rightPadding;if(B.hasChildren(a))if(c=A(b),0<c)x(b,c);else if(0>c&&(c=-c,w(b,c),g=null,k={},j=null,e=B.parent(b.id),null!==e&&(B.loopChildrenReversed(this,e.id,function(a,c){if(c===b)g=[];else if(null!==g){var d=null,e=[],f,i,m,n;f=H[c.id];void 0===f&&(f=[]);f=f.slice();f.splice(0,0,c.id);i=0;for(m=f.length;i<m;i+=1)n=l[f[i]],e[i]=n.offset+n.actualSize.width+n.rightPadding;f=[];var p;i=C[b.id];void 0===i&&(i=[]);i=i.slice();
i.splice(0,0,b.id);m=0;for(n=i.length;m<n;m+=1)p=l[i[m]],f[m]=p.offset-p.leftPadding;i=Math.min(e.length,f.length);for(m=0;m<i&&!(n=f[m]-e[m],d=null!==d?Math.min(d,n):n,0>=n);m+=1);h=Math.floor(d);k[c.id]=h;if(0<h)g.splice(0,0,c);else return j=c,!0}}),0<g.length))){d=null;if(null!==j){i=[j];i=i.concat(g);i.push(b);d=[[j]];e=1;for(f=i.length;e<f;e+=1)m=i[e-1],n=i[e],2==m.gravity||1==n.gravity?d[d.length-1].push(n):d.push([n])}else d=[g.slice(0)],d[d.length-1].push(b);if(0<d.length){g=d[d.length-1];
for(e=g.length-2;0<=e;e-=1)n=g[e],h=k[n.id],c=Math.min(h,c),w(n,c),x(n,c)}i=c/(d.length-1);for(f=d.length-2;0<f;f-=1){m=d[f];for(e=m.length-1;0<=e;e-=1)n=m[e],h=k[n.id],c=Math.min(f*i,Math.min(h,c)),w(n,c),x(n,c)}}})}function A(a){var b=l[a.id],b=b.offset+b.actualSize.width/2,c=null,d,e,f;if(null===a.visualAggregatorId)switch(d=null,B.loopChildren(this,a.id,function(a,b){d=b;if(d.connectorPlacement&1)return!0}),e=l[d.id],f=null,B.loopChildrenReversed(this,a.id,function(a,b){f=b;if(f.connectorPlacement&
1)return!0}),a=l[f.id],G.horizontalAlignment){case 1:c=e.offset+e.actualSize.width/2;break;case 2:c=a.offset+a.actualSize.width/2;break;case 0:c=(e.offset+a.offset+a.actualSize.width)/2}else a=l[a.visualAggregatorId],c=a.offset+a.actualSize.width/2;return b-c}function w(a,b){var c=l[a.id];c.offset+=b;var d=D[E.getLevelIndex(a.id)];d.currentOffset=Math.max(d.currentOffset,c.offset+c.actualSize.width+c.rightPadding)}function x(a,b){var c,d;B.loopLevels(this,a.id,function(a){c=l[a];c.offset+=b;d=D[E.getLevelIndex(a)];
d.currentOffset=Math.max(d.currentOffset,c.offset+c.actualSize.width);return!0})}function z(){var a=null;E.loopLevels(this,function(b){var c=D[b];E.loopLevelItems(this,b,function(b){var d,e,f,g,k,h,b=l[b];d=b.actualSize;g=a;e=0;switch(b.actualVisibility){case 1:switch(I.verticalAlignment){case 0:e=0;break;case 1:e=(c.depth-d.height)/2;break;case 2:e=c.depth-d.height}break;case 2:case 3:case 4:e=c.horizontalConnectorsDepth-d.height/2}d=new primitives.common.Rect(b.offset,c.shift+e,d.width,d.height);
e=c.shift+c.horizontalConnectorsDepth;f=null!=g?g.shift+g.connectorShift:null;g=null!=g?g.levelSpace/2:null;k=c.shift+c.connectorShift;h=c.levelSpace/2;b.actualPosition=d;b.horizontalConnectorsShift=e;b.topConnectorShift=f;b.topConnectorInterval=g;b.bottomConnectorShift=k;b.bottomConnectorInterval=h});a=c})}l={};m=null;var E,D,B,C,H,K,F,G,I,O,J;return{process:function(){var k;k=I=d.getOptions();var j=[];j[1]=k.normalItemsInterval;j[2]=k.dotItemsInterval;j[3]=k.lineItemsInterval;j[4]=k.lineItemsInterval;
J=j;K=c.getOptions();F=f.getOptions();G=e.getOptions();E=h.getTreeLevels();B=g.getVisualTree();C=g.getLeftMargins();H=g.getRightMargins();D=[];l={};k=a.getOptimalPanelSize();O=b.getOptions();k.scale(1/O.scale);k=new primitives.common.Rect(0,0,k.width,k.height);m=n(k);z();return!0},getItemsPositions:function(){return l},getItemPosition:function(a){return l[a]},getContentSize:function(){return m}}};
primitives.orgdiagram.OrgTreeTask=function(a){var b,c;function d(a){var d,h,i,j,k,l=0,m,n=primitives.common.tree();j=0;for(k=a.length;j<k;j+=1)i=a[j],null!=i.id&&(d=new primitives.orgdiagram.OrgItem(i),m=parseInt(i.id,10),l=Math.max(isNaN(m)?0:m,l),n.add(i.parent,d.id,d));l+=1;a=new primitives.orgdiagram.ItemConfig;a.id=l;a.title="internal root";a.isVisible=!1;a.isActive=!1;h=new primitives.orgdiagram.OrgItem(a);h.hideParentConnection=!0;h.hideChildrenConnection=!0;n.add(null,h.id,h);n.loopLevels(this,
function(a,b,c){if(0<c)return n.BREAK;h.id!=a&&(n.adopt(h.id,a),b.itemType=0)});f(n);b=n;c=l;return!0}function f(a){a.loopLevels(this,function(b,c){var d=!0;if(c.isVisible)return a.SKIP;a.loopChildren(this,b,function(a,b){if(0!=b.itemType)return d=!1,!0});if(d)c.hideChildrenConnection=!0,a.loopChildren(this,b,function(a,b){b.hideParentConnection=!0});else return a.SKIP})}c=b=null;return{process:function(){d(a.getItems());return!0},getOrgTree:function(){return b},getMaximumId:function(){return c}}};
primitives.orgdiagram.PaletteManagerTask=function(a,b){var c;return{process:function(){var d=[];null!=b&&(d=b.getOptions().linesPalette);c=new primitives.common.PaletteManager(a.getOptions(),d);return!0},getPaletteManager:function(){return c}}};
primitives.orgdiagram.VisualTreeLevelsTask=function(a){function b(a,b,c,d){var e,f,m,n,p,r,q,s={},u,t,y;c.loopLevels(this,function(v){var A=new primitives.orgdiagram.TreeLevelConnectorStackSize;b[v]=A;q=[];c.loopLevelItems(this,v,function(b,e){var f=[];if(!s.hasOwnProperty(b)&&(e.connectorPlacement&4&&f.push(b),f=f.concat(e.partners),0<f.length)){r=new primitives.common.VerticalConnectorBundle(f,[]);for(var k=0,h=f.length;k<h;k+=1)s[f[k]]=r;d.loopChildren(this,b,function(a,b){b.connectorPlacement&
1&&r.toItems.push(a)});1<f.length&&q.push(r);(1<r.fromItems.length||0<r.toItems.length)&&a.push(r)}e.connectorPlacement&8&&(r=new primitives.common.HorizontalConnectorBundle(b,c.getPrevItem(b)),a.push(r));e.connectorPlacement&2&&(r=new primitives.common.HorizontalConnectorBundle(b,c.getNextItem(b)),a.push(r))});if(0<q.length){y=primitives.common.pile();e=0;for(f=q.length;e<f;e+=1){r=q[e];t=u=null;m=0;for(n=r.fromItems.length;m<n;m+=1)p=c.getItemPosition(r.fromItems[m]),u=null!=u?Math.min(u,p):p,t=
null!=t?Math.max(t,p):p;y.add(u,t,r)}A.parentsStackSize=y.resolve(this,function(a,b,c,d,e){c.fromOffset=d+1;c.fromStackSize=e})}})}var c=null,d=null,f=null,e=new primitives.orgdiagram.TreeLevelConnectorStackSize;return{process:function(){var e=a.getVisualTree();c=primitives.common.TreeLevels();e.loopLevels(this,function(a,b,d){c.addItem(d,a,b)});d=[];f=[];b(d,f,c,e);return!0},getTreeLevels:function(){return c},getBundles:function(){return d},getConnectorsStacksSizes:function(a){return f[a]||e},getNestedLayoutBottomConnectorIds:function(){return{}}}};
primitives.orgdiagram.VisualTreeTask=function(a,b,c,d){function f(a,b,c){var f,g,q,t,u,B,C,H,K,F,G,I,O={},J,U={},L,R,S,V={},T;a.loopPostOrder(this,function(a,b,c,d){b.hasVisibleChildren=b.isVisible||b.hasVisibleChildren;null!=d&&(d.hasVisibleChildren=d.hasVisibleChildren||b.hasVisibleChildren)});a.loopLevels(this,function(e,h){var i,q,K;if(!d&&!h.hasVisibleChildren)return a.SKIP;i=c.node(e);i||(i=p({visibility:4,connectorPlacement:0,parentId:null,actualItemType:0},h),c.add(null,e,i));S=R=0;if(null!=
(B=c.indexOf(e)))R=B,S=c.countSiblings(e)-B-1;q=[];a.loopChildren(this,e,function(a,b){if(d||b.hasVisibleChildren){f=p({parentId:e,actualItemType:b.itemType},b);switch(i.actualItemType){case 7:case 8:case 6:switch(f.actualItemType){case 7:case 8:case 6:f.actualItemType=2;break;case 0:f.actualItemType=1}}switch(f.actualItemType){case 5:r(i,f),f.connectorPlacement=5,K=p({visibility:4}),c.add(K.id,f.id,f),f=K;case 8:case 2:g=c.parent(e);if(i.connectorPlacement&2)t=l(c,s.navigationFamily,i),c.add(g.id,
f.id,f,t+1),f.connectorPlacement=6,f.gravity=2;else if(i.connectorPlacement&8)u=m(c,s.navigationFamily,i),c.add(g.id,f.id,f,u),f.connectorPlacement=12,f.gravity=1;else switch(b.adviserPlacementType){case 2:t=l(c,s.navigationFamily,i);c.add(g.id,f.id,f,t+1);f.connectorPlacement=6;f.gravity=2;break;default:u=m(c,s.navigationFamily,i),c.add(g.id,f.id,f,u),f.connectorPlacement=12,f.gravity=1}switch(f.actualItemType){case 8:null!=i.parentId?r(c.node(i.parentId),f):r(i,f,!0);break;case 2:r(i,f)}break;case 4:r(i,
f),f.connectorPlacement=5,K=p({visibility:4}),c.add(K.id,f.id,f),f=K;case 1:null===i.visualAggregatorId&&n(c,i,!1);switch(b.adviserPlacementType){case 2:c.add(e,f.id,f,0);f.connectorPlacement=6;f.gravity=2;break;default:c.add(e,f.id,f),f.connectorPlacement=12,f.gravity=1}1==f.actualItemType&&r(i,f);break;case 0:q.push(f);r(i,f);break;case 7:case 6:g=c.parent(e);if(i.connectorPlacement&2)c.add(g.id,f.id,f,R),f.connectorPlacement=6,f.gravity=2;else if(i.connectorPlacement&8)c.add(g.id,f.id,f,c.countChildren(g.id)-
S),f.connectorPlacement=12,f.gravity=1;else{switch(b.adviserPlacementType){case 2:c.add(g.id,f.id,f,R);f.gravity=2;break;default:c.add(g.id,f.id,f,c.countChildren(g.id)-S),f.gravity=1}switch(f.actualItemType){case 6:f.connectorPlacement=5;break;case 7:f.connectorPlacement=4}}null!=i.parentId?r(c.node(i.parentId),f):r(i,f,!0)}}});switch(i.actualItemType){case 7:case 8:case 6:break;default:T=[],null!=(g=c.parent(e))&&c.loopChildrenRange(this,g.id,R,c.countChildren(g.id)-S,function(b,c){if(c.id==e)T.push(c);
else switch(c.actualItemType){case 7:case 8:case 6:a.parentid(c.id)==e&&T.push(c)}}),1<T.length&&(V[e]=T)}O[e]=[];U[e]=[];var H=i,F=h.childrenPlacementType,I=O[e],z=U[e],G,C,J,L,W,X,N,M,Q=4==H.visibility&&0===H.connectorPlacement;switch(b.horizontalAlignment){case 0:case 1:C=3;break;case 2:C=2}0===F&&(F=k(a,H)?0===b.leavesPlacementType?3:b.leavesPlacementType:0===b.childrenPlacementType?2:b.childrenPlacementType);G=H;null!==H.visualAggregatorId&&(G=c.node(H.visualAggregatorId));3==F&&3>q.length&&
(F=2);switch(F){case 2:F=0;for(L=q.length;F<L;F+=1)H=q[F],I=a.node(H.id),c.add(G.id,H.id,H),H.connectorPlacement=(I.hideParentConnection?0:1)|(I.hideChildrenConnection?0:4),0===F&&(H.relationDegree=1);break;case 3:L=Math.min(b.maximumColumnsInMatrix,Math.ceil(Math.sqrt(q.length)));W=Math.ceil(q.length/L);X=Math.ceil(L/2);for(N=0;N<X;N+=1){C=G;for(M=0;M<W;M+=1){H=j(q,2*N,M,L);F=j(q,2*N+1,M,L);void 0===I[M]&&(I[M]=[],z[M]=[]);null!==H&&(0===N&&(H.relationDegree=1),c.add(C.id,H.id,H),H.connectorPlacement=
(Q?0:2)|4,H.gravity=2,z[M].push(H));if(null!==H||null!==F)J=p({visibility:4,connectorPlacement:Q?0:5}),c.add(C.id,J.id,J),I[M].push(J);null!==F&&(c.add(C.id,F.id,F),F.connectorPlacement=(Q?0:8)|4,F.gravity=1,z[M].push(F));C=J}}2<L&&(G.visualAggregatorId=null);break;case 1:F=0;for(L=q.length;F<L;F+=1){H=q[F];J=p({visibility:4,connectorPlacement:Q?0:5});switch(C){case 2:c.add(G.id,H.id,H);c.add(G.id,J.id,J);H.connectorPlacement=(Q?0:2)|4;H.gravity=2;break;case 3:c.add(G.id,J.id,J),c.add(G.id,H.id,H),
H.connectorPlacement=(Q?0:8)|4,H.gravity=1}I[F]=[J];z[F]=[H];G=J}break;default:throw"Children placement is undefined!";}});a.loopPostOrder(this,function(a){var b=c.node(a),d,f,g;if(null!=b){d=U[a];f=O[a];F=h(c,b);if(0<F&&(b.visualDepth=F+1,null!==b.visualAggregatorId)){q=c.node(b.visualAggregatorId);g=c.hasChildren(q.id);for(B=0;B<F-1;B+=1)q=n(c,q,!g)}g=0;var k=c.parent(b.id),j,l,m;if(null!==k){j=c.indexOf(b.id);for(l=1;null!=(m=c.getChild(k.id,j+l));)if(m.connectorPlacement&8)g=Math.max(g,i(c,m)),
l+=1;else break;for(l=1;null!=(m=c.getChild(k.id,j-l));)if(m.connectorPlacement&2)g=Math.max(g,i(c,m)),l+=1;else break}F=g;if(1<F){b.visualDepth+=F-1;g=c.hasChildren(a);q=b;for(B=0;B<F-1;B+=1)q=n(c,q,!g)}G=[];B=0;for(C=d.length;B<C;B+=1){L=d[B];H=G[B]=0;for(K=L.length;H<K;H+=1)G[B]=Math.max(G[B],i(c,L[H]))}B=0;for(C=G.length;B<C;B+=1)if(I=G[B],1<I){H=0;for(K=f[B].length;H<K;H+=1)if(J=f[B][H],c.hasChildren(J.id))for(F=I;1<F;)J=n(c,J,!1),F-=1}null!=V[a]&&e(c,b,V[a])}})}function e(a,b,c){var d,e,f,k,
h=0,i=[],j,m;e=0;for(f=c.length;e<f;e+=1)d=c[e],h=Math.max(h,d.visualDepth);e=0;for(f=c.length;e<f;e+=1){d=c[e];j=g(a,d);k=1;for(m=d;null!=m.visualAggregatorId;)m=a.node(m.visualAggregatorId),m.connectorPlacement=5,k+=1;for(;k<h;)j=n(a,j,!1),k+=1;i.push(g(a,j).id)}m=g(a,b);if(a.hasChildren(m.id)){j=c[Math.floor(c.length/2)];if(1<c.length&&0===c.length%2){e=a.parent(j.id);f=l(a,s.navigationFamily,j);k=a.getChild(e.id,f).gravity||a.getChild(e.id,f+1).gravity;j=p({visibility:4,connectorPlacement:j.connectorPlacement&
10,gravity:k});a.add(e.id,j.id,j,f+1);for(k=1;k<h;)j=n(a,j,!1),j.connectorPlacement=0,k+=1}e=0;for(f=c.length;e<f;e+=1)d=c[e],s.navigationFamily.loopChildren(this,b.id,function(a,c){switch(c.actualItemType){case 5:case 2:case 4:case 1:break;default:b.id!=d.id&&r(d,c)}return s.navigationFamily.SKIP});j=g(a,j);a.moveChildren(m.id,j.id)}j.partners=i}function g(a,b){for(var c=b;null!=c.visualAggregatorId;)c=a.node(c.visualAggregatorId);return c}function h(a,b){var c=0;null!=b.visualAggregatorId&&a.loopLevels(this,
b.id,function(d,e,f){if(b.visualAggregatorId==d)return a.SKIP;c=f+1});return c}function i(a,b){var c=0;a.loopLevels(this,b.id,function(a,b,d){c=d+1});return c+1}function j(a,b,c,d){0<d%2&&(b===d-1?b=a.length:b===d&&(b=d-1));b=c*d+b;return b>a.length-1?null:a[b]}function k(a,b){var c=!1,d=!0;a.loopChildren(this,b.id,function(b,e){c=!0;if(0===e.itemType&&a.hasChildren(b))return d=!1,!0});return c&&d}function l(a,b,c){var d=null,e={},f=a.parent(c.id);a.loopChildrenReversed(this,f.id,function(a,f,g){if(null===
d)a==c.id&&(d=-1,e[c.id]=!0,b.loopChildren(this,c.id,function(a,c,d){if(0<d)return b.BREAK;e[a]=!0}));else if(e.hasOwnProperty(a))b.loopChildren(this,f.id,function(a,c,d){if(0<d)return b.BREAK;e[a]=!0});else return d=g,!0});return d}function m(a,b,c){var d=null,e={},f=a.parent(c.id);a.loopChildren(this,f.id,function(a,f,g,k){if(null===d)a==c.id&&(d=k+1,e[c.id]=!0,b.loopChildren(this,c.id,function(a,c,d){if(0<d)return b.BREAK;e[a]=!0}));else if(e.hasOwnProperty(a))b.loopChildren(this,a,function(a,
c,d){if(0<d)return b.BREAK;e[a]=!0});else return d=g,!0});return d}function n(a,b,c){c=p({visibility:4,visualAggregatorId:b.visualAggregatorId,connectorPlacement:4==b.visibility&&0===b.connectorPlacement||c?0:5});a.insert(b.id,c.id,c);b.visualAggregatorId=c.id;return c}function p(a,b){var c=new primitives.orgdiagram.TreeItem,d;for(d in a)a.hasOwnProperty(d)&&(c[d]=a[d]);null!=b?(c.id=b.id,c.visibility=b.isVisible?0:4):(u+=1,c.id=u);return c}function r(a,b,c){var d=[];c||4==a.visibility||!t.hasOwnProperty(a.id)?
(c||d.push(a.id),s.navigationFamily.loopParents(this,a.id,function(a,b){if(4!=b.visibility&&(d.push(a),t.hasOwnProperty(a)))return s.navigationFamily.SKIP})):d.push(a.id);null!=s.navigationFamily.node(b.id)?s.navigationFamily.adopt(d,b.id):s.navigationFamily.add(d,b.id,b)}function q(a,b,c){a.loop(this,function(a){b[a]=[];c[a]=[]});a.loopPostOrder(this,function(a,d,e){var d=b[e],f=c[e],g=b[a],k=c[a],h;if(null!=e){d[0]||(d[0]=a);e=0;for(h=g.length;e<h;e+=1)d[e+1]||(d[e+1]=g[e]);f[0]=a;e=0;for(h=k.length;e<
h;e+=1)f[e+1]=k[e]}})}var s={visualTree:null,leftMargins:{},rightMargins:{},navigationFamily:null},u,t;return{process:function(){var d=a.getOrgTree(),e=c.getOptions();t=null!=b?b.getActiveItems():{};s.visualTree=primitives.common.tree();s.navigationFamily=primitives.common.family();u=a.getMaximumId();d.hasNodes()&&f(d,e,s.visualTree);s.leftMargins={};s.rightMargins={};q(s.visualTree,s.leftMargins,s.rightMargins);return!0},getVisualTree:function(){return s.visualTree},getNavigationFamily:function(){return s.navigationFamily},
getConnectionsFamily:function(){return s.connectionsFamily},getLeftMargins:function(){return s.leftMargins},getRightMargins:function(){return s.rightMargins}}};primitives.common.AnnotationLabelTemplate=function(){var a,b=jQuery("<div></div>");b.addClass("bp-item bp-corner-all bp-connector-label");a=b.wrap("<div>").parent().html();var c=primitives.common.hashCode(a);return{template:function(){return a},getHashCode:function(){return c},render:function(a,b){b.element.html(b.context.label)}}};
primitives.common.ButtonsTemplate=function(){var a,b=jQuery("<ul></ul>");b.css({position:"absolute"}).addClass("ui-widget ui-helper-clearfix");a=b.wrap("<div>").parent().html();var c=primitives.common.hashCode(a);return{template:function(){return a},getHashCode:function(){return c},render:function(a,b){var c=0,g,h=b.buttons,i,j,k;switch(b.renderingMode){case 0:for(k=0;k<h.length;k+=1)g=h[k],j=jQuery('<li data-buttonname="'+g.name+'"></li>').css({position:"absolute",top:c+"px",left:"0px",width:g.size.width+
"px",height:g.size.height+"px",padding:"3px"}).addClass("orgdiagrambutton"),b.element.append(j),i={icons:{primary:g.icon},label:g.label},""!=g.text&&(i.text=g.text),j.button(i),primitives.common.isNullOrEmpty(g.tooltip)||null!=j.tooltip&&j.tooltip({content:g.tooltip}),c+=10+g.size.height}}}};
primitives.common.CheckBoxTemplate=function(a){var b,c=jQuery("<div></div>");c.addClass("bp-item bp-selectioncheckbox-frame");c.append(jQuery('<label><nobr><input type="checkbox" name="checkbox" class="bp-selectioncheckbox" />&nbsp;<span name="selectiontext" class="bp-selectiontext">'+a+"</span></nobr></label>"));b=c.wrap("<div>").parent().html();var d=primitives.common.hashCode(b);return{template:function(){return b},getHashCode:function(){return d},render:function(a,b){b.element.find("[name=checkbox]").prop("checked",
b.isSelected)}}};primitives.common.CursorTemplate=function(a,b){var c;c=jQuery("<div></div>").css({width:b.itemSize.width+b.cursorPadding.left+b.cursorPadding.right+"px",height:b.itemSize.height+b.cursorPadding.top+b.cursorPadding.bottom+"px","border-width":b.cursorBorderWidth+"px"}).addClass("bp-item bp-corner-all bp-cursor-frame").wrap("<div>").parent().html();var d=primitives.common.hashCode(c);return{template:function(){return c},getHashCode:function(){return d},render:function(){}}};
primitives.common.DotHighlightTemplate=function(a,b){var c,d=b.minimizedItemCornerRadius+b.highlightPadding.left;c=jQuery("<div></div>").css({"border-width":b.highlightBorderWidth+"px","-moz-border-radius":d,"-webkit-border-radius":d,"-khtml-border-radius":d,"border-radius":d}).addClass("bp-item bp-highlight-dot-frame").wrap("<div>").parent().html();var f=primitives.common.hashCode(c);return{template:function(){return c},getHashCode:function(){return f},render:function(){}}};
primitives.common.GroupTitleTemplate=function(a){var b,c=jQuery("<div></div>");c.addClass("bp-item bp-corner-all bp-grouptitle-frame");var d=a.groupTitleOrientation,f=a.groupTitleVerticalAlignment,e={"font-size":a.groupTitleFontSize,"font-family":a.groupTitleFontFamily,"font-weight":a.groupTitleFontWeight,"font-style":a.groupTitleFontStyle},g="";jQuery.extend(e,{position:"absolute",padding:0,margin:0,"text-align":function(a){var b=null;switch(a){case 0:b="center";break;case 1:b="left";break;case 2:b=
"right"}return b}(a.groupTitleHorizontalAlignment),"line-height":1});switch(d){case 1:g="rotate(-90deg)";break;case 2:g="rotate(90deg)"}e["-webkit-transform-origin"]="center center";e["-moz-transform-origin"]="center center";e["-o-transform-origin"]="center center";e["-ms-transform-origin"]="center center";e["-webkit-transform"]=g;e["-moz-transform"]=g;e["-o-transform"]=g;e["-ms-transform"]=g;e.transform=g;switch(f){case 0:f=jQuery('<div name="title"></div>');primitives.common.css(f,e);c.append(f);
break;default:e["border-collapse"]="collapse";d=null;switch(f){case 1:d="middle";break;case 0:d="top";break;case 2:d="bottom"}d={"vertical-align":d,padding:0};f=jQuery('<table><tbody><tr><td name="title"></td></tr></tbody></table>');primitives.common.css(f,e);f.find("td").css(d);c.append(f)}b=c.wrap("<div>").parent().html();var h=primitives.common.hashCode(b);return{template:function(){return b},getHashCode:function(){return h},render:function(b,c){var d=c.context,e=d.groupTitleColor||a.groupTitleColor,
f={},g=c.width,h=c.height;f.left=Math.round(g/2-h/2);f.top=Math.round(h/2-g/2);f.width=h;f.height=g;f["max-width"]=f.width;f["max-height"]=f.height;primitives.common.css(jQuery(c.element[0].children[0]),f);f=c.element.find("[name=title]");d=d.groupTitle||"";d=d.replace(RegExp("\n","g"),"<br/>");f.text(d);primitives.common.css(f,{color:primitives.common.highestContrast(e,a.itemTitleSecondFontColor,a.itemTitleFirstFontColor)});primitives.common.css(c.element,{background:e})}}};
primitives.common.HighlightTemplate=function(a,b){function c(){return d}var d;d=jQuery("<div></div>").css({"border-width":b.highlightBorderWidth+"px"}).addClass("bp-item bp-corner-all bp-highlight-frame").wrap("<div>").parent().html();var f=primitives.common.hashCode(c);return{template:c,getHashCode:function(){return f},render:function(){}}};
primitives.common.ItemTemplate=function(a,b){function c(){return d}var d,f=new primitives.common.Size(b.itemSize),e,g,h;f.width-=2*b.itemBorderWidth;f.height-=2*b.itemBorderWidth;e=jQuery("<div></div>").css({"border-width":b.itemBorderWidth+"px"}).addClass("bp-item bp-corner-all bt-item-frame");g=jQuery('<div name="titleBackground"></div>').css({top:"2px",left:"2px",width:f.width-4+"px",height:"18px"}).addClass("bp-item bp-corner-all bp-title-frame");e.append(g);h=jQuery('<div name="title"></div>').css({top:"1px",
left:"4px",width:f.width-4-8+"px",height:"16px"}).addClass("bp-item bp-title");g.append(h);g=jQuery("<div></div>").css({top:"24px",left:"2px",width:"50px",height:"60px"}).addClass("bp-item bp-photo-frame");e.append(g);h=jQuery('<img name="photo" alt=""></img>').css({width:"50px",height:"60px"});g.append(h);f=jQuery('<div name="description"></div>').css({top:"24px",left:"56px",width:f.width-4-56+"px",height:"74px"}).addClass("bp-item bp-description");e.append(f);d=e.wrap("<div>").parent().html();var i=
primitives.common.hashCode(c);return{template:c,getHashCode:function(){return i},render:function(b,c){var d=c.context,e=null!=d.itemTitleColor?d.itemTitleColor:"#4169e1",f=primitives.common.highestContrast(e,a.itemTitleSecondFontColor,a.itemTitleFirstFontColor);c.element.find("[name=titleBackground]").css({background:e});c.element.find("[name=photo]").attr({src:d.image,alt:d.title});c.element.find("[name=title]").css({color:f}).text(d.title);c.element.find("[name=description]").text(d.description)}}};
primitives.common.UserTemplate=function(a,b,c){var d=primitives.common.hashCode(b);return{template:function(){return b},getHashCode:function(){return d},render:function(b,d){if(null!=c)c(b,d);else{var g=d.context,h=null!=g.itemTitleColor?g.itemTitleColor:"#4169e1",i=primitives.common.highestContrast(h,a.itemTitleSecondFontColor,a.itemTitleFirstFontColor);d.element.find("[name=titleBackground]").css({background:h});d.element.find("[name=photo]").attr({src:g.image,alt:g.title});d.element.find("[name=title]").css({color:i}).text(g.title);
d.element.find("[name=description]").text(g.description)}}}};
primitives.orgdiagram.BaseControl=function(a,b,c,d){function f(a){switch(a){case 1:e(!0,t);break;case 2:a=t;q.layout.forceCenterOnCursor=!1;q.tasks.process("HighlightItemOptionTask",null,a);q.graphics.end();break;default:null!=q.mouse&&q.mouse.destroy();j(q.layout);q.layout.element.find("."+q.name).remove();var a=q.layout,b=q.name,f=new primitives.common.Rect(0,0,a.element.outerWidth(),a.element.outerHeight()),s=new primitives.common.Rect(f),x=a.element.offset(),z;z=jQuery('<div tabindex="0"></div>');
z.css({position:"relative",overflow:"auto","-webkit-overflow-scrolling":"touch",top:"0px",left:"0px",width:f.width+"px",height:f.height+"px",padding:"0px","margin-bottom":"0px","margin-right":"0px","margin-top":-x.top+Math.floor(x.top)+"px","margin-left":-x.left+Math.floor(x.left)+"px"});z.addClass(b);f=jQuery("<div></div>");f.css({position:"absolute",overflow:"hidden",top:"0px",left:"0px"});f.addClass(b);f.css(s.getCSS());x=jQuery("<div></div>");x.css({position:"absolute",overflow:"hidden",top:"0px",
left:"0px"});x.addClass("placeholder");x.addClass(b);x.css(s.getCSS());s=jQuery("<div></div>");s.css({position:"absolute",overflow:"visible"});s.addClass("calloutplaceholder");s.addClass(b);s.css({top:"0px",left:"0px",width:"0px",height:"0px"});z.append(f);f.append(x);x.append(s);a.element.append(z);a.scrollPanel=z;a.mousePanel=f;a.placeholder=x;a.calloutPlaceholder=s;q.options.enablePanning&&(q.mouse=new primitives.common.Mouse,q.mouse.init(q.layout.mousePanel,{name:q.name,onMouseDrag:k,onMouseStop:l,
onMouseCapture:m}));a=q.layout;a.mousePanel.mousemove(function(a){var b=q.layout.mousePanel.offset(),c=a.pageX-b.left,b=a.pageY-b.top,d=q.tasks.getTask("CreateTransformTask"),e=q.tasks.getTask("HighlightItemOptionTask");if(!q.mouse||!q.mouse.isStarted())u=!1,e.hasHighlightEnabled()&&(c=d.getTreeItemForMousePosition(c,b,e.getGravityRadius()),n(a,c))}).click(function(a){a:{if(!q.mouse||!q.mouse.isStarted()){var b=q.layout.mousePanel.offset(),c=a.pageX-b.left,e=a.pageY-b.top,f=q.tasks.getTask("CreateTransformTask"),
b=q.tasks.getTask("CursorItemOptionTask"),g=q.tasks.getTask("HighlightItemOptionTask"),c=f.getTreeItemForMousePosition(c,e,g.getGravityRadius()),k;if(!u&&null!==c)if(e=jQuery(a.target),e.hasClass(q.name+"button")||0<e.parent("."+q.name+"button").length)k=e.hasClass(q.name+"button")?e:e.parent("."+q.name+"button"),k=k.data("buttonname"),k=d(q,null,c,k),r("onButtonClick",a,k);else{if("checkbox"===e.attr("name")||"selectiontext"===e.attr("name")){b=(q.options.selectedItems||[]).slice(0);k=d(q,null,c,
k);r("onSelectionChanging",a,k);e=primitives.common.indexOf(b,c);0<=e?b.splice(e,1):b.push(c);q.options.selectedItems=b;r("onSelectionChanged",a,k);u=!0;break a}k=d(q,null,c,void 0);r("onMouseClick",a,k);!k.cancel&&b.hasCursorEnabled()&&(p(a,c),q.layout.scrollPanel.focus())}}u=!1}}).dblclick(function(a){var b;b=q.tasks.getTask("HighlightItemTask").getHighlightTreeItem();null!==b&&!u&&(b=d(q,null,b,void 0),r("onMouseDblClick",a,b));u=!1});a.scrollPanel.keydown(function(a){var b=q.tasks.getTask("HighlightItemTask"),
c=q.tasks.getTask("HighlightItemOptionTask"),d=q.tasks.getTask("CursorItemTask"),e=q.tasks.getTask("CursorItemOptionTask"),f=q.tasks.getTask("AlignDiagramTask"),g=q.tasks.getTask("CreateTransformTask").getTransform(),k=null,h=null,j=q.layout;c.hasHighlightEnabled()&&e.hasCursorEnabled()?(k=b.getHighlightTreeItem(),null===k&&(k=d.getCursorTreeItem())):c.hasHighlightEnabled()?k=b.getHighlightTreeItem():e.hasCursorEnabled()&&(k=d.getCursorTreeItem());if(null!=k){switch(a.which){case 13:e.hasCursorEnabled()&&
(p(a,k),a.preventDefault(),j.scrollPanel.focus());break;case 40:h=1;break;case 38:h=0;break;case 37:h=2;break;case 39:h=3}if(null!=h){for(d=!1;!d;)d=!0,h=g.getOrientation(h),b=f.getNextItem(k,h),null!=b&&(a.preventDefault(),c.hasHighlightEnabled()?n(a,b):e.hasCursorEnabled()&&p(a,b));j.scrollPanel.focus()}}});q.tasks=c(g,h,i);q.graphics=primitives.common.createGraphics(q.options.graphicsType,q.layout.element);q.graphics.debug=t;e(!0,t)}}function e(a,b){var c;q.layout.forceCenterOnCursor=a;q.tasks.process("OptionsTask",
null,b);q.graphics.end();a&&(c=q.tasks.getTask("CenterOnCursorTask"),c=c.getPlaceholderOffset(),q.layout.scrollPanel.scrollLeft(c.x),q.layout.scrollPanel.scrollTop(c.y))}function g(){return q.options}function h(){return q.graphics}function i(){return q.layout}function j(a){null!=a.mousePanel&&(a.mousePanel.unbind("mousemove"),a.mousePanel.unbind("click"),a.mousePanel.unbind("dblclick"));null!=a.scrollPanel&&a.scrollPanel.unbind("keydown")}function k(a){var b=new primitives.common.Point(a.pageX,a.pageY),
a=-b.x+s.x,b=-b.y+s.y,c=q.layout.scrollPanel;c.css("visibility","hidden");c.scrollLeft(a).scrollTop(b);c.css("visibility","inherit");return!1}function l(){u=!0}function m(a){var b=q.layout.scrollPanel;s=new primitives.common.Point(b.scrollLeft()+a.pageX,b.scrollTop()+a.pageY);return!0}function n(a,b){var c=!0,f;null!==b?b!==q.options.highlightItem&&(f=d(q,q.options.highlightItem,b,void 0),q.options.highlightItem=b,r("onHighlightChanging",a,f),f.cancel?c=!1:(e(!1,!1),r("onHighlightChanged",a,f))):
null!==q.options.highlightItem&&(f=d(q,q.options.highlightItem,null,void 0),q.options.highlightItem=null,r("onHighlightChanging",a,f),f.cancel?c=!1:(e(!1,!1),r("onHighlightChanged",a,f)));return c}function p(a,b){var c;b!==q.options.cursorItem&&(c=d(q,q.options.cursorItem,b,void 0),q.options.cursorItem=b,r("onCursorChanging",a,c),c.cancel||(e(!0,t),r("onCursorChanged",a,c)))}function r(a,b,c){a=q.options[a];null!=a&&a(b,c)}var q={name:"orgdiagram",options:b,tasks:null,graphics:null,mouse:null,layout:{element:a,
scrollPanel:null,mousePanel:null,placeholder:null,calloutPlaceholder:null,forceCenterOnCursor:!0}},s,u,t=!1;f();return{destroy:function(){j(q.layout);q.layout.element.find("."+q.name).remove();q.tasks=null;q.graphics=null},setOptions:function(a){for(var b in a)a.hasOwnProperty(b)&&(q.options[b]=a[b])},getOptions:g,setOption:function(a,b){return q.options[a]=b},getOption:function(a){return q.options[a]},update:f,getProcessDiagramConfig:function(){return c(g,h,i).getProcessDiagramConfig()}}};
primitives.orgdiagram.Control=function(a,b){return primitives.orgdiagram.BaseControl(a,b,function(a,b,f){var e=new primitives.common.TaskManager;e.addDependency("options",a);e.addDependency("graphics",b);e.addDependency("layout",f);e.addDependency("defaultConfig",new primitives.orgdiagram.Config);e.addDependency("defaultItemConfig",new primitives.orgdiagram.ItemConfig);e.addDependency("defaultTemplateConfig",new primitives.orgdiagram.TemplateConfig);e.addDependency("defaultButtonConfig",new primitives.orgdiagram.ButtonConfig);
e.addDependency("defaultBackgroundAnnotationConfig",new primitives.orgdiagram.BackgroundAnnotationConfig);e.addDependency("defaultConnectorAnnotationConfig",new primitives.orgdiagram.ConnectorAnnotationConfig);e.addDependency("defaultHighlightPathAnnotationConfig",new primitives.orgdiagram.HighlightPathAnnotationConfig);e.addDependency("defaultShapeAnnotationConfig",new primitives.orgdiagram.ShapeAnnotationConfig);e.addDependency("isFamilyChartMode",!1);e.addDependency("showElbowDots",!1);e.addDependency("null",
null);e.addDependency("foreground",2);e.addDependency("background",1);e.addTask("OptionsTask",["options"],primitives.orgdiagram.OptionsTask,"#000000");e.addTask("CurrentControlSizeTask",["layout","OptionsTask","ItemsSizesOptionTask"],primitives.orgdiagram.CurrentControlSizeTask,"#000000");e.addTask("CurrentScrollPositionTask",["layout","OptionsTask"],primitives.orgdiagram.CurrentScrollPositionTask,"#000000");e.addTask("CalloutOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],primitives.orgdiagram.CalloutOptionTask,
"#000080");e.addTask("ConnectorsOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.ConnectorsOptionTask,"#000080");e.addTask("ItemsOptionTask",["OptionsTask","defaultItemConfig"],primitives.orgdiagram.ItemsOptionTask,"#000080");e.addTask("ItemsSizesOptionTask",["OptionsTask","defaultConfig","defaultItemConfig","defaultButtonConfig"],primitives.orgdiagram.ItemsSizesOptionTask,"#000080");e.addTask("LabelsOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],primitives.orgdiagram.LabelsOptionTask,
"#000080");e.addTask("TemplatesOptionTask",["OptionsTask","defaultConfig","defaultButtonConfig","defaultTemplateConfig"],primitives.orgdiagram.TemplatesOptionTask,"#000080");e.addTask("OrientationOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.OrientationOptionTask,"#000080");e.addTask("VisualTreeOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.VisualTreeOptionTask,"#000080");e.addTask("MinimizedItemsOptionTask",["OptionsTask"],primitives.orgdiagram.MinimizedItemsOptionTask,
"#000080");e.addTask("CursorItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.CursorItemOptionTask,"#000080");e.addTask("HighlightItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.HighlightItemOptionTask,"#000080");e.addTask("SelectedItemsOptionTask",["OptionsTask"],primitives.orgdiagram.SelectedItemsOptionTask,"#000080");e.addTask("CursorSelectionPathModeOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.CursorSelectionPathModeOptionTask,"#000080");
e.addTask("SplitAnnotationsOptionTask",["OptionsTask"],primitives.orgdiagram.SplitAnnotationsOptionTask,"#00ffff");e.addTask("ForegroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","foreground"],primitives.orgdiagram.ShapeAnnotationOptionTask,"#000080");e.addTask("BackgroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","background"],primitives.orgdiagram.ShapeAnnotationOptionTask,"#000080");e.addTask("ForegroundHighlightPathAnnotationOptionTask",
["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","foreground"],primitives.orgdiagram.HighlightPathAnnotationOptionTask,"#000080");e.addTask("BackgroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","background"],primitives.orgdiagram.HighlightPathAnnotationOptionTask,"#000080");e.addTask("ForegroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","foreground"],primitives.orgdiagram.ConnectorAnnotationOptionTask,
"#000080");e.addTask("BackgroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","background"],primitives.orgdiagram.ConnectorAnnotationOptionTask,"#000080");e.addTask("BackgroundAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultBackgroundAnnotationConfig"],primitives.orgdiagram.BackgroundAnnotationOptionTask,"#000080");e.addTask("ScaleOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.ScaleOptionTask,"#000080");e.addTask("CombinedContextsTask",
["ItemsOptionTask"],primitives.orgdiagram.CombinedContextsTask,"#00ffff");e.addTask("OrgTreeTask",["ItemsOptionTask"],primitives.orgdiagram.OrgTreeTask,"#ff0000");e.addTask("ReadTemplatesTask",["TemplatesOptionTask"],primitives.orgdiagram.ReadTemplatesTask,"#00ffff");e.addTask("ActiveItemsTask",["ItemsSizesOptionTask","ReadTemplatesTask"],primitives.orgdiagram.ActiveItemsTask,"#00ffff");e.addTask("ItemTemplateParamsTask",["ItemsSizesOptionTask","CursorItemOptionTask","ReadTemplatesTask"],primitives.orgdiagram.ItemTemplateParamsTask,
"#00ffff");e.addTask("GroupTitleTemplateTask",["TemplatesOptionTask"],primitives.orgdiagram.GroupTitleTemplateTask,"#00ffff");e.addTask("CheckBoxTemplateTask",["ItemsSizesOptionTask"],primitives.orgdiagram.CheckBoxTemplateTask,"#00ffff");e.addTask("ButtonsTemplateTask",["ItemsSizesOptionTask"],primitives.orgdiagram.ButtonsTemplateTask,"#00ffff");e.addTask("AnnotationLabelTemplateTask",["ItemsOptionTask"],primitives.orgdiagram.AnnotationLabelTemplateTask,"#00ffff");e.addTask("VisualTreeTask",["OrgTreeTask",
"ActiveItemsTask","VisualTreeOptionTask","isFamilyChartMode"],primitives.orgdiagram.VisualTreeTask,"#ff0000");e.addTask("VisualTreeLevelsTask",["VisualTreeTask","ItemTemplateParamsTask"],primitives.orgdiagram.VisualTreeLevelsTask,"#ff0000");e.addTask("ConnectionsGraphTask",["graphics","CreateTransformTask","ConnectorsOptionTask","VisualTreeLevelsTask","AlignDiagramTask"],primitives.orgdiagram.ConnectionsGraphTask,"#00ffff");e.addTask("HighlightItemTask",["HighlightItemOptionTask","ActiveItemsTask"],
primitives.orgdiagram.HighlightItemTask,"#00ffff");e.addTask("CursorItemTask",["CursorItemOptionTask","ActiveItemsTask"],primitives.orgdiagram.CursorItemTask,"#00ffff");e.addTask("CursorNeighboursTask",["CursorItemTask","VisualTreeTask"],primitives.orgdiagram.CursorNeighboursTask,"#00ffff");e.addTask("SelectedItemsTask",["SelectedItemsOptionTask"],primitives.orgdiagram.SelectedItemsTask,"#00ffff");e.addTask("SelectionPathItemsTask",["VisualTreeTask","CursorItemTask","SelectedItemsTask","CursorSelectionPathModeOptionTask"],
primitives.orgdiagram.SelectionPathItemsTask,"#00ffff");e.addTask("NormalVisibilityItemsByForegroundShapeAnnotationTask",["ForegroundShapeAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");e.addTask("NormalVisibilityItemsByBackgroundShapeAnnotationTask",["BackgroundShapeAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");e.addTask("NormalVisibilityItemsByBackgroundAnnotationTask",["BackgroundAnnotationOptionTask"],
primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");e.addTask("NormalVisibilityItemsByForegroundHighlightPathAnnotationTask",["ForegroundHighlightPathAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");e.addTask("NormalVisibilityItemsByBackgroundHighlightPathAnnotationTask",["BackgroundHighlightPathAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");e.addTask("NormalVisibilityItemsByForegroundConnectorAnnotationTask",
["ForegroundConnectorAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByConnectorAnnotationTask,"#00ffff");e.addTask("NormalVisibilityItemsByBackgroundConnectorAnnotationTask",["BackgroundConnectorAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByConnectorAnnotationTask,"#00ffff");e.addTask("CombinedNormalVisibilityItemsTask","ItemsSizesOptionTask CursorItemTask CursorNeighboursTask SelectedItemsTask SelectionPathItemsTask NormalVisibilityItemsByForegroundShapeAnnotationTask NormalVisibilityItemsByBackgroundShapeAnnotationTask NormalVisibilityItemsByBackgroundAnnotationTask NormalVisibilityItemsByForegroundHighlightPathAnnotationTask NormalVisibilityItemsByBackgroundHighlightPathAnnotationTask NormalVisibilityItemsByForegroundConnectorAnnotationTask NormalVisibilityItemsByBackgroundConnectorAnnotationTask".split(" "),
primitives.orgdiagram.CombinedNormalVisibilityItemsTask,"#00ffff");e.addTask("ItemsPositionsTask","CurrentControlSizeTask ScaleOptionTask OrientationOptionTask ItemsSizesOptionTask ConnectorsOptionTask VisualTreeOptionTask VisualTreeTask VisualTreeLevelsTask ItemTemplateParamsTask CursorItemTask CombinedNormalVisibilityItemsTask".split(" "),primitives.orgdiagram.ItemsPositionsTask,"#ff0000");e.addTask("AlignDiagramTask","OrientationOptionTask ItemsSizesOptionTask VisualTreeOptionTask ScaleOptionTask CurrentControlSizeTask ActiveItemsTask ItemsPositionsTask isFamilyChartMode".split(" "),
primitives.orgdiagram.AlignDiagramTask,"#ff0000");e.addTask("CreateTransformTask",["OrientationOptionTask","AlignDiagramTask"],primitives.orgdiagram.CreateTransformTask,"#00ffff");e.addTask("CenterOnCursorTask","layout CurrentControlSizeTask CurrentScrollPositionTask CursorItemTask AlignDiagramTask CreateTransformTask ScaleOptionTask".split(" "),primitives.orgdiagram.CenterOnCursorTask,"#00ffff");e.addTask("PaletteManagerTask",["ConnectorsOptionTask","null"],primitives.orgdiagram.PaletteManagerTask,
"#00ffff");e.addTask("ApplyLayoutChangesTask","graphics layout ItemsSizesOptionTask CurrentControlSizeTask ScaleOptionTask AlignDiagramTask".split(" "),primitives.orgdiagram.ApplyLayoutChangesTask,"#008000");e.addTask("DrawBackgroundAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask BackgroundAnnotationOptionTask VisualTreeTask AlignDiagramTask".split(" "),primitives.orgdiagram.DrawBackgroundAnnotationTask,"#008000");e.addTask("DrawBackgroundHighlightPathAnnotationTask",["graphics",
"ConnectorsOptionTask","ForegroundHighlightPathAnnotationOptionTask","ConnectionsGraphTask","foreground"],primitives.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff");e.addTask("DrawForegroundHighlightPathAnnotationTask",["graphics","ConnectorsOptionTask","BackgroundHighlightPathAnnotationOptionTask","ConnectionsGraphTask","background"],primitives.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff");e.addTask("DrawForegroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground".split(" "),
primitives.orgdiagram.DrawConnectorAnnotationTask,"#008000");e.addTask("DrawBackgroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background".split(" "),primitives.orgdiagram.DrawConnectorAnnotationTask,"#008000");e.addTask("DrawForegroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground".split(" "),
primitives.orgdiagram.DrawShapeAnnotationTask,"#008000");e.addTask("DrawBackgroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background".split(" "),primitives.orgdiagram.DrawShapeAnnotationTask,"#008000");e.addTask("DrawCursorTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask ItemTemplateParamsTask CursorItemTask SelectedItemsTask".split(" "),
primitives.orgdiagram.DrawCursorTask,"#008000");e.addTask("DrawHighlightTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask ItemTemplateParamsTask HighlightItemTask CursorItemTask SelectedItemsTask".split(" "),primitives.orgdiagram.DrawHighlightTask,"#008000");e.addTask("DrawHighlightAnnotationTask","layout graphics CreateTransformTask ApplyLayoutChangesTask ScaleOptionTask CombinedContextsTask CalloutOptionTask ReadTemplatesTask AlignDiagramTask CenterOnCursorTask HighlightItemTask CursorItemTask SelectedItemsTask".split(" "),
primitives.orgdiagram.DrawHighlightAnnotationTask,"#008000");e.addTask("DrawTreeItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask ItemsSizesOptionTask CombinedContextsTask AlignDiagramTask ItemTemplateParamsTask CursorItemTask SelectedItemsTask GroupTitleTemplateTask CheckBoxTemplateTask ButtonsTemplateTask".split(" "),primitives.orgdiagram.DrawTreeItemsTask,"#008000");e.addTask("DrawMinimizedItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask MinimizedItemsOptionTask ItemTemplateParamsTask AlignDiagramTask".split(" "),
primitives.orgdiagram.DrawMinimizedItemsTask,"#008000");e.addTask("DrawConnectorsTask",["graphics","ConnectionsGraphTask","ConnectorsOptionTask","showElbowDots","PaletteManagerTask"],primitives.orgdiagram.DrawConnectorsTask,"#008000");e.addTask("DrawItemLabelsTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","LabelsOptionTask","AlignDiagramTask"],primitives.orgdiagram.DrawItemLabelsTask,"#008000");return e},function(a,b,f,e){var g=new primitives.orgdiagram.EventArgs,h=a.tasks.getTask("CombinedContextsTask"),
i=a.tasks.getTask("AlignDiagramTask"),b=h.getConfig(b),j=h.getConfig(f);b&&null!=b.id&&(g.oldContext=b);j&&null!=j.id&&(g.context=j,null!==j.parent&&(g.parentItem=h.getConfig(j.parent)),h=a.layout.mousePanel.offset(),a=a.layout.element.offset(),f=i.getItemPosition(f),g.position=(new primitives.common.Rect(f.actualPosition)).translate(h.left,h.top).translate(-a.left,-a.top));null!=e&&(g.name=e);return g})};
primitives.common.binarySearch=function(a,b,c,d){var f=null,e,c=c||0,g=d||a.length-1,h,i;if(0<a.length&&(i=a[c],f={index:c,item:i},d=b(i,c),0<d))if(e=Math.abs(d),i=a[g],d=b(i,g),0<=d)f={index:g,item:i};else{d=Math.abs(d);e>d&&(e=d,f={index:g,item:i});for(;c+1<g;)if(h=Math.round((c+g)/2),i=a[h],d=b(i,h),0===d){f={index:h,item:i};break}else 0<d?c=h:g=h,d=Math.abs(d),e>d&&(e=d,f={index:h,item:i})}return f};
primitives.common.SpatialIndex=function(a){function b(a,b){this.minimum=a;this.maximum=b;this.quadTree=primitives.common.QuadTree(2*b)}var c=[];a.sort(function(a,b){return a-b});switch(a.length){case 0:c.push(new b(0,1E6));break;case 1:var d=a[0];c.push(new b(0,d));break;case 2:d=a[0];a=a[1];a>2*d?(c.push(new b(0,d)),c.push(new b(d,a))):c.push(new b(0,a));break;default:for(var d=primitives.common.getLiniarBreaks(a),f=0,e=0;e<d.length;e+=1){var g=a[d[e]];c.push(new b(f,g));f=g}}return{addRect:function(a){for(var b=
Math.max(a.width,a.height),d=a.centerPoint(),e=0,f=c.length;e<f;e+=1){var g=c[e];if(b<=g.maximum||e==f-1){d.context=a;g.quadTree.addPoint(d);break}}},loopArea:function(a,b,d){if(null!=d)for(var e=0,f=c.length;e<f;e+=1){var g=c[e],n=new primitives.common.Rect(b);n.offset(g.maximum/2);g.quadTree.loopArea(this,n,function(c){c=c.context;if(b.overlaps(c))return d.call(a,c)})}},validate:function(){for(var a=!0,b=0,d=c.length;b<d;b+=1)var e=c[b],a=a&&e.quadTree.validate();return a},getPositions:function(a){for(var b=
[],d=0,e=c.length;d<e;d+=1)b=b.concat(c[d].quadTree.getPositions(a));return b}}};
primitives.common.SortedList=function(){function a(a,b){this.value=a;this.context=b;this.right=this.left=null;this.balance=0}function b(a){var b;if(2==a.balance){var e=a.right;b=e.balance;if(0<=b)c(e,a),1==e.balance?(a.balance=0,e.balance=0):(a.balance=-1,e.balance=1);else{var f=e.left;d(f,e);c(e,a);a.balance=0;switch(f.balance){case 1:e.balance=-1;f.balance=0;break;case 0:f.balance=0;e.balance=0;break;default:f.balance=1,e.balance=0}}}else if(-2==a.balance)if(b=a.left.balance,0>=b)e=a.left,d(e,a),
-1==e.balance?(a.balance=0,e.balance=0):(a.balance=1,e.balance=-1);else switch(e=a.left,f=e.right,c(f,e),d(e,a),a.balance=0,f.balance){case -1:f.balance=0;e.balance=1;break;case 0:f.balance=0;e.balance=0;break;default:f.balance=-1,e.balance=0}return b}function c(a,b){e(a,b);b.right=a.right;a.right=a.left;a.left=b.left;b.left=a}function d(a,b){e(a,b);b.left=a.left;a.left=a.right;a.right=b.right;b.right=a}function f(a,b){var c=null!=a.right?a.right:a.left;null!=b?b.value>a.value?b.left=c:b.right=c:
j=c}function e(a,b){var c=a.value;a.value=b.value;b.value=c;c=a.context;a.context=b.context;b.context=c}function g(a,b,c){if(null!=c){for(var d=[],e=null,e=j;null!=e;)e.value>=b||null==b?(d.push(e),e=e.left):e=e.right;for(;null!=(e=d.pop())&&!c.call(a,e.value,e.context);)for(e=e.right;null!=e;)if(null!=e.left)d.push(e),e=e.left;else{if(c.call(a,e.value,e.context))return;e=e.right}}}function h(a,b,c){if(null!=c){for(var d=[],e=null,e=j;null!=e;)e.value<=b||null==b?(d.push(e),e=e.right):e=e.left;for(;null!=
(e=d.pop())&&!c.call(a,e.value,e.context);)for(e=e.left;null!=e;)if(null!=e.right)d.push(e),e=e.right;else{if(c.call(a,e.value,e.context))return;e=e.left}}}function i(a){var b=[],c=0;if(null!=a)for(b.push(a);0<b.length;){for(var d=[],e=0;e<b.length;e+=1)a=b[e],null!=a.left&&d.push(a.left),null!=a.right&&d.push(a.right);b=d;c+=1}return c}var j=null;return{add:function(c,d,e,f){if(null==j)j=new a(c,d);else{for(var g=[],h=null,i=j;null!=i;)if(null!=h&&g.push(h),h=i,h.value==c)if(null!=f)f.call(e,h.context);
else throw"Structure does not support duplicates.";else i=h.value>c?h.left:h.right;g.push(h);d=new a(c,d);h.value>c?h.left=d:h.right=d;for(h=d;null!=(i=g.pop());){if(h.value<i.value)if(0>i.balance){i.balance-=1;b(i);break}else{if(0<i.balance){i.balance-=1;break}i.balance-=1}else if(0<i.balance){i.balance+=1;b(i);break}else{if(0>i.balance){i.balance+=1;break}i.balance+=1}h=i}}},remove:function(a){for(var c=[],d=j;null!=d;)if(d.value==a){if(null!=d.right&&null!=d.left){c.push(d);for(a=d.right;null!=
a.left;)c.push(a),a=a.left;var e=a;d.value=e.value;d.context=e.context;f(a,c[c.length-1]);c.push(a)}else f(d,c[c.length-1]),c.push(d);for(a=c.length-2;0<=a;a-=1)if(e=c[a],d=c[a+1],e.value>d.value)if(0<e.balance){if(e.balance+=1,0===b(e))break}else{if(0===e.balance){e.balance+=1;break}e.balance+=1}else if(0>e.balance){if(e.balance-=1,0===b(e))break}else{if(0===e.balance){e.balance-=1;break}e.balance-=1}break}else c.push(d),d=d.value>a?d.left:d.right},loopForward:g,loopBackward:h,nextContext:function(a){var b=
null;g(this,a,function(a,c){b=c;return!0});return b},previousContext:function(a){var b=null;h(this,a,function(a,c){b=c;return!0});return b},validate:function(){if(null!=j)for(var a=[j];0<a.length;){for(var b=[],c=0;c<a.length;c+=1){var d=a[c];if(null==d.value||null!=d.left&&(b.push(d.left),d.left.value>=d.value)||null!=d.right&&(b.push(d.right),d.right.value<=d.value))return!1;if(d.balance!=i(d.right)-i(d.left))return console.log("Disbalanced node: "+d.value+" - "+JSON.stringify(j)),!1}a=b}return!0}}};
primitives.common.RMQ=function(a){function b(b,e){var f=Math.floor(Math.log(e-b+1)/d);return a[c[b][f]]<=a[c[e-(1<<f)+1][f]]?c[b][f]:c[e-(1<<f)+1][f]}for(var c=[],d=Math.log(2),f,e=0,g=a.length;e<g;e+=1)c[e]=[e];f=1;for(g=a.length;1<<f<g;f+=1)for(e=0;e+(1<<f)-1<g;e+=1)c[e][f]=a[c[e][f-1]]<a[c[e+(1<<f-1)][f-1]]?c[e][f-1]:c[e+(1<<f-1)][f-1];return{getRangeMinimumIndex:b,getRangeMinimum:function(c,d){return a[b(c,d)]}}};
primitives.common.QuadTree=function(a){function b(a,b,c,d){this.x=a;this.y=b;this.scale=c;this.size=d;this.quadrants=[];this.points=[]}function c(a){var c=a.size/2;a.quadrants=[new b(a.x,a.y,a.scale-1,c),new b(a.x+c,a.y,a.scale-1,c),new b(a.x,a.y+c,a.scale-1,c),new b(a.x+c,a.y+c,a.scale-1,c)];for(var c=0,d=a.points.length;c<d;c+=1){var e=a.points[c];a.quadrants[a.getQuadrantIndex(Math.floor(e.x),Math.floor(e.y))].points.push(e)}a.points=null}var d=Math.max(1,Math.floor(Math.log(a)/Math.log(2))),f=
8,e=256,g=null,g=new b(0,0,f,e);b.prototype.notEnclosed=function(a){return this.x<a.x||this.x+this.size>a.x+a.width||this.y<a.y||this.y+this.size>a.y+a.height?!0:!1};b.prototype.overlaps=function(a){return this.x+this.size<a.x||a.x+a.width<this.x||this.y+this.size<a.y||a.y+a.height<this.y?!1:!0};b.prototype.getQuadrantIndex=function(a,b){var c=this.scale-1;return a>>c&1|(b>>c&1)<<1};return{addPoint:function(a){for(var i=Math.max(Math.floor(a.x),Math.floor(a.y));e<=i;){f+=1;e*=2;var j=new b(0,0,f,
e);c(j);j.quadrants[0]=g;g=j}var i=Math.floor(a.x),j=Math.floor(a.y),k=g;if(0>i||0>j)throw"Negative values are not supported in the quad tree.";for(;(null==k.points||0<k.points.length)&&!(k.scale==d&&null!=k.points);)null!=k.points&&0<k.points.length&&c(k),k=k.quadrants[k.getQuadrantIndex(i,j)];k.points.push(a)},loopArea:function(a,b,c){var d,e,f;if(null!=c)for(var n=[g],p=[];0<n.length||0<p.length;){var r=[],q=[];e=0;for(f=n.length;e<f;e+=1)if(d=n[e],d.overlaps(b))if(d.notEnclosed(b))if(null==d.points)for(var s=
0;4>s;s+=1)r.push(d.quadrants[s]);else for(var s=0,u=d.points.length;s<u;s+=1){var t=d.points[s];if(b.contains(t)&&c.call(a,t))return}else p.push(d);e=0;for(f=p.length;e<f;e+=1)if(d=p[e],null==d.points)for(s=0;4>s;s+=1)q.push(d.quadrants[s]);else{s=0;for(u=d.points.length;s<u;s+=1)if(c.call(a,d.points[s]))return}n=r;p=q}},validate:function(){for(var a=[g];0<a.length;){for(var b=[],c=0,d=a.length;c<d;c+=1){var e=a[c],f=new primitives.common.Rect(e.x,e.y,e.size,e.size);if(null!=e.points&&0<e.quadrants.length)return!1;
if(null==e.points)for(f=0;4>f;f+=1)b.push(e.quadrants[f]);else for(var n=0,p=e.points.length;n<p;n+=1)if(!f.contains(e.points[n]))return!1}a=b}return!0},getPositions:function(a){for(var b=[],c=[g];0<c.length;){for(var d=[],e=0,f=c.length;e<f;e+=1){var n=c[e],p=new primitives.common.Rect(n.x,n.y,n.size,n.size);p.context={isHighlighted:!1};null!=a&&(a.overlaps(p)&&null!=n.points&&0<n.points.length)&&(p.context.isHighlighted=!0);b.push(p);for(p=0;4>p;p+=1){var r=n.quadrants[p];null!=r&&d.push(r)}}c=
d}return b}}};
primitives.common.pile=function(){function a(a,b,c,g){this.context=c;this.from=a;this.to=b;this.offset=null;this.direction=g}function b(a,c,e,g,h){if(a>=c.length)return 0;if(e.hasOwnProperty(a))return e[a];for(var i=c[a],j=b(a+1,c,e,g,h),k=a+1;k<c.length&&!(c[k].from>=i.to);)k+=1;c=1+b(k,c,e,g,h);c>j?(e[a]=c,g[a]=k,h[a]=!0):(e[a]=j,g[a]=a+1,h[a]=!1);return e[a]}var c=[];return{add:function(b,f,e){b<f?c.push(new a(b,f,e,1)):c.push(new a(f,b,e,-1))},resolve:function(a,f){var e,g,h,i,j,k,l=0;if(null!=
f){i=c.slice(0);i.sort(function(a,b){return a.from-b.from});for(j=[];0<i.length;){e={};g={};h={};b(0,i,e,g,h);e=[];j[l]=[];for(k=0;g.hasOwnProperty(k);)h[k]&&(e.push(k),j[l].push(i[k])),k=g[k];for(k=e.length-1;0<=k;k-=1)i.splice(e[k],1);l+=1}for(h=0;h<l;h+=1){e=j[h];for(k=0;k<e.length;k+=1)if(g=e[k],f.call(a,g.from,g.to,g.context,h,l,g.direction))return l}}return l}}};
primitives.common.mergeSort=function(a,b,c){var d=null,f,e,g,h,i,j,k,l,m,n,p,r;switch(a.length){case 0:d=[];break;default:d=[];for(g=0;g<a.length;g+=1){f=a[g];e=[];j=d.length;k=f.length;i=h=0;p=m=n=l=null;0<j&&(l=d[h],n=!b?l:b(l));0<k&&(m=f[i],p=!b?m:b(m));for(r=null;h<j||i<k;)if(h>=j){if(!c||r!=m)e.push(m),r=m;i+=1;i<k&&(m=f[i],p=!b?m:b(m))}else if(i>=k){if(!c||r!=l)e.push(l),r=l;h+=1;h<j&&(l=d[h],n=!b?l:b(l))}else if(n<p){if(!c||r!=l)e.push(l),r=l;h+=1;h<j&&(l=d[h],n=!b?l:b(l))}else{if(!c||r!=m)e.push(m),
r=m;i+=1;i<k&&(m=f[i],p=!b?m:b(m))}d=e}}return d};
primitives.common.LinkedHashItems=function(){function a(a,b){if(f.hasOwnProperty(a))throw"Duplicate segments are not supported!";f[a]=b;e[a]=null;null==i?(h=a,g[a]=null):(e[i]=a,g[a]=i);i=a}function b(a,b){if(f.hasOwnProperty(a))throw"Duplicate segments are not supported!";f[a]=b;g[a]=null;null==h?(i=a,e[a]=null):(g[h]=a,e[a]=h);h=a}function c(a,b,c,d){var n;null==c&&(c=a?h:i);if(null!=b)for(;null!=c;){n=f[c];if(null!=n&&b(n,c))break;c=c==d?null:a?e[c]:g[c]}}function d(a,b,d){c(!0,a,b,d)}var f={},
e={},g={},h=null,i=null;return{add:a,item:function(a){return f[a]},nextKey:function(a){return e[a]},prevKey:function(a){return g[a]},startKey:function(){return h},endKey:function(){return i},unshift:b,insertAfter:function(c,d,h){if(f.hasOwnProperty(d))throw"Duplicate segments are not supported!";if(null==c)b(d,h);else{var i=e[c];null==i?a(d,h):(f[d]=h,e[c]=d,e[d]=i,g[i]=d,g[d]=c)}},remove:function(a){var b=g[a],c=e[a];null!=b?e[b]=c:h=c;null!=c?g[c]=b:i=b;delete f[a];delete e[a];delete g[a]},isEmpty:function(){return null==
h},attach:function(b){b.iterate(function(b,c){a(c,b)})},iterate:d,iterateBack:function(a,b,d){c(!1,a,b,d)},empty:function(){f={};e={};g={};i=h=null},toArray:function(){var a=[];d(function(b){a.push(b)});return a},validate:function(a){var b,c;for(b in f)if(f.hasOwnProperty(b)&&(!e.hasOwnProperty(b)||!g.hasOwnProperty(b)))return null!=a&&(a.message="Orphant key found!"),!1;if(!f.hasOwnProperty(h)||!f.hasOwnProperty(i))return null!=a&&(a.message="Start or end values are missing!"),!1;for(b in e)if(e.hasOwnProperty(b)){if(!f.hasOwnProperty(b)||
!g.hasOwnProperty(b))return null!=a&&(a.message="Orphant key found!"),!1;if((c=e[b])&&!e.hasOwnProperty(c))return null!=a&&(a.message="Next key not found!"),!1}for(b in g)if(g.hasOwnProperty(b)){if(!f.hasOwnProperty(b)||!e.hasOwnProperty(b))return null!=a&&(a.message="Orphant key found!"),!1;if((c=g[b])&&!g.hasOwnProperty(c))return null!=a&&(a.message="Prev key not found!"),!1}return!0}}};
primitives.common.LCA=function(a){var b=[],c=[],d={},f;(function(){var e=0;a.loopEulerWalk(this,function(a,f,i){b.push(a);c.push(i);d.hasOwnProperty(a)||(d[a]=e);e+=1});f=primitives.common.RMQ(c)})();return{getLowestCommonAncestor:function(a,c){var h=d[a],i=d[c],h=h<i?f.getRangeMinimumIndex(h,i):f.getRangeMinimumIndex(i,h);return b[h]}}};
primitives.common.tree=function(a){function b(a,b,c){var d,f,g;if(null!=e[b]&&(b=h[b],null!=b)){f=0;for(g=b.length;f<g&&!(d=b[f],c.call(a,d,e[d],f,g-1));f+=1);}}function c(a){var b=null;null!=g[a]&&(b=g[a]);return b}function d(a,b){var c,d=a.length;for(c=0;c<d;c+=1)if(a[c]==b)return a.splice(c,1),d-1;return d}function f(a,d,f){if(null!=f&&e.hasOwnProperty(d)){var g=c(d);null!=g&&f.call(a,g,e[g])||(b(a,g,function(b,c){b!=d&&f.call(a,b,c)}),b(a,d,function(b,c){f.call(a,b,c)}))}}var e={},g={},h={},i=
{},j={};primitives.common.isObject(a)&&(e=primitives.common.cloneObject(a.nodes,!0),g=primitives.common.cloneObject(a.parents,!0),h=primitives.common.cloneObject(a.children,!1),i=primitives.common.cloneObject(a.roots,!1),j=primitives.common.cloneObject(a.rootChildren,!0));return{loop:function(a,b){var c;if(null!=b)for(c in e)if(e.hasOwnProperty(c)&&b.call(a,c,e[c]))break},loopLevels:function(a,b,c){var d=0,f=[],g,i,s,u,t;switch(arguments.length){case 2:i=b;break;case 3:g=b,i=c}if(null!=i){if(null==
g)for(s in j)j.hasOwnProperty(s)&&(f=f.concat(j[s]));else null!=h[g]&&(f=f.concat(h[g]));for(;0<f.length;){s=[];u=0;for(t=f.length;u<t;u+=1)switch(g=f[u],i.call(a,g,e[g],d)){case 1:s=[];break;case 2:break;default:null!=h[g]&&(s=s.concat(h[g]))}f=s;d+=1}}},loopParents:function(a,b,c,d){if(null!=e[b]&&null!=c&&!(!0===d&&c.call(a,b,e[b])))for(;null!=(b=g[b])&&!c.call(a,b,e[b]););},loopChildren:b,loopChildrenRange:function(a,b,c,d,f){var g;if(null!=e[b]&&(b=h[b],null!=b))if(c<d){c=Math.max(c,0);d=Math.min(d,
b.length-1);for(g=c;g<=d&&!(c=b[g],f.call(a,c,e[c],g,NaN));g+=1);}else{c=Math.min(c,b.length-1);d=Math.max(0,d);for(g=c;g>=d&&!(c=b[g],f.call(a,c,e[c],g,NaN));g-=1);}},loopChildrenReversed:function(a,b,c){var d,f,g;if(null!=e[b]&&(b=h[b],g=b.length-1,null!=b))for(f=g;0<=f&&!(d=b[f],c.call(a,d,e[d],f,g));f-=1);},loopPostOrder:function(a,b){var c=[],d,f,i;if(null!=b){for(d in j)j.hasOwnProperty(d)&&(c=c.concat(j[d]));for(;0<c.length;)if(d=c[c.length-1],d!=f&&null!=(i=h[d]))for(d=i.length-1;0<=d;d-=
1)c.push(i[d]);else if(c.pop(),f=g[d],b.call(a,d,e[d],f,e[f]))break}},loopPreOrder:function(a,b){var c=[],d,f,i,q;if(null!=b){for(d in j)j.hasOwnProperty(d)&&(c=c.concat(j[d]));for(;0<c.length;){d=c[c.length-1];if(d!=i&&(f=g[d],b.call(a,d,e[d],f,e[f])))break;if(d!=i&&null!=(q=h[d]))for(d=q.length-1;0<=d;d-=1)c.push(q[d]);else c.pop(),i=g[d]}}},loopEulerWalk:function(a,b){var c=[],d,f=[],i=0,q,s,u;if(null!=b){for(d in j)if(j.hasOwnProperty(d)){u=j[d];q=0;for(i=u.length;q<i;q+=1)c.push(u[q]),f.push(0)}for(;0<
c.length;){q=c.length-1;d=c[q];i=f[q];if(b.call(a,d,e[d],i))break;if(d!=s&&null!=(u=h[d]))for(q=u.length-1;0<=q;q-=1)c.push(u[q]),f.push(i+1),0<q&&(c.push(d),f.push(i));else c.pop(),f.pop(),s=g[d]}}},loopNeighbours:function(a,b,c,d){var g={},h=[b],i,j=0;if(null!=d&&e.hasOwnProperty(b))for(g[b]=!0;0<h.length;){i=[];for(var b=0,u=h.length;b<u;b+=1){var t=h[b];if(0<j&&d.call(a,t,e[t],j))return;j<c&&f(this,t,function(a){g.hasOwnProperty(a)||(i.push(a),g[a]=!0)})}h=i;j+=1}},zipUp:function(a,b,c,d){var e,
f;if(null!=d)for(;null!=b&&null!=c&&b!=c;){e=g[b];f=g[c];if(d.call(a,b,e,c,f))break;b=e;c=f}},parentid:c,parent:function(a){var b=null;null!=g[a]&&(b=e[g[a]]);return b},adopt:function(a,b){if(null!=e[a]&&null!=e[b])if(a!=b)i.hasOwnProperty(b)&&(d(j[i[b]],b)||delete j[i[b]],delete i[b]),g.hasOwnProperty(b)&&(d(h[g[b]],b)||delete h[g[b]]),g[b]=a,null!=h[a]?h[a].push(b):h[a]=[b];else throw"Item cannot be parent of itself!";else throw"Both parent and child should be in hierarchy!";},moveChildren:function(a,
c){null!=e[a]&&(null!=e[c]&&a!=c)&&null!=h[a]&&(b(this,a,function(a){g[a]=c}),h[c]=null!=h[c]?h[c].concat(h[a]):h[a],delete h[a])},node:function(a){return e[a]},add:function(a,b,c,d){var f;if(null!=e[b])throw"Node already exists";if(null!=b&&(null!=c&&null==e[b])&&(null!=e[a]?(g[b]=a,null!=h[a]?null==d?h[a].push(b):h[a].splice(d,0,b):h[a]=[b]):(i[b]=a,null!=j[a]?null==d?j[a].push(b):j[a].splice(d,0,b):j[a]=[b]),e[b]=c,null!=j[b])){h[b]=j[b];delete j[b];d=h[b];a=0;for(c=d.length;a<c;a+=1)f=d[a],delete i[f],
g[f]=b}},insert:function(a,c,d){null!=e[a]&&(null!=c&&null==e[c]&&null!=d)&&(e[c]=d,null!=h[a]&&(h[c]=h[a]),h[a]=[c],b(this,c,function(a){g[a]=c}),g[c]=a)},hasNodes:function(){return!primitives.common.isEmptyObject(j)},hasChildren:function(a){return null!=h[a]},countChildren:function(a){return null!=h[a]?h[a].length:0},countSiblings:function(a){a=c(a);return null!=a?h[a].length:0},indexOf:function(a){var b=c(a);return null!=b?primitives.common.indexOf(h[b],a):null},getChild:function(a,b){var c=null,
d;if(null!=(d=h[a]))c=e[d[b]];return c},arrangeChildren:function(a,b){var c,d,f,b=b.slice(0);if(null!=e[a])if(null!=h[a])if(h[a].length==b.length){d=0;for(f=b.length;d<f;d+=1)if(c=b[d],g[c]!=a)throw"Child "+c+" does not belong to given node!";h[a]=b}else throw"Collections of children don't match each other!";else if(0<b.length)throw"Collections of children don't match each other!";},validate:function(){var a=!0,b;for(b in i)if(i.hasOwnProperty(b)&&null!=i[b]){a=!1;break}return a},clone:function(){return primitives.common.family({nodes:e,
parents:g,children:h,roots:i,rootChildren:j})},BREAK:1,SKIP:2}};
primitives.common.graph=function(){function a(a,b,c,e){var f=[],l,m,n,p;f.push(b);c[b]=!0;if(null!=e)for(;0<f.length;){b=[];m=0;for(n=f.length;m<n;m+=1)for(p in l=f[m],e.call(a,l),l=d[l],l)l.hasOwnProperty(p)&&!c.hasOwnProperty(p)&&(c[p]=!0,b.push(p));f=b}}function b(a,b){var c=null,e,f,l,m=0,n=null;for(e in d)if(d.hasOwnProperty(e)){f=d[e];m=0;for(l in f)f.hasOwnProperty(l)&&(m+=b.call(a,f[l],e,l));if(m>n||null==n)c=e,n=m}return c}function c(a,c,i,j,k){var l={},m,n=[],p={},r=0,q,s,u,t,y,v;if(null!=
i&&null!=j&&(null==c&&(c=b(a,i)),null!=c)){j.call(a,c);l[c]=!0;r+=1;for(p[c]=null;0<r;){n=[];s=q=null;u={};for(m in l)if(l.hasOwnProperty(m)){t=d[m];c=!1;for(y in t)if(t.hasOwnProperty(y)&&!p.hasOwnProperty(y))switch(v=i.call(a,t[y],m,y),c=!0,k){case f:null==u[y]&&(u[y]=0);u[y]+=v;if(!s||u[y]>s)q=y,s=u[y];break;case e:if(u[y]=null==u[y]?v:Math.min(u[y],v),!s||u[y]<s)q=y,s=u[y]}c||n.push(m)}if(null==q)break;else l[q]=!0,r+=1,p[q]=!0,j.call(a,q);c=0;for(q=n.length;c<q;c+=1)delete l[n[c]],r-=1}}}var d=
{},f=1,e=2;return{addEdge:function(a,b,c){if((null==d[a]||null==d[a][b])&&null!=c)null==d[a]&&(d[a]={}),d[a][b]=c,null==d[b]&&(d[b]={}),d[b][a]=c},edge:function(a,b){var c=null;null!=d[a]&&d[a][b]&&(c=d[a][b]);return c},hasNode:function(a){return d.hasOwnProperty(a)},loopNodes:function(b,c,e){b={};if(null==c)for(c in d)d.hasOwnProperty(c)&&(b.hasOwnProperty[c]||a(this,c,b,e));else a(this,c,b,e)},loopNodeEdges:function(a,b,c){var e;if(null!=c&&(b=d[b],null!=b))for(e in b)b.hasOwnProperty(e)&&c.call(a,
e,b[e])},getSpanningTree:function(a,b){var c=primitives.common.tree(),e=primitives.common.FibonacciHeap(!0),f,l={},m,n,p,r;e.add(a,0,null);for(l[a]=null;null!=(f=e.extractRoot());){m=d[f.key];for(n in m)m.hasOwnProperty(n)&&!c.node(n)&&(p=null!=b?b(m[n]):m[n],r=e.getPriority(n),null==r?(e.add(n,p,null),l[n]=f.key.toString()):r<=p&&(e.setPriority(n,p),l[n]=f.key.toString()));c.add(l[f.key],f.key.toString(),{})}return c},getTotalWeightGrowthSequence:function(a,d,e){var j=b(a,d);c(a,j,d,e,f)},getMinimumWeightGrowthSequence:function(a,
b,d,f){c(a,b,d,f,e)},getShortestPath:function(a,b,c,e,f){var l=primitives.common.FibonacciHeap(!1),m={},n={},p,r,q={},s=0,u=0,m=0;for(r=c.length;m<r;m+=1)p=c[m],q.hasOwnProperty(p)||(s+=1,q[p]=!0);l.add(b,0,null);for(n[b]=null;null!=(b=l.extractRoot());){c=d[b.key];for(p in c)c.hasOwnProperty(p)&&(r=b.priority+(null!=e?e.call(a,c[p],b,p):1),m=l.getPriority(p),null!=m?m>r&&(l.setPriority(p,r),n[p]=b.key):n.hasOwnProperty(p)||(l.add(p,r,null),n[p]=b.key));if(q.hasOwnProperty(b.key)){m=[];for(c=b.key;null!=
c;)m.push(c),c=n[c];f.call(a,m,b.key);u+=1;if(u>=s)break}}}}};
primitives.common.getMergedRectangles=function(a,b,c){function d(a,b){this.start=a;this.startHead=null;this.end=b;this.endHead=null;this.overlap=function(a){return!(this.end<a.start||this.start>a.end)}}function f(a,b){this.x=a;this.ranges=b}function e(a,b){this.isHead=a;this.list=b;A.hasOwnProperty(b)||(A[b]=[]);A[b].push(this);this.add=function(a){a.from.equalTo(a.to)||(this.isHead?v[this.list].add(w,a):v[this.list].unshift(w,a),w+=1)};this.getTail=function(){return new e(!this.isHead,this.list)};
this.attach=function(a){if(this.list!=a.list){v[this.list].attach(v[a.list]);var b=A[a.list];delete A[a.list];if(null!=b)for(var c=0,d=b.length;c<d;c+=1){var e=b[c];e!=a&&(e.list=this.list,A[this.list].push(e))}}}}function g(a){v.push(new primitives.common.LinkedHashItems);return new e(a,v.length-1)}var h,i,j,k,l;b.sort(function(a,b){return a.x==b.x?a.y-b.y:a.x-b.x});var m=[],n={};h=0;for(i=b.length;h<i;h+=1){j=b[h];k=[j.x,j.right()];for(var p=0;p<k.length;p+=1){var r=k[p];l=n[r];null==l&&(l={x:r,
add:[],remove:[]},n[r]=l,m.push(l));r==j.x?l.add.push(h):l.remove.push(h)}}m.sort(function(a,b){return a.x-b.x});p={};n=[];n.push(new f(null,[]));h=0;for(i=m.length;h<i;h+=1){l=m[h];j=0;for(k=l.add.length;j<k;j+=1)p[l.add[j]]=!0;j=0;for(k=l.remove.length;j<k;j+=1)delete p[l.remove[j]];var r=[],q;for(q in p)p.hasOwnProperty(q)&&r.push(b[q]);r.sort(function(a,b){return a.y-b.y});var s=[],u=null,t=null;j=0;for(k=r.length;j<k;j+=1){var y=r[j];null==u?(u=y.y,t=y.bottom()):t<y.y?(s.push(new d(u,t)),u=y.y,
t=y.bottom()):t=Math.max(t,y.bottom())}null!=u&&s.push(new d(u,t));n.push(new f(l.x,s))}var v=[],A={},w=1;h=1;for(i=n.length;h<i;h+=1){b=n[h-1];l=n[h];for(j=q=0;q<b.ranges.length||j<l.ranges.length;)if(k=q<b.ranges.length?b.ranges[q]:null,p=j<l.ranges.length?l.ranges[j]:null,null==p){m=[new primitives.common.Point(b.x,k.end),new primitives.common.Point(l.x,k.end),new primitives.common.Point(l.x,k.start),new primitives.common.Point(b.x,k.start)];for(s=1;s<m.length;s+=1)k.endHead.add(new primitives.common.Vector(m[s-
1],m[s]));k.endHead.attach(k.startHead);q+=1}else if(null==k)p.endHead=g(!0),p.endHead.add(new primitives.common.Vector(new primitives.common.Point(l.x,p.start),new primitives.common.Point(l.x,p.end))),p.startHead=p.endHead.getTail(),j+=1;else if(p.overlap(k)){m=[new primitives.common.Point(b.x,k.start),new primitives.common.Point(l.x,k.start),new primitives.common.Point(l.x,p.start)];for(s=1;s<m.length;s+=1)k.startHead.add(new primitives.common.Vector(m[s],m[s-1]));p.startHead=k.startHead;for(s=
!0;s;)if(s=!1,k.end>p.end)r=j+1<l.ranges.length?l.ranges[j+1]:null,null!=r&&r.overlap(k)&&(s=new primitives.common.Point(l.x,r.start),u=new primitives.common.Point(l.x,p.end),p.endHead=g(!0),p.endHead.add(new primitives.common.Vector(s,u)),r.startHead=p.endHead.getTail(),j+=1,p=r,s=!0);else if(r=q+1<b.ranges.length?b.ranges[q+1]:null,null!=r&&r.overlap(p)){m=[new primitives.common.Point(b.x,k.end),new primitives.common.Point(l.x,k.end),new primitives.common.Point(l.x,r.start),new primitives.common.Point(b.x,
r.start)];for(s=1;s<m.length;s+=1)k.endHead.add(new primitives.common.Vector(m[s-1],m[s]));k.endHead.attach(r.startHead);q+=1;k=r;s=!0}m=[new primitives.common.Point(b.x,k.end),new primitives.common.Point(l.x,k.end),new primitives.common.Point(l.x,p.end)];for(s=1;s<m.length;s+=1)k.endHead.add(new primitives.common.Vector(m[s-1],m[s]));p.endHead=k.endHead;q+=1;j+=1}else if(k.start<p.start){m=[new primitives.common.Point(b.x,k.end),new primitives.common.Point(l.x,k.end),new primitives.common.Point(l.x,
k.start),new primitives.common.Point(b.x,k.start)];for(s=1;s<m.length;s+=1)k.endHead.add(new primitives.common.Vector(m[s-1],m[s]));k.endHead.attach(k.startHead);q+=1}else p.endHead=g(!0),p.endHead.add(new primitives.common.Vector(new primitives.common.Point(l.x,p.start),new primitives.common.Point(l.x,p.end))),p.startHead=p.endHead.getTail(),j+=1}if(null!=c)for(h=0;h<v.length;h+=1)A.hasOwnProperty(h)&&(i=v[h],m=[],i.iterate(function(a){0==m.length&&m.push(a.from);m.push(a.to)}),c.call(a,m))};
primitives.common.getLiniarBreaks=function(a){function b(b,c){var e=0,f=(d[c]-d[b]+a[b])/(c-b+1),g=primitives.common.binarySearch(a,function(a){return f-a},b,c);g.item<=f?(e+=f*(g.index+1-b)-(d[g.index]-d[b]+a[b]),e+=d[c]-d[g.index]-f*(c-g.index)):(e+=f*(g.index-b)-(d[g.index]-d[b]-a[g.index]+a[b]),e+=d[c]-d[g.index]+a[g.index]-f*(c-g.index+1));return e}function c(a,c){var d;d=0+b(0,a);c>a+1&&(d+=b(a+1,c-1));return d+=b(c,f-1)}for(var d=[],f=a.length,e=0,g=0;g<f;g+=1)e+=a[g],d[g]=e;for(var e=0,g=
f-1,h=c(e,g);e<g+1;){var i=c(e+1,g),j=c(e,g-1);if(i<j){if(i>=h)break;e+=1;h=i}else{if(j>=h)break;g-=1;h=j}}return[e,g-1,f-1]};
primitives.common.getFamilyUnits=function(a){function b(){this.toIndex=this.fromIndex=0;this.items=[];this.hash={}}function c(a){this.id=a;this.parents=new b;this.children=new b;this.loopSiblings=function(a,b,c){this._loop(a,this.parents.hash.hasOwnProperty(b)?this.parents.items:this.children.items,c)};this.loopNonSiblings=function(a,b,c){this._loop(a,!this.parents.hash.hasOwnProperty(b)?this.parents.items:this.children.items,c)};this.loop=function(a,b){this._loop(a,this.parents.items,b);this._loop(a,
this.children.items,b)};this._loop=function(a,b,c){if(null!=c)for(var d=0,e=b.length;d<e;d+=1)c.call(a,b[d])};this.addParent=function(a){this._add(a,this.parents)};this.addChild=function(a){this._add(a,this.children)};this._add=function(a,b){b.hash.hasOwnProperty(a)||(b.items.push(a),b.hash[a]=!0)}}var d=[],f={},e,g;e=0;a.loop(this,function(b){var g=a.countChildren(b);if(0<g&&!f.hasOwnProperty(b)){var h=new c(e);e+=1;h.addParent(b);a.loopChildren(this,b,function(b){h.addChild(b);1==g&&a.loopParents(this,
b,function(b){h.addParent(b);f[b]=h;return a.SKIP});return a.SKIP});d.push(h);f[b]=h}});var h={};e=0;for(g=d.length;e<g;e+=1){var i=d[e];i.loop(this,function(a){h.hasOwnProperty(a)?h[a].push(i):h[a]=[i]})}return h};
primitives.common.getCrossingRectangles=function(a,b,c){function d(a,b,c,d){this.isStart=a;this.index=b;this.x=c;this.rect=d}function f(){this.count=0;this.rectangles={};this.add=function(a){this.count+=1;this.rectangles[a]=!0};this.remove=function(a){this.count-=1;delete this.rectangles[a];return 0==this.count}}function e(d,e,f,g,h){d.loopForward(this,e,function(d,e){if(d>f)return!0;for(var i in e.rectangles)if(e.rectangles.hasOwnProperty(i)){var j=g>i?g+"-"+i:i+"-"+g;k.hasOwnProperty(j)||(k[j]=
!0,c.call(a,h,b[i]))}})}if(null!=c){for(var g=[],h=0;h<b.length;h+=1){var i=b[h];g.push(new d(1,h,i.x,i));g.push(new d(0,h,i.right(),i))}g.sort(function(a,b){return a.x==b.x?b.isStart-a.isStart:a.x-b.x});for(var i=primitives.common.SortedList(),j={},k={},h=0;h<g.length;h+=1){var l=g[h],m=[l.rect.y,l.rect.bottom()];if(1==l.isStart){e(i,m[0],m[1],l.index,l.rect);for(var n=0,p=m.length;n<p;n+=1){var r=m[n],q=j[r];null==q&&(q=new f,j[r]=q,i.add(r,q));q.add(l.index)}}else{n=0;for(p=m.length;n<p;n+=1)r=
m[n],q=j[r],q.remove(l.index)&&(delete j[r],i.remove(r));e(i,m[0],m[1],l.index,l.rect)}}}};
primitives.common.FibonacciHeap=function(a){function b(a){this.key=a.key;this.priority=a.priority;this.item=a.item}function c(a,b,c){this.key=a;this.priority=b;this.item=c;this.degree=0;this.marked=!1;this.right=this.left=this.child=this.parent=null}function d(a,b){var c=n[a.right];b.right=a.right;b.left=a.key;a.right=b.key;c.left=b.key}function f(a){var b=n[a.left],c=n[a.right];b.right=c.key;c.left=b.key;a.right=a.key;a.left=a.key}function e(){var a=null;null!=m&&(a=new b(n[m]));return a}function g(){var a=
e();if(null!=a){var b=n[m],c=n[b.right];if(null!=b.child){var d=n[b.child],g=n[d.left];b.right=d.key;c.left=g.key;d.left=b.key;g.right=c.key;f(b);delete n[b.key];m=null;h(d.key)}else f(b),delete n[b.key],m=null,c.key!=b.key&&h(c.key)}return a}function h(b){var c=[],d,e={};for(d=b;!e.hasOwnProperty(d);){var b=n[d],f=b.right;e[d]=!0;for(b.parent=null;null!=(d=c[b.degree]);)(a?b.priority>d.priority:b.priority<d.priority)?i(b,d):(i(d,b),b=d),c[b.degree-1]=null;c[b.degree]=b;if(null==m||null==n[m]||(a?
n[m].priority<=b.priority:n[m].priority>=b.priority))m=b.key;d=f}}function i(b,c){b.degree+=1;f(c);var e=n[b.child];if(null!=e){if(d(e,c),a?e.priority<c.priority:e.priority>c.priority)b.child=c.key}else b.child=c.key;c.parent=b.key}function j(b,c){var d=n[b];if(a?d.priority>c:d.priority<c)throw"Priority increase is not supported";d.priority=c;if(null!=d.parent){var e=n[d.parent];if(a?e.priority<d.priority:e.priority>d.priority)k(e,d),l(e)}if(a?n[m].priority<d.priority:n[m].priority>d.priority)m=d.key}
function k(a,b){b.marked=!1;b.parent=null;b.right==b.key?a.child=null:(a.child=b.right,f(b));a.degree-=1;d(n[m],b)}function l(a){if(null!=a.parent)if(a.marked){var b=n[a.parent];k(b,a);l(b)}else a.marked=!0}var m=null,n={};return{add:function(b,e,f){if(n.hasOwnProperty(b))throw"Duplicate keys are not supported!";e=new c(b,e,f);n[b]=e;if(null==m)e.left=b,m=e.right=b;else if(f=n[m],d(f,e),a?f.priority<e.priority:f.priority>e.priority)m=b},getPriority:function(a){var b=null;n.hasOwnProperty(a)&&(b=n[a].priority);
return b},setPriority:j,heapRoot:e,extractRoot:g,deleteKey:function(b){j(b,a?Infinity:-1);g()},validate:function(){var a=0,b;for(b in n)if(n.hasOwnProperty(b)){var c=n[b],a=a+1;if(null!=c.child){if(!n.hasOwnProperty(c.child))throw"Child does not exists";var d=n[c.child];if(d.parent!=c.key)throw"Child references wrong parent";}if(null!=c.parent&&!n.hasOwnProperty(c.parent))throw"Parent does not exists";if(null!=c.left){if(!n.hasOwnProperty(c.left))throw"Left does not exists";d=n[c.left];if(d.right!=
c.key)throw"Left references wrong right";}if(null!=c.right){if(!n.hasOwnProperty(c.right))throw"Right does not exists";d=n[c.right];if(d.left!=c.key)throw"Right references wrong left";}}if(null==m&&0<a)throw"Orphans";if(null!=m){if(!n.hasOwnProperty(m))throw"Root node does not exists";c=n[m];if(null!=c.parent)throw"Root node has parent reference";b=[m];c={};for(d=0;0<b.length;){for(var e=[],f=0,g=b.length;f<g;f+=1)for(var h=n[b[f]];!c.hasOwnProperty(h.key);)c[h.key]=!0,d+=1,null!=h.child&&e.push(h.child),
h=n[h.right];b=e}if(a!=d)throw"Tree has loops or orpants";}}}};
primitives.common.FamilyMargins=function(){function a(a,c,d,f){this.left=a;this.right=c;this.leftIndex=d;this.rightIndex=f}this.items=[];this.add=function(b,c,d,f){switch(arguments.length){case 2:this.items.push(new a(-b/2,b/2,c,c));break;case 4:this.items.push(new a(b,c,d,f))}};this.merge=function(b,c){for(var d=this.getDistanceTo(b),f=0,e=0,g=this.items.length,h=b.items.length,i=Math.min(g,h),j=Math.max(g,h),k=0;k<i;k+=1){var l=this.items[g-1-k],m=b.items[h-1-k];0===k&&(e=l.right-l.left+(d||0)+
(c||0)+m.right-m.left,f=e/2+l.left,e=e/2-m.right);l.left-=f;l.right=m.right+e;l.rightIndex=m.rightIndex;this.items[j-1-k]=l}for(k=i;k<j;k+=1)l=this.items[g-1-k],m=b.items[h-1-k],null==l?this.items[j-1-k]=new a(m.left+e,m.right+e,m.leftIndex,m.rightIndex):(l.left-=f,l.right-=f);return d};this.attach=function(b,c){for(var d=this.getDistanceTo(b),f=c||0,e=this.items.length,g=b.items.length,h=Math.min(e,g),i=Math.max(e,g),j=0;j<h;j+=1){var k=this.items[e-1-j],l=b.items[g-1-j];0===j&&(f=k.right+(d||0)+
(c||0)-l.left);k.right=l.right+f;k.rightIndex=l.rightIndex;this.items[i-1-j]=k}for(j=h;j<i;j+=1)k=this.items[e-1-j],null==k&&(l=b.items[g-1-j],this.items[i-1-j]=new a(l.left+f,l.right+f,l.leftIndex,l.rightIndex));return d};this.getDistanceTo=function(a){var c=null,d=0,f=this.items.length,e=a.items.length,g=Math.min(f,e);if(0<g){for(var h=0;h<g;h+=1){var i=this.items[f-1-h],j=a.items[e-1-h];0===h?c=d=i.right-j.left:i.rightIndex<j.leftIndex&&(c=Math.max(c,i.right-j.left))}c-=d}return c};this.loop=function(a,
c){if(null!=c)for(var d=0,f=this.items.length;d<f;d+=1){var e=this.items[f-1-d];if(c.call(a,d,e.left,e.right,e.leftIndex,e.rightIndex))break}};this.getLeft=function(a){var c=this.items.length-1;if(c>=a)return this.items[c-a].left}};
primitives.common.FamilyAlignment=function(a,b,c,d){function f(a,b){var c=a[b];null==c&&(c=new primitives.common.FamilyMargins,a[b]=c);return c}function e(a,b,c,d,e,f,g,i){var s=f,u=f;c.loopSiblings(this,b,function(a){a=g.getItemPosition(a);s=Math.min(s,a);u=Math.max(u,a)});for(var t=f-1;t>=s;t-=1){var y=g.getItemAtPosition(d,t);if(!a.hasOwnProperty(y)){var v=g.getItemAtPosition(d,t+1);a[y]=a[v]-(h[y]/2+(i[v]||0)+h[v]/2)}}for(t=f+1;t<=u;t+=1)y=g.getItemAtPosition(d,t),a.hasOwnProperty(y)||(v=g.getItemAtPosition(d,
t-1),a[y]=a[v]+(h[v]/2+(i[y]||0)+h[y]/2));y=g.getItemAtPosition(d,s);v=a[y]-h[y]/2;y=g.getItemAtPosition(d,u);v+=a[y]+h[y]/2;v/=2;u=s=null;c.loopNonSiblings(this,b,function(a){a=g.getItemPosition(a);s=null!=s?Math.min(s,a):a;u=null!=u?Math.max(u,a):a});c=0;for(t=s;t<=u;t+=1)b=g.getItemAtPosition(e,t),c+=h[b],t>s&&(c+=i[b]||0);t=v-c/2;b=g.getItemAtPosition(e,s);a.hasOwnProperty(b)||(a[b]=t+h[b]/2);for(t=s+1;t<=u;t+=1)b=g.getItemAtPosition(e,t),a.hasOwnProperty(b)||(v=g.getItemAtPosition(e,t-1),a[b]=
a[v]+(h[v]/2+(i[b]||0)+h[b]/2))}var g,h={},i;null!=d&&c.loopItems(this,function(b,c){h[b]=d.call(a,b,c)});i=function(a,b){var c={},d={},e=null;b.loopLevelsReversed(this,function(g){var i=new primitives.common.FamilyMargins;null!=e&&(e.add(0,Number.MAX_VALUE),i.merge(e,0));var q=e=i;b.loopLevelItems(this,g,function(e,g,i){var n=f(d,e);n.add(h[e],i);switch(a.countParents(e)){case 0:null!=q&&(c[e]=q.attach(n));break;case 1:a.loopParents(this,e,function(b){b=f(d,b);c[e]=b.merge(n);q=b;return a.BREAK});
break;default:var p=0,r=null,w=null,x={};a.loopParents(this,e,function(c,d,e){if(0<e)return a.BREAK;p+=h[c];d=b.getItemPosition(c);r=null==r?d:Math.min(r,d);w=null==w?d:Math.max(w,d);x[d]=c});g=-p/2;for(i=r;i<=w;i+=1){var z=x[i],g=g+h[z]/2,E=f(d,z);E.attach(n,-g);q=E;g+=h[z]/2}}})});return c}(b,c);g=function(a,b,c){var d={},f=primitives.common.getFamilyUnits(a),g={};b.loopLevels(this,function(a){b.loopLevelItems(this,a,function(i,j,u){if(!d.hasOwnProperty(i)){j=0;if(0===u)null!=c[i]&&(j+=c[i]+h[i]/
2);else var t=b.getItemAtPosition(a,u-1),j=j+(d[t]+h[t]/2+(c[i]||0)+h[i]/2);d[i]=j}j=f[i];if(null!=j)for(t=0;t<j.length;t+=1){var y=j[t];g.hasOwnProperty(y.id)||(g[y.id]=!0,e(d,i,y,a,a+1,u,b,c))}})});return d}(b,c,i);return{getOffset:function(a){return g[a]}}};
primitives.common.family=function(a){function b(a,b,c,d){var e;if(null!=d&&(b=b[c],null!=b))for(e in b)if(b.hasOwnProperty(e)&&d.call(a,e,b[e]))break}function c(a,b){var c=!1;null!=z[a]&&null!=z[a][b]&&(delete z[a][b],E[a]-=1,delete D[b][a],B[b]-=1,E[a]||(delete z[a],delete E[a]),D[b]||(delete D[b],delete B[b],null==w[null]&&(w[null]={},x[null]=0),w[null][b]=!0,x[null]+=1),c=!0);return c}function d(a,b){var c;if(null!=b)for(c in C)if(C.hasOwnProperty(c)&&b.call(a,c,C[c]))break}function f(a,c,d,e){for(var f,
g,h={},i=0,j=!0;j;){f={};j=!1;for(g in d)if(d.hasOwnProperty(g)&&!h[g])switch(h[g]=!0,e.call(a,g,C[g],i)){case 1:f={};j=!1;break;case 2:break;default:b(this,c,g,function(a){h[a]||(j=f[a]=!0)})}d=f;i+=1}}function e(a,b,c){null!=c&&null!=b&&(null!=C[b]&&null!=z[b])&&f(a,z,z[b],c)}function g(a,b,c){null!=c&&null!=b&&(null!=C[b]&&null!=D[b])&&f(a,D,D[b],c)}function h(a,c,d,e,f,g){var h,i,j,k;if(null!=g){c=[];i={};for(h in C)C.hasOwnProperty(h)&&(i[h]=d[h]||0,i[h]||c.push(h));for(k=0;0<c.length;){j=[];
d=0;for(f=c.length;d<f;d+=1){h=c[d];if(g.call(a,h,C[h],k)){j=[];break}k+=1;b(this,e,h,function(a){i[a]-=1;0===i[a]&&j.push(a)})}c=j}}}function i(a,b){h(a,D,B,z,E,b)}function j(a,b){h(a,z,E,D,B,b)}function k(a,b,c,d,e,f,g,h,i){var j=!1,k,l;if(null!=C[a]&&null!=g[a]){j=!0;if(i){i=0;for(k=b.length;i<k;i+=1)if(l=b[i],null==C[l]||null==g[a][l])j=!1}if(j&&(null!=d&&(C[c]=d),null!=C[c])){e[c]||(e[c]={},f[c]=0);g[c]||(g[c]={},h[c]=0);e[c][a]||(e[c][a]=!0,f[c]+=1);g[a][c]||(g[a][c]=!0,h[a]+=1);i=0;for(k=b.length;i<
k;i+=1)l=b[i],c!=l&&(null!=g[a][l]&&(delete g[a][l],h[a]-=1),null!=e[l][a]&&(delete e[l][a],f[l]-=1),e[l][c]||(e[l][c]=!0,f[l]+=1),g[c][l]||(g[c][l]=!0,h[c]+=1))}}return j}function l(a,b,c,d){return k(a,b,c,d,D,B,z,E,!0)}function m(){this.key=this.id="";this.children=[];this.childrenHash={};this.processed=!1}function n(a){this.items=[];this.difference=this.weight=0;0<arguments.length&&(this.difference=a)}function p(a){var c=primitives.common.graph(),d,e,f,g,h,i,j,k,l={};for(d in a)a.hasOwnProperty(d)&&
b(this,z,d,function(d){if(!l.hasOwnProperty(d)){l[d]=!0;e=[];b(this,D,d,function(a){e.push(a)});f=0;for(h=e.length;f<h-1;f+=1)if(i=e[f],a.hasOwnProperty(i))for(g=f+1;g<h;g+=1)if(j=e[g],a.hasOwnProperty(j)){k=Math.abs(a[i].children.length-a[j].children.length);var m=c.edge(i,j);null==m&&(m=new n(k),c.addEdge(i,j,m));m.items.push(d);m.weight+=1}}});return c}function r(a,b){this.parentid=a;this.childid=b;this.key=a+","+b}function q(a,b){this.from=a;this.to=b;this.distance=0}function s(a){return E[a]||
0}function u(a){return B[a]||0}function t(a){var b=null,a=z[a]||{};for(b in a)if(a.hasOwnProperty(b))return b;return null}function y(a){var b=null,a=D[a]||{};for(b in a)if(a.hasOwnProperty(b))return b;return null}function v(a,b){this.parentid=a;this.childid=b;this.ids=[];this.nodes=[]}function A(){return primitives.common.family({roots:w,rootsCount:x,children:z,childrenCount:E,parents:D,parentsCount:B,nodes:C})}var w={},x={},z={},E={},D={},B={},C={};primitives.common.isObject(a)&&(w=primitives.common.cloneObject(a.roots,
!1),x=primitives.common.cloneObject(a.rootsCount,!0),z=primitives.common.cloneObject(a.children,!1),E=primitives.common.cloneObject(a.childrenCount,!0),D=primitives.common.cloneObject(a.parents,!1),B=primitives.common.cloneObject(a.parentsCount,!0),C=primitives.common.cloneObject(a.nodes,!0));return{add:function(a,c,d){var e,f,g={};if(!a||0===a.length)a=[null];if(null==C[c]&&null!=d){C[c]=d;d=0;for(e=a.length;d<e;d+=1)f=a[d],null==g[f]&&f!=c&&(g[f]=!0,null!=C[f]?(null==D[c]&&(D[c]={},B[c]=0),D[c][f]||
(D[c][f]=!0,B[c]+=1),null==z[f]&&(z[f]={},E[f]=0),z[f][c]||(z[f][c]=!0,E[f]+=1)):(null==w[f]&&(w[f]={},x[f]=0),w[f][c]||(w[f][c]=!0,x[f]+=1)));null!=w[c]&&(z[c]=w[c],E[c]=x[c],delete w[c],delete x[c],b(this,z,c,function(a){null==D[a]&&(D[a]={},B[a]=0);D[a][c]||(D[a][c]=!0,B[a]+=1)}))}},adopt:function(a,b){var c,d,e;if(null!=C[b]){c=0;for(d=a.length;c<d;c+=1)if(e=a[c],null==D[b]&&(D[b]={},B[b]=0),e!=b&&null!=C[e])D[b][e]||(D[b][e]=!0,B[b]+=1),null==z[e]&&(z[e]={},E[e]=0),z[e][b]||(z[e][b]=!0,E[e]+=
1);else throw"Item cannot be parent of itself and parent should exist in the structure!";}else throw"Child should be in hierarchy!";},bundleChildren:l,bundleParents:function(a,b,c,d){return k(a,b,c,d,z,E,D,B,!0)},optimizeReferences:function(a){var c={},d={},f={},g,h,i,j,l,n;l=0;var q=10,r;if(null!=a){for(g in C)l+=1,C.hasOwnProperty(g)&&(h=new m,b(this,z,g,function(a){h.children.push(a);h.childrenHash[a]=!0}),h.children.sort(),h.id=g,h.key=h.children.join(","),f[h.id]=h);for(q=Math.pow(10,l.toString().length);!primitives.common.isEmptyObject(f);){i=
{};r={};j=p(f);for(g in f)f.hasOwnProperty(g)&&(l=f[g],l.processed||(n=j.getSpanningTree(g,function(a){return a.weight*q+q-a.difference}),n.loopLevels(this,function(b,g){f[b].processed=!0;n.loopChildren(this,b,function(h,l){var n=j.edge(b,h),p=null,q,s,t,u,v,w;f[h].processed=!0;if(1<n.weight){s=n.items.join(",");if(c.hasOwnProperty(s))p=c[s];else{q=a();C[q.id]=q;p=new m;p.id=q.id;p.key=s;s=0;for(t=n.items.length;s<t;s+=1)w=n.items[s],p.children.push(w),p.childrenHash[w]=!0,r[w]=!0;p.children.sort();
c[p.key]=p;d[p.id]=p;i[p.id]=p;r[p.id]=p;u=p.children.slice(0);e(this,g.replacementItem||b,function(a){!p.childrenHash[a]&&null!=d[a]&&(v=!0,e(this,a,function(a){if(!p.childrenHash[a])return v=!1,1;if(!r.hasOwnProperty(a))return 2}),v&&u.push(a));return 2});k(g.replacementItem||b,u,p.id,q,D,B,z,E,!1);if(1>=(E[b]||0)&&null==g.replacementItem)g.replacementItem=p.id}if(p.id!=h&&(u=p.children.slice(0),e(this,l.replacementItem||h,function(a){null!=d[a]&&!p.childrenHash[a]&&(v=!0,e(this,a,function(a){return!p.childrenHash[a]?
(v=!1,1):(r.hasOwnProperty(a),2)}),v&&u.push(a));return 2}),k(l.replacementItem||h,u,p.id,null,D,B,z,E,!1),1>=(E[h]||0)&&null==l.replacementItem))l.replacementItem=p.id}})})));f=i}}},eliminateManyToMany:function(a){var c,d;for(c in z)z.hasOwnProperty(c)&&1<(E[c]||0)&&b(this,z,c,function(b){if(1<(B[b]||0))d=a(),l(c,[b],d.id,d)})},groupBy:function(a,b,c){if(null!=c){var d={},e;for(e in C){var f=E[e]||0;if(1>=(B[e]||0)&&1>=f){var f=y(e),g=t(e),h=f+" * "+g;d.hasOwnProperty(h)||(d[h]=new v(f,g));d[h].ids.push(e);
d[h].nodes.push(C[e])}}for(h in d)if(d.hasOwnProperty(h)&&(e=d[h],e.ids.length>=b&&c.call(a,e.parentid,e.childid,e.ids,e.nodes)))break}},getPlanarFamily:function(a){var b=new primitives.common.family,c,d;a.loopLevels(this,function(f){var g=new primitives.common.LinkedHashItems,h={},i={},j=[];a.loopLevelItems(this,f,function(b){e(this,b,function(c){var d=a.getItemPosition(c),e=new r(b,c);i[e.key]=e;var f=[];g.isEmpty()?g.add(d,[e]):(g.iterateBack(function(a,c){if(c<d)return g.insertAfter(c,d,[e]),
!0;if(c==d)return a.push(e),!0;for(var h=0,i=a.length;h<i;h+=1){var j=a[h];j.parentid!=b&&f.push(j)}}),g.startKey()>d&&g.unshift(d,[e]));h[e.key]=f;for(var c=0,j=f.length;c<j;c+=1)h[f[c].key].push(e);return 2});if(1==s(b)){var c=t(b);1==u(c)&&(c=new r(b,c),j.push(c.key))}});var f=[],k,l;for(l in h){k=h[l];var m=k.length;null!=f[m]?f[m].push(l):f[m]=[l]}m={};f.unshift(j);for(var n=0,p=f.length;n<p;n+=1){var q=f[n];if(null!=q){c=0;for(d=q.length;c<d;c+=1)if(l=q[c],!m.hasOwnProperty(l)){m[l]=!0;k=i[l];
null==b.node(k.parentid)&&b.add(null,k.parentid,{});null==b.node(k.childid)?b.add([k.parentid],k.childid,{}):b.adopt([k.parentid],k.childid);k=h[l];l=0;for(var v=k.length;l<v;l+=1)m[k[l].key]=!0}}}});return b},getFamilyWithoutGrandParentsRelations:function(){var a=new primitives.common.family,c={},e=[],f=0,g;for(g in D)D.hasOwnProperty(g)&&b(this,D,g,function(a){var b=c[g];null==b&&(b={},c[g]=b);b.hasOwnProperty(a)||(b=new q(g,a,f),e.push(b),c[g][a]=b)});for(;0<e.length;){for(var h=[],f=f+1,i=0,j=
e.length;i<j;i+=1){var k=e[i];g=k.to;D.hasOwnProperty(g)&&b(this,D,g,function(a){var b=c[k.from];null==b&&(b={},c[k.from]=b);if(b.hasOwnProperty(a))b[a].distance=f;else{var d=new q(g,a,f);h.push(d);b[a]=d}})}e=h}d(this,function(d,e){var f=[];b(this,D,d,function(a){0===c[d][a].distance&&f.push(a)});a.add(f,d,e)});return a},getGraph:function(){var a=primitives.common.graph(),c;for(c in z)z.hasOwnProperty(c)&&b(this,z,c,function(b){var d=a.edge(c,b);null==d&&(d=new n({}),a.addEdge(c,b,d))});return a},
removeNode:function(a){null!=C[a]&&(b(this,z,a,function(b){delete D[b][a];B[b]-=1;B[b]||(delete D[b],delete B[b],null==w[null]&&(w[null]={},x[null]=0),w[null][b]||(w[null][b]=!0,x[null]+=1))}),b(this,D,a,function(b){delete z[b][a];E[b]-=1;E[b]||(delete z[b],delete E[b])}),null!=w[null]&&null!=w[null][a]&&(delete w[null][a],x[null]-=1,x[null]||(delete w[null],delete x[null])),delete z[a],delete E[a],delete D[a],delete B[a],delete C[a])},removeRelation:function(a,b){var d=!1;null!=C[a]&&null!=C[b]&&
(d=c(a,b)||c(b,a));return d},node:function(a){return C[a]},loop:d,loopLevels:function(a,c,d){function e(){this.items={};this.minimumLevel=null}function f(a,b,c){var d=n[b];d||(d=new e,n[b]=d);d.addItemToLevel(a,c);u=null==u?c:Math.min(u,c);m[a]=c;k[a]=!0}var g=[],h={},k={},l=[],m={},n={},p,q,r,s,t,u=null;r=c?i:j;var v,w,x,y,A,B,E,P;e.prototype.addItemToLevel=function(a,b){var c=this.items[b];c?c.push(a):(c=[a],this.items[b]=c);this.minimumLevel=null==this.minimumLevel?b:Math.min(this.minimumLevel,
b)};if(null!=d){r(this,function(a,b,c){g.push(a);h[a]=c});r=0;for(v=g.length;r<v;r+=1)if(p=g[r],null==k[p]){l.push(p);for(f(p,r,0);0<l.length;){A=y=x=null;B=!c;E=[];p=0;for(s=l.length;p<s;p+=1)t=l[p],w=m[t],P=!1,c?(b(this,D,t,function(a){var b;if(!k[a]&&(P=!0,b=h[a],null==x||!B||x<b||x==b&&A>w-1))x=b,y=a,A=w-1,B=!0}),b(this,z,t,function(a){var b;if(!k[a]&&(P=!0,b=h[a],null==x||!B&&(x>b||x==b&&A<w+1)))x=b,y=a,A=w+1,B=!1})):(b(this,z,t,function(a){var b;if(!k[a]&&(P=!0,b=h[a],null==x||B||x<b||x==b&&
A<w+1))x=b,y=a,A=w+1,B=!1}),b(this,D,t,function(a){var b;if(!k[a]&&(P=!0,b=h[a],null==x||B&&(x>b||x==b&&A>w-1)))x=b,y=a,A=w-1,B=!0})),P&&E.push(t);null!=y&&(E.push(y),f(y,r,A));l=E}}l=!0;for(c=u;l;){p={};l=!1;for(q in n)if(n.hasOwnProperty(q)&&(r=n[q],s=r.items[r.minimumLevel-u+c],null!=s)){p[q]=r;l=!0;r=0;for(v=s.length;r<v;r+=1)if(t=s[r],d.call(a,t,C[t],c-u))return l=!1,!0}n=p;c+=1}}},loopTopo:i,loopTopoReversed:j,loopChildren:e,loopParents:g,findLargestRoot:function(){var a=null,b,c={},d={},e;
b=null;j(this,function(f,h){c.hasOwnProperty(f)||(c[f]={},d[f]=0);c[f][f]=!0;d[f]+=1;e=!0;g(this,h.id,function(a){var b,g;e=!1;c.hasOwnProperty(a)||(c[a]={},d[a]=0);if(!d[a]&&1==B[f])c[a]=c[f],d[a]=d[f];else for(g in b=c[f],b)b.hasOwnProperty(g)&&(c[a][g]=!0,d[a]+=1);return 2});if(e&&(!b||d[f]>b))b=d[f],a=f});return a},loopRoots:function(a,b){var c=null,d,e=0,f={},h={},i,k={},l={},m,n,p,q,r,s,t;j(this,function(a,b){f.hasOwnProperty(a)||(f[a]={},h[a]=0);f[a][a]=!0;h[a]+=1;i=!0;g(this,b.id,function(b){var c,
d;i=!1;f.hasOwnProperty(b)||(f[b]={},h[b]=0);if(!h[b]&&1==B[a])f[b]=f[a],h[b]=h[a];else for(d in c=f[a],c)c.hasOwnProperty(d)&&!f[b][d]&&(f[b][d]=!0,h[b]+=1);return 2});i&&(k[a]=!0,e+=1)});q={};for(p in k)if(k.hasOwnProperty(p))for(n in d=f[p],d)d.hasOwnProperty(n)&&(q[n]||(q[n]=[]),q[n].push(p.toString()));for(;0<e;){d=null;for(m in k)if(k.hasOwnProperty(m)&&(!d||h[m]<d))d=h[m],c=m;if(null!=c){null!=b&&b.call(a,c,C[c]);d=f[c];for(n in d)if(d.hasOwnProperty(n)&&!l[n]){p=q[n];s=0;for(t=p.length;s<
t;s+=1)r=p[s],h[r]-=1;l[n]=!0}delete k[c];e-=1}}},hasNodes:function(){return!primitives.common.isEmptyObject(C)},hasCommonChild:function(a){var c=!1,d,e,f,g,h,i,j;d={};g=f=0;for(h=a.length;g<h;g+=1)i=a[g],null!=C[i]&&!d[i]&&(d[i]=!0,f+=1);e={};for(i in d)d.hasOwnProperty(i)&&b(this,z,i,function(a){e[a]=e[a]?e[a]+1:1});for(j in e)if(e.hasOwnProperty(j)&&null!=D[j]&&(B[j]||0)==e[j]&&e[j]==f){c=!0;break}return c},loopNeighbours:function(a,b,c){var d={};null!=c&&(e(this,b,function(b,e){d.hasOwnProperty(b)||
(d[b]=null,c.call(a,b,e,1)&&(d[b]=2,g(this,b,function(b,e){d.hasOwnProperty(b)||(d[b]=null,c.call(a,b,e,2)&&(d[b]=2));return d[b]})));return d[b]}),g(this,b,function(b,f){d.hasOwnProperty(b)||(d[b]=null,c.call(a,b,f,1)&&(d[b]=2,e(this,b,function(b,e){d.hasOwnProperty(b)||(d[b]=!0,c.call(a,b,e,2)&&(d[b]=2));return d[b]})));return d[b]}))},countChildren:s,countParents:u,firstParent:y,firstChild:t,validate:function(a){function c(a){var b=0,d;if(null!=a)for(d in a)a.hasOwnProperty(d)&&(b+=1);return b}
var e,f;d(this,function(c){b(this,z,c,function(b){if(!D.hasOwnProperty(b)||!D[b].hasOwnProperty(c))return null!=a&&(a.message="Child #"+b+" does not reference parent #"+c),!1});b(this,D,c,function(b){if(!z.hasOwnProperty(b)||!z[b].hasOwnProperty(c))return null!=a&&(a.message="Parent #"+b+" does not reference child #"+c),!1})});for(e in D)if(D.hasOwnProperty(e)){if((B[e]||0)!=c(D[e]))return null!=a&&(a.message="Parents count for item #"+e+" missmatch."),!1;if(D.hasOwnProperty(e)&&!C.hasOwnProperty(e))return null!=
a&&(a.message="Orphant parents for item #"+e),!1}for(f in z)if(z.hasOwnProperty(f)){if((E[f]||0)!=c(z[f]))return null!=a&&(a.message="Children count for item "+f+" missmatch."),!1;if(z.hasOwnProperty(f)&&!C.hasOwnProperty(f))return null!=a&&(a.message="Orphant children of item "+f),!1}for(f in w)if(w.hasOwnProperty(f)){if((x[f]||0)!=c(w[f]))return null!=a&&(a.message="Root children count for item @"+f+" missmatch."),!1;b(this,w,f,function(b){if(!C.hasOwnProperty(b))return null!=a&&(a.message="Child #"+
b+"of root #"+f+" does not exists."),!1})}return!0},hasLoops:function(){var a=A();i(this,function(b){a.removeNode(b)});return a.hasNodes()},clone:A,BREAK:1,SKIP:2}};primitives.common.getMinimumCrossingRows=function(a,b,c){var d=a=null;if(null!=c){b.sort(function(a,b){return a.y-b.y});for(var f=0;f<b.length;f+=1){var e=b[f],g=e.bottom();null===a?(a=e.y,d=g):e.y>=d?(c.call(this.Arg,a),a=e.y,d=g):(e.y>a&&(a=e.y),g<d&&(d=g))}null!==a&&c.call(this.Arg,a)}};
primitives.common.TreeLevels=function(a){function b(a){this.context=a;this.items=[]}function c(a,b,c){this.context=a;this.positions={};this.positions[c]=b;this.endLevel=this.startLevel=c}function d(a){null==f[a]&&(f[a]=new b(null),g=null===g?a:Math.min(g,a),h=null===h?a:Math.max(h,a));return f[a]}var f=[],e={},g=null,h=null;primitives.common.isObject(a)&&(f=primitives.common.cloneObject(a.levels,!0),e=primitives.common.cloneObject(a.items,!0),g=primitives.common.cloneObject(a.minimum,!0),h=primitives.common.cloneObject(a.maximum,
!0));return{addlevel:function(a,b){d(a).context=b},hasLevel:function(a){return null!=f[a]},hasItem:function(a){return e.hasOwnProperty(a)},addItem:function(a,b,f){var g;e.hasOwnProperty(b)?(g=d(a),g.items.push(b),b=e[b],b.positions[a]=g.items.length-1,b.startLevel=Math.min(b.startLevel,a),b.endLevel=Math.max(b.endLevel,a)):(g=d(a),g.items.push(b),e[b]=new c(f,g.items.length-1,a))},getItemContext:function(a){var b=null;e.hasOwnProperty(a)&&(b=e[a].context);return b},getLevelIndex:function(a){return e.hasOwnProperty(a)?
e[a].startLevel:null},getEndLevelIndex:function(a){return e.hasOwnProperty(a)?e[a].endLevel:null},getItemPosition:function(a,b){var c=e[a];return null!=c?null!=b?c.positions[b]:c.positions[c.startLevel]:null},getItemAtPosition:function(a,b){var c=f[a],d=null;null!=c&&(d=c.items[b]);return d},loopLevels:function(a,b){var c,d;if(null!=b)for(c=g;c<=h&&!(d=f[c],null!=d&&b.call(a,c,d.context));c+=1);},loopLevelsReversed:function(a,b){var c,d;if(null!=b)for(c=h;c>=g&&!(d=f[c],null!=d&&b.call(a,c,d.context));c-=
1);},loopLevelItems:function(a,b,c){var d,g,h;if(null!=c&&(g=f[b],null!=g)){b=0;for(d=g.items.length;b<d&&!(h=g.items[b],c.call(a,h,e[h].context,b));b+=1);}},getLevelLength:function(a){var b=0,a=f[a];null!=a&&(b=a.items.length);return b},loopItems:function(a,b){var c,d,m,n,p,r,q={};if(null!=b)for(n=g;n<=h;n+=1)if(m=f[n],null!=m){p=m.items;c=0;for(d=p.length;c<d;c+=1)if(r=p[c],!q.hasOwnProperty(r)&&(q[r]=!0,b.call(a,r,e[r].context,c,n,m.context)))return}},binarySearch:function(a,b,c){var d=null;null!=
c&&(b=f[b],null!=b&&(d=primitives.common.binarySearch(b.items,function(b){return c.call(a,b,e[b].context)})));return d.item},loopMerged:function(a,b,c){var d,g,h,p=[];d=0;for(g=f.length;d<g;d+=1)h=f[d],null!=h&&p.push(h.items);h=primitives.common.mergeSort(p,b,!0);if(null!=c){d=0;for(g=h.length;d<g&&!(b=h[d],c.call(a,b,e[b].context));d+=1);}},loopFromItem:function(a,b,c,d,g){var h;if(e.hasOwnProperty(b)&&(b=e[b],h=g||b.startLevel,g=f[h].items,b=b.positions[h],null!=d))if(c)for(c=b-1;0<=c&&!(h=g[c],
d.call(a,h,e[h].context));c-=1);else{c=b+1;for(b=g.length;c<b&&!(h=g[c],d.call(a,h,e[h].context));c+=1);}},loopLevelsFromItem:function(a,b,c,d){if(e.hasOwnProperty(b)&&(b=e[b],null!=d))if(c)for(c=b.endLevel+1;c<=h&&!(b=f[c],d.call(a,c,null!=b?b.context:null));c+=1);else for(c=b.startLevel-1;c>=g&&!(b=f[c],d.call(a,c,null!=b?b.context:null));c-=1);},getPrevItem:function(a,b){var c=null;e.hasOwnProperty(a)&&(c=e[a],b=b||c.startLevel,c=f[b].items[c.positions[b]-1]);return c},getNextItem:function(a,b){var c=
null;e.hasOwnProperty(a)&&(c=e[a],b=b||c.startLevel,c=f[b].items[c.positions[b]+1]);return c},length:function(){return f.length},isEmpty:function(){return!f.length},clone:function(){return primitives.common.TreeLevels({levels:f,items:e,minimum:g,maximum:h})}}};
primitives.common.DependencyManager=function(){var a={};return{register:function(b,c){return a[b]=c},resolve:function(b,c,d){var f=[],e=d||{};return function(){for(var d=Array.prototype.slice.call(arguments,0),h=0;h<b.length;h+=1){var i=b[h];f.push(a.hasOwnProperty(i)&&""!==i?a[i]:d.shift())}f=f.concat(d);return c.apply(e||{},f)}}}};
primitives.common.KeyboardNavigationManager=function(){function a(a,b){this.itemid=a;this.row=b}function b(){if(null==g){var a=0;e=primitives.common.SortedList();primitives.common.getMinimumCrossingRows(this,f,function(b){e.add(b,a);a+=1});g=primitives.common.TreeLevels();f.sort(function(a,b){return a.horizontalCenter()-b.horizontalCenter()});for(var b=0,c=f.length;b<c;b+=1){var d=f[b];e.loopForward(this,d.y,function(a,b){if(a>d.bottom())return!0;g.addItem(b,d.context,d)})}}}function c(c){b();if(null==
h||h.itemid!=c)h=new a(c,g.getLevelIndex(c));return h}function d(a){var b=g.getItemContext(h.itemid).horizontalCenter(),c=h.itemid;g.loopLevelsFromItem(this,h.itemid,a,function(a){h.row=a;h.itemid=g.binarySearch(this,a,function(a,c){return b-c.horizontalCenter()});return!0});c==h.itemid&&(h.row=a?g.getEndLevelIndex(h.itemid):g.getLevelIndex(h.itemid))}var f=[],e,g,h=null;return{addRect:function(a,b){var c=new primitives.common.Rect(a);c.context=b;f.push(c)},prepair:b,getItemAbove:function(a){h=c(a);
d(!1);return h.itemid},getItemBelow:function(a){h=c(a);d(!0);return h.itemid},getItemOnLeft:function(a){h=c(a);a=g.getPrevItem(h.itemid,h.row);null!=a&&(h.itemid=a);return h.itemid},getItemOnRight:function(a){h=c(a);a=g.getNextItem(h.itemid,h.row);null!=a&&(h.itemid=a);return h.itemid},getNavigationLevels:function(){b();var a=[];g.loopLevels(this,function(b){var c=[];g.loopLevelItems(this,b,function(a){c.push(a)});a.push(c)});return a}}};
primitives.common.TaskManager=function(){function a(a,b,c,d){this.name=a;this.dependencies=b;this.factory=c;this.task=null;this.color=d}var b=new primitives.common.family,c=new primitives.common.DependencyManager,d=[];return{addTask:function(c,e,g,h){if(0<d.length)throw"Task Manager is already initialized";b.add(e,c,new a(c,e,g,h))},addDependency:function(a,b){if(0<d.length)throw"Task Manager is already initialized";c.register(a,b)},getTask:function(a){return(a=b.node(a))&&a.task},process:function(a,
e,g){var h=!1;0===d.length&&b.loopTopo(this,function(a,b){b.task=c.register(a,c.resolve(b.dependencies,b.factory)());d.push(b)});g&&console.log("-- process --");for(var i={},j=0,k=d.length;j<k;j+=1){var l=d[j],m=[];if(l.name==a||i.hasOwnProperty(l.name)){if(g)var n=performance.now();(h=l.task.process(g))&&b.loopChildren(this,l.name,function(a){i[a]=!0;g&&m.push(a);return b.SKIP});if(g)var p=performance.now();if(g){var r=Math.round(p-n,2);console.log(j+". "+l.name+(", "+r+" ms. ")+(h?" - forces: "+
m.toString():""))}}if(l.name==e)break}},getProcessDiagramConfig:function(){var a=new primitives.famdiagram.Config;0===d.length&&b.loopTopo(this,function(a,b){b.task=c.register(a,c.resolve(b.dependencies,b.factory)());d.push(b)});for(var e=0,g=d.length;e<g;e+=1){var h=d[e],i=new primitives.famdiagram.ItemConfig;i.id=h.name;i.title=primitives.common.splitCamelCaseName(h.name).join(" ");i.description=h.task.description||"";i.itemTitleColor=h.color;i.parents=[];b.loopParents(this,h.name,function(a){i.parents.push(a);
return b.SKIP});a.items.push(i)}return a}}};primitives.pdf.graphics=function(a){this._context=this._doc=a;this._dummyPlaceholder=new primitives.common.Placeholder};primitives.pdf.graphics.prototype.clean=function(){};primitives.pdf.graphics.prototype.resize=function(){};primitives.pdf.graphics.prototype.begin=function(){};primitives.pdf.graphics.prototype.end=function(){};primitives.pdf.graphics.prototype.reset=function(){};primitives.pdf.graphics.prototype.activate=function(){return this._dummyPlaceholder};
primitives.pdf.graphics.prototype.text=function(){};primitives.pdf.graphics.prototype.polylinesBuffer=function(a){a.loop(this,function(a){0<a.length()&&this.polyline(a)})};
primitives.pdf.graphics.prototype.polyline=function(a){var b=a.paletteItem.toAttr(),c,d=this._doc;d.save();a.loop(this,function(a){switch(a.segmentType){case 1:d.moveTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5);break;case 0:d.lineTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5);break;case 4:a.width==a.height&&a.width/2<=a.cornerRadius?d.roundedRect(Math.round(a.x)+0.5,Math.round(a.y)+0.5,a.width,a.height,Math.min(a.width,a.height)/2):0===a.cornerRadius?(d.moveTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5),
d.lineTo(Math.round(a.x+a.width)+0.5,Math.round(a.y)+0.5),d.lineTo(Math.round(a.x+a.width)+0.5,Math.round(a.y+a.height)+0.5),d.lineTo(Math.round(a.x)+0.5,Math.round(a.y+a.height)+0.5),d.lineTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5)):(c=Math.min(a.cornerRadius,Math.min(a.width/2,a.height/2)),d.roundedRect(Math.round(a.x)+0.5,Math.round(a.y)+0.5,a.width,a.height,c));break;case 2:d.quadraticCurveTo(Math.round(a.cpX)+0.5,Math.round(a.cpY)+0.5,Math.round(a.x)+0.5,Math.round(a.y)+0.5);break;case 3:d.bezierCurveTo(Math.round(a.cpX1)+
0.5,Math.round(a.cpY1)+0.5,Math.round(a.cpX2)+0.5,Math.round(a.cpY2)+0.5,Math.round(a.x)+0.5,Math.round(a.y)+0.5)}});d.lineJoin("round");if(null!=b.lineType)switch(a=Math.round(b.lineWidth)||1,b.lineType){case 1:d.dash(a,2*a);break;case 2:d.dash(5*a,3*a)}void 0!==b.lineWidth&&void 0!==b.fillColor?d.lineWidth(b.lineWidth).fillOpacity(b.opacity).fillAndStroke(b.fillColor,b.borderColor):void 0!==b.lineWidth?d.lineWidth(b.lineWidth).stroke(b.borderColor):void 0!==b.fillColor&&d.fillOpacity(b.opacity).fillColor(b.fillColor);
d.restore()};primitives.pdf.graphics.prototype.rightAngleLine=function(){};primitives.pdf.graphics.prototype.template=function(a,b,c,d,f,e,g,h,i,j,k,l,m){c=0;null!==m&&void 0!==m["border-width"]&&(c=this.getPxSize(m["border-width"]));a=new primitives.common.Rect(a+f,b+e,g-c,h-c);null==l&&(l=new primitives.common.RenderEventArgs);null!==k&&k(this._doc,a,l)};
primitives.pdf.graphics.prototype.getPxSize=function(a,b){var c=a;"string"===typeof a&&(c=0<a.indexOf("pt")?96*parseInt(a,10)/72:0<a.indexOf("%")?parseFloat(a)/100*b:parseInt(a,10));return c};
primitives.pdf.famdiagram.Plugin=function(a){function b(){return e.options}function c(){return e.graphics}function d(){var a=new primitives.common.TaskManager;a.addDependency("options",b);a.addDependency("graphics",c);a.addDependency("defaultConfig",new primitives.famdiagram.Config);a.addDependency("defaultItemConfig",new primitives.famdiagram.ItemConfig);a.addDependency("defaultTemplateConfig",new primitives.famdiagram.TemplateConfig);a.addDependency("defaultButtonConfig",new primitives.famdiagram.ButtonConfig);
a.addDependency("defaultPaletteItemConfig",new primitives.famdiagram.PaletteItemConfig);a.addDependency("defaultBackgroundAnnotationConfig",new primitives.famdiagram.BackgroundAnnotationConfig);a.addDependency("defaultConnectorAnnotationConfig",new primitives.famdiagram.ConnectorAnnotationConfig);a.addDependency("defaultHighlightPathAnnotationConfig",new primitives.famdiagram.HighlightPathAnnotationConfig);a.addDependency("defaultShapeAnnotationConfig",new primitives.famdiagram.ShapeAnnotationConfig);
a.addDependency("defaultLabelAnnotationConfig",new primitives.famdiagram.LabelAnnotationConfig);a.addDependency("isFamilyChartMode",!0);a.addDependency("showElbowDots",!0);a.addDependency("null",null);a.addDependency("foreground",2);a.addDependency("background",1);a.addTask("OptionsTask",["options"],primitives.famdiagram.OptionsTask,"#000000");a.addTask("CalloutOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],primitives.orgdiagram.CalloutOptionTask,"#000080");a.addTask("ConnectorsOptionTask",
["OptionsTask","defaultConfig"],primitives.orgdiagram.ConnectorsOptionTask,"#000080");a.addTask("ItemsOptionTask",["OptionsTask","defaultItemConfig"],primitives.famdiagram.ItemsOptionTask,"#000080");a.addTask("SpousesOptionTask",["OptionsTask","defaultItemConfig"],primitives.famdiagram.SpousesOptionTask,"#000080");a.addTask("ItemsSizesOptionTask",["OptionsTask","defaultConfig","defaultItemConfig","defaultButtonConfig"],primitives.orgdiagram.ItemsSizesOptionTask,"#000080");a.addTask("TemplatesOptionTask",
["OptionsTask","defaultConfig","defaultButtonConfig","defaultTemplateConfig"],primitives.orgdiagram.TemplatesOptionTask,"#000080");a.addTask("OrientationOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.OrientationOptionTask,"#000080");a.addTask("VisualTreeOptionTask",["OptionsTask"],primitives.famdiagram.VisualTreeOptionTask,"#000080");a.addTask("NormalizeOptionTask",["OptionsTask","defaultConfig"],primitives.famdiagram.NormalizeOptionTask,"#000080");a.addTask("LinePaletteOptionTask",
["OptionsTask","defaultPaletteItemConfig"],primitives.famdiagram.LinePaletteOptionTask,"#000080");a.addTask("CursorItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.CursorItemOptionTask,"#000080");a.addTask("HighlightItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.HighlightItemOptionTask,"#000080");a.addTask("SelectedItemsOptionTask",["OptionsTask"],primitives.orgdiagram.SelectedItemsOptionTask,"#000080");a.addTask("SplitAnnotationsOptionTask",["OptionsTask"],
primitives.orgdiagram.SplitAnnotationsOptionTask,"#00ffff");a.addTask("ForegroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","foreground"],primitives.orgdiagram.ShapeAnnotationOptionTask,"#000080");a.addTask("BackgroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","background"],primitives.orgdiagram.ShapeAnnotationOptionTask,"#000080");a.addTask("ForegroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask",
"defaultHighlightPathAnnotationConfig","foreground"],primitives.orgdiagram.HighlightPathAnnotationOptionTask,"#000080");a.addTask("BackgroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","background"],primitives.orgdiagram.HighlightPathAnnotationOptionTask,"#000080");a.addTask("ForegroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","foreground"],primitives.orgdiagram.ConnectorAnnotationOptionTask,
"#000080");a.addTask("BackgroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","background"],primitives.orgdiagram.ConnectorAnnotationOptionTask,"#000080");a.addTask("BackgroundAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultBackgroundAnnotationConfig"],primitives.orgdiagram.BackgroundAnnotationOptionTask,"#000080");a.addTask("ScaleOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.ScaleOptionTask,"#000080");a.addTask("LogicalFamilyTask",
["ItemsOptionTask"],primitives.famdiagram.LogicalFamilyTask,"#00ffff");a.addTask("LabelAnnotationOptionTask",["SplitAnnotationsOptionTask","LogicalFamilyTask","defaultLabelAnnotationConfig"],primitives.famdiagram.LabelAnnotationOptionTask,"#000080");a.addTask("LabelAnnotationTemplateOptionTask",["LabelAnnotationOptionTask","defaultLabelAnnotationConfig"],primitives.famdiagram.LabelAnnotationTemplateOptionTask,"#000080");a.addTask("LabelAnnotationPlacementOptionTask",["LabelAnnotationOptionTask","defaultLabelAnnotationConfig"],
primitives.famdiagram.LabelAnnotationPlacementOptionTask,"#000080");a.addTask("CombinedContextsTask",["ItemsOptionTask","LabelAnnotationOptionTask"],primitives.orgdiagram.CombinedContextsTask,"#00ffff");a.addTask("AddLabelAnnotationsTask",["LabelAnnotationPlacementOptionTask","LogicalFamilyTask"],primitives.famdiagram.AddLabelAnnotationsTask,"#ff0000");a.addTask("RemoveLoopsTask",["ItemsOptionTask","AddLabelAnnotationsTask"],primitives.famdiagram.RemoveLoopsTask,"#ff0000");a.addTask("AddSpousesTask",
["SpousesOptionTask","RemoveLoopsTask"],primitives.famdiagram.AddSpousesTask,"#ff0000");a.addTask("NormalizeLogicalFamilyTask",["NormalizeOptionTask","AddSpousesTask","defaultItemConfig"],primitives.famdiagram.NormalizeLogicalFamilyTask,"#ff0000");a.addTask("ReadTemplatesTask",["TemplatesOptionTask"],primitives.pdf.orgdiagram.ReadTemplatesTask,"#00ffff");a.addTask("ItemTemplateParamsTask",["ItemsSizesOptionTask","CursorItemOptionTask","ReadTemplatesTask"],primitives.orgdiagram.ItemTemplateParamsTask,
"#00ffff");a.addTask("LabelAnnotationTemplateParamsTask",["ItemsSizesOptionTask","LabelAnnotationTemplateOptionTask","ReadTemplatesTask"],primitives.famdiagram.LabelAnnotationTemplateParamsTask,"#00ffff");a.addTask("CombinedTemplateParamsTask",["ItemTemplateParamsTask","LabelAnnotationTemplateParamsTask"],primitives.famdiagram.CombinedTemplateParamsTask,"#00ffff");a.addTask("GroupTitleTemplateTask",["TemplatesOptionTask"],primitives.pdf.orgdiagram.GroupTitleTemplateTask,"#00ffff");a.addTask("CheckBoxTemplateTask",
["ItemsSizesOptionTask"],primitives.pdf.orgdiagram.CheckBoxTemplateTask,"#00ffff");a.addTask("ButtonsTemplateTask",["ItemsSizesOptionTask"],primitives.pdf.orgdiagram.ButtonsTemplateTask,"#00ffff");a.addTask("AnnotationLabelTemplateTask",["ItemsOptionTask"],primitives.pdf.orgdiagram.AnnotationLabelTemplateTask,"#00ffff");a.addTask("ConnectionsGraphTask",["graphics","CreateTransformTask","ConnectorsOptionTask","NormalizeLogicalFamilyTask","AlignDiagramTask"],primitives.orgdiagram.ConnectionsGraphTask,
"#00ffff");a.addTask("HighlightItemTask",["HighlightItemOptionTask","null"],primitives.orgdiagram.HighlightItemTask,"#00ffff");a.addTask("CursorItemTask",["CursorItemOptionTask","null"],primitives.orgdiagram.CursorItemTask,"#00ffff");a.addTask("SelectedItemsTask",["SelectedItemsOptionTask"],primitives.orgdiagram.SelectedItemsTask,"#00ffff");a.addTask("CombinedNormalVisibilityItemsTask",["OptionsTask"],primitives.pdf.orgdiagram.DummyCombinedNormalVisibilityItemsTask,"#00ffff");a.addTask("CurrentControlSizeTask",
["OptionsTask"],primitives.pdf.orgdiagram.DummyCurrentControlSizeTask,"#00ffff");a.addTask("ItemsPositionsTask","CurrentControlSizeTask ScaleOptionTask OrientationOptionTask ItemsSizesOptionTask ConnectorsOptionTask NormalizeOptionTask NormalizeLogicalFamilyTask CombinedTemplateParamsTask CursorItemTask CombinedNormalVisibilityItemsTask".split(" "),primitives.famdiagram.ItemsPositionsTask,"#ff0000");a.addTask("AlignDiagramTask","OrientationOptionTask ItemsSizesOptionTask VisualTreeOptionTask ScaleOptionTask CurrentControlSizeTask null ItemsPositionsTask isFamilyChartMode".split(" "),
primitives.orgdiagram.AlignDiagramTask,"#ff0000");a.addTask("CreateTransformTask",["OrientationOptionTask","AlignDiagramTask"],primitives.orgdiagram.CreateTransformTask,"#00ffff");a.addTask("PaletteManagerTask",["ConnectorsOptionTask","LinePaletteOptionTask"],primitives.orgdiagram.PaletteManagerTask,"#00ffff");a.addTask("DrawBackgroundAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask BackgroundAnnotationOptionTask AddLabelAnnotationsTask AlignDiagramTask".split(" "),primitives.orgdiagram.DrawBackgroundAnnotationTask,
"#008000");a.addTask("DrawBackgroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background DrawBackgroundAnnotationTask".split(" "),primitives.orgdiagram.DrawShapeAnnotationTask,"#008000");a.addTask("DrawBackgroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background DrawBackgroundShapeAnnotationTask".split(" "),
primitives.orgdiagram.DrawConnectorAnnotationTask,"#008000");a.addTask("DrawBackgroundHighlightPathAnnotationTask","graphics ConnectorsOptionTask ForegroundHighlightPathAnnotationOptionTask ConnectionsGraphTask foreground DrawBackgroundConnectorAnnotationTask".split(" "),primitives.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff");a.addTask("DrawConnectorsTask","graphics ConnectionsGraphTask ConnectorsOptionTask showElbowDots PaletteManagerTask DrawBackgroundHighlightPathAnnotationTask".split(" "),
primitives.orgdiagram.DrawConnectorsTask,"#008000");a.addTask("DrawForegroundHighlightPathAnnotationTask","graphics ConnectorsOptionTask BackgroundHighlightPathAnnotationOptionTask ConnectionsGraphTask background DrawConnectorsTask".split(" "),primitives.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff");a.addTask("DrawTreeItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask ItemsSizesOptionTask CombinedContextsTask AlignDiagramTask CombinedTemplateParamsTask CursorItemTask SelectedItemsTask GroupTitleTemplateTask CheckBoxTemplateTask ButtonsTemplateTask DrawForegroundHighlightPathAnnotationTask".split(" "),
primitives.orgdiagram.DrawTreeItemsTask,"#008000");a.addTask("DrawCursorTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask CombinedTemplateParamsTask CursorItemTask SelectedItemsTask DrawTreeItemsTask".split(" "),primitives.orgdiagram.DrawCursorTask,"#008000");a.addTask("DrawHighlightTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask CombinedTemplateParamsTask HighlightItemTask CursorItemTask SelectedItemsTask DrawCursorTask".split(" "),
primitives.orgdiagram.DrawHighlightTask,"#008000");a.addTask("DrawForegroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground DrawHighlightTask".split(" "),primitives.orgdiagram.DrawShapeAnnotationTask,"#008000");a.addTask("DrawForegroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground DrawForegroundShapeAnnotationTask".split(" "),
primitives.orgdiagram.DrawConnectorAnnotationTask,"#008000");return a}function f(){e.options.hasButtons=2;e.options.pageFitMode=5;e.options.autoSizeMaximum=new primitives.common.Size(1E5,1E5)}var e={name:"famdiagram",doc:null,options:a,tasks:null,graphics:null};return{draw:function(a,h,i){e.doc=a;e.tasks=d(b,c);e.graphics=new primitives.pdf.graphics(e.doc);e.graphics.debug=!1;f();e.doc.save();e.doc.translate(h,i);e.tasks.process("OptionsTask",null,!1);e.doc.restore();a=e.tasks.getTask("AlignDiagramTask");
return new primitives.common.Size(a.getContentSize())},getSize:function(){e.tasks=d(b,c);f();e.tasks.process("OptionsTask","AlignDiagramTask",!1);var a=e.tasks.getTask("AlignDiagramTask");return new primitives.common.Size(a.getContentSize())}}};
primitives.pdf.Template=function(a,b){this.cursorTemplate=this.dotHighlightTemplate=this.highlightTemplate=this.itemTemplate=this.templateConfig=null;null!=b&&(this.templateConfig=b,this.itemTemplate=primitives.common.isNullOrEmpty(b.itemTemplate)?new primitives.pdf.ItemTemplate(a,b):new primitives.pdf.UserTemplate(a,b,a.onItemRender),this.highlightTemplate=primitives.common.isNullOrEmpty(b.highlightTemplate)?new primitives.pdf.HighlightTemplate(a,b):new primitives.pdf.UserTemplate(a,b,a.onHighlightRender),
this.dotHighlightTemplate=new primitives.pdf.DummyTemplate(a,b),this.cursorTemplate=primitives.common.isNullOrEmpty(b.cursorTemplate)?new primitives.pdf.CursorTemplate(a,b):new primitives.pdf.UserTemplate(a,b,a.onCursorRender))};primitives.pdf.orgdiagram.DummyCurrentControlSizeTask=function(){return{process:function(){return!0},getScrollPanelSize:function(){return new primitives.common.Size(800,600)},getOptimalPanelSize:function(){return new primitives.common.Size(775,575)}}};
primitives.pdf.orgdiagram.AnnotationLabelTemplateTask=function(){var a=null;return{process:function(){return!1},getTemplate:function(){null==a&&(a=new primitives.pdf.AnnotationLabelTemplate);return a}}};primitives.pdf.orgdiagram.ButtonsTemplateTask=function(){var a=null;return{process:function(){return!1},getTemplate:function(){null==a&&(a=new primitives.pdf.DummyTemplate);return a}}};
primitives.pdf.orgdiagram.CheckBoxTemplateTask=function(a){var b=null;return{process:function(){b=null;return!0},getTemplate:function(){var c;null==b&&(c=a.getOptions(),b=new primitives.pdf.CheckBoxTemplate(c.selectCheckBoxLabel));return b}}};
primitives.pdf.orgdiagram.GroupTitleTemplateTask=function(a){var b=null;return{process:function(){b=null;return!0},getTemplate:function(){var c;null==b&&(c=a.getOptions(),b=new primitives.pdf.GroupTitleTemplate(c.itemTitleFirstFontColor,c.itemTitleSecondFontColor));return b}}};
primitives.pdf.orgdiagram.ReadTemplatesTask=function(a){var b={};return{process:function(){var c,d,f,e=a.getOptions(),g=e.templates;b={};b.DefaultWidgetTemplate=new primitives.pdf.Template(e,new primitives.orgdiagram.TemplateConfig);c=new primitives.orgdiagram.TemplateConfig;c.name="DefaultWidgetLabelAnnotationTemplate";c.isActive=!1;c.itemSize=new primitives.common.Size(100,20);c.minimizedItemSize=new primitives.common.Size(0,0);d=new primitives.pdf.Template;d.templateConfig=c;d.minimizedItemCornerRadius=
c.minimizedItemSize.width/2;d.itemTemplate=new primitives.pdf.LabelAnnotationTemplate;d.dotHighlightTemplate=new primitives.pdf.DummyTemplate;b.DefaultWidgetLabelAnnotationTemplate=d;c=0;for(d=g.length;c<d;c+=1)f=g[c],b[f.name]=new primitives.pdf.Template(e,f);return!0},getTemplate:function(a,d,f){return b[a]||b[d]||b[f]},DefaultWidgetTemplateName:"DefaultWidgetTemplate",DefaultWidgetLabelAnnotationTemplateName:"DefaultWidgetLabelAnnotationTemplate"}};
primitives.pdf.orgdiagram.DummyCombinedNormalVisibilityItemsTask=function(){return{process:function(){return!0},isItemSelected:function(){return!1}}};
primitives.pdf.orgdiagram.Plugin=function(a){function b(){return e.options}function c(){return e.graphics}function d(){var a=new primitives.common.TaskManager;a.addDependency("options",b);a.addDependency("graphics",c);a.addDependency("defaultConfig",new primitives.orgdiagram.Config);a.addDependency("defaultItemConfig",new primitives.orgdiagram.ItemConfig);a.addDependency("defaultTemplateConfig",new primitives.orgdiagram.TemplateConfig);a.addDependency("defaultButtonConfig",new primitives.orgdiagram.ButtonConfig);
a.addDependency("defaultBackgroundAnnotationConfig",new primitives.orgdiagram.BackgroundAnnotationConfig);a.addDependency("defaultConnectorAnnotationConfig",new primitives.orgdiagram.ConnectorAnnotationConfig);a.addDependency("defaultHighlightPathAnnotationConfig",new primitives.orgdiagram.HighlightPathAnnotationConfig);a.addDependency("defaultShapeAnnotationConfig",new primitives.orgdiagram.ShapeAnnotationConfig);a.addDependency("isFamilyChartMode",!1);a.addDependency("showElbowDots",!1);a.addDependency("null",
null);a.addDependency("foreground",2);a.addDependency("background",1);a.addTask("OptionsTask",["options"],primitives.orgdiagram.OptionsTask,"#000000");a.addTask("CalloutOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],primitives.orgdiagram.CalloutOptionTask,"#000080");a.addTask("ConnectorsOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.ConnectorsOptionTask,"#000080");a.addTask("ItemsOptionTask",["OptionsTask","defaultItemConfig"],primitives.orgdiagram.ItemsOptionTask,
"#000080");a.addTask("ItemsSizesOptionTask",["OptionsTask","defaultConfig","defaultItemConfig","defaultButtonConfig"],primitives.orgdiagram.ItemsSizesOptionTask,"#000080");a.addTask("TemplatesOptionTask",["OptionsTask","defaultConfig","defaultButtonConfig","defaultTemplateConfig"],primitives.orgdiagram.TemplatesOptionTask,"#000080");a.addTask("OrientationOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.OrientationOptionTask,"#000080");a.addTask("VisualTreeOptionTask",["OptionsTask",
"defaultConfig"],primitives.orgdiagram.VisualTreeOptionTask,"#000080");a.addTask("CursorItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.CursorItemOptionTask,"#000080");a.addTask("HighlightItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.HighlightItemOptionTask,"#000080");a.addTask("SelectedItemsOptionTask",["OptionsTask"],primitives.orgdiagram.SelectedItemsOptionTask,"#000080");a.addTask("SplitAnnotationsOptionTask",["OptionsTask"],primitives.orgdiagram.SplitAnnotationsOptionTask,
"#00ffff");a.addTask("ForegroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","foreground"],primitives.orgdiagram.ShapeAnnotationOptionTask,"#000080");a.addTask("BackgroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","background"],primitives.orgdiagram.ShapeAnnotationOptionTask,"#000080");a.addTask("ForegroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","foreground"],
primitives.orgdiagram.HighlightPathAnnotationOptionTask,"#000080");a.addTask("BackgroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","background"],primitives.orgdiagram.HighlightPathAnnotationOptionTask,"#000080");a.addTask("ForegroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","foreground"],primitives.orgdiagram.ConnectorAnnotationOptionTask,"#000080");a.addTask("BackgroundConnectorAnnotationOptionTask",
["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","background"],primitives.orgdiagram.ConnectorAnnotationOptionTask,"#000080");a.addTask("BackgroundAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultBackgroundAnnotationConfig"],primitives.orgdiagram.BackgroundAnnotationOptionTask,"#000080");a.addTask("ScaleOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.ScaleOptionTask,"#000080");a.addTask("CombinedContextsTask",["ItemsOptionTask"],primitives.orgdiagram.CombinedContextsTask,
"#00ffff");a.addTask("OrgTreeTask",["ItemsOptionTask"],primitives.orgdiagram.OrgTreeTask,"#ff0000");a.addTask("ReadTemplatesTask",["TemplatesOptionTask"],primitives.pdf.orgdiagram.ReadTemplatesTask,"#00ffff");a.addTask("ItemTemplateParamsTask",["ItemsSizesOptionTask","CursorItemOptionTask","ReadTemplatesTask"],primitives.orgdiagram.ItemTemplateParamsTask,"#00ffff");a.addTask("GroupTitleTemplateTask",["TemplatesOptionTask"],primitives.pdf.orgdiagram.GroupTitleTemplateTask,"#00ffff");a.addTask("CheckBoxTemplateTask",
["ItemsSizesOptionTask"],primitives.pdf.orgdiagram.CheckBoxTemplateTask,"#00ffff");a.addTask("ButtonsTemplateTask",["ItemsSizesOptionTask"],primitives.pdf.orgdiagram.ButtonsTemplateTask,"#00ffff");a.addTask("AnnotationLabelTemplateTask",["ItemsOptionTask"],primitives.pdf.orgdiagram.AnnotationLabelTemplateTask,"#00ffff");a.addTask("VisualTreeTask",["OrgTreeTask","null","VisualTreeOptionTask","isFamilyChartMode"],primitives.orgdiagram.VisualTreeTask,"#ff0000");a.addTask("VisualTreeLevelsTask",["VisualTreeTask",
"ItemTemplateParamsTask"],primitives.orgdiagram.VisualTreeLevelsTask,"#ff0000");a.addTask("ConnectionsGraphTask",["graphics","CreateTransformTask","ConnectorsOptionTask","VisualTreeLevelsTask","AlignDiagramTask"],primitives.orgdiagram.ConnectionsGraphTask,"#00ffff");a.addTask("HighlightItemTask",["HighlightItemOptionTask","null"],primitives.orgdiagram.HighlightItemTask,"#00ffff");a.addTask("CursorItemTask",["CursorItemOptionTask","null"],primitives.orgdiagram.CursorItemTask,"#00ffff");a.addTask("SelectedItemsTask",
["SelectedItemsOptionTask"],primitives.orgdiagram.SelectedItemsTask,"#00ffff");a.addTask("CombinedNormalVisibilityItemsTask",["OptionsTask"],primitives.pdf.orgdiagram.DummyCombinedNormalVisibilityItemsTask,"#00ffff");a.addTask("CurrentControlSizeTask",["OptionsTask"],primitives.pdf.orgdiagram.DummyCurrentControlSizeTask,"#00ffff");a.addTask("ItemsPositionsTask","CurrentControlSizeTask ScaleOptionTask OrientationOptionTask ItemsSizesOptionTask ConnectorsOptionTask VisualTreeOptionTask VisualTreeTask VisualTreeLevelsTask ItemTemplateParamsTask CursorItemTask CombinedNormalVisibilityItemsTask".split(" "),
primitives.orgdiagram.ItemsPositionsTask,"#ff0000");a.addTask("AlignDiagramTask","OrientationOptionTask ItemsSizesOptionTask VisualTreeOptionTask ScaleOptionTask CurrentControlSizeTask null ItemsPositionsTask isFamilyChartMode".split(" "),primitives.orgdiagram.AlignDiagramTask,"#ff0000");a.addTask("CreateTransformTask",["OrientationOptionTask","AlignDiagramTask"],primitives.orgdiagram.CreateTransformTask,"#00ffff");a.addTask("PaletteManagerTask",["ConnectorsOptionTask","null"],primitives.orgdiagram.PaletteManagerTask,
"#00ffff");a.addTask("DrawBackgroundAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask BackgroundAnnotationOptionTask VisualTreeTask AlignDiagramTask".split(" "),primitives.orgdiagram.DrawBackgroundAnnotationTask,"#008000");a.addTask("DrawBackgroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background DrawBackgroundAnnotationTask".split(" "),primitives.orgdiagram.DrawShapeAnnotationTask,
"#008000");a.addTask("DrawBackgroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background DrawBackgroundShapeAnnotationTask".split(" "),primitives.orgdiagram.DrawConnectorAnnotationTask,"#008000");a.addTask("DrawTreeItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask ItemsSizesOptionTask CombinedContextsTask AlignDiagramTask ItemTemplateParamsTask CursorItemTask SelectedItemsTask GroupTitleTemplateTask CheckBoxTemplateTask ButtonsTemplateTask DrawBackgroundConnectorAnnotationTask".split(" "),
primitives.orgdiagram.DrawTreeItemsTask,"#008000");a.addTask("DrawBackgroundHighlightPathAnnotationTask","graphics ConnectorsOptionTask ForegroundHighlightPathAnnotationOptionTask ConnectionsGraphTask foreground DrawTreeItemsTask".split(" "),primitives.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff");a.addTask("DrawConnectorsTask","graphics ConnectionsGraphTask ConnectorsOptionTask showElbowDots PaletteManagerTask DrawBackgroundHighlightPathAnnotationTask".split(" "),primitives.orgdiagram.DrawConnectorsTask,
"#008000");a.addTask("DrawForegroundHighlightPathAnnotationTask","graphics ConnectorsOptionTask BackgroundHighlightPathAnnotationOptionTask ConnectionsGraphTask background DrawConnectorsTask".split(" "),primitives.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff");a.addTask("DrawForegroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground DrawForegroundHighlightPathAnnotationTask".split(" "),
primitives.orgdiagram.DrawShapeAnnotationTask,"#008000");a.addTask("DrawForegroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground DrawForegroundShapeAnnotationTask".split(" "),primitives.orgdiagram.DrawConnectorAnnotationTask,"#008000");a.addTask("DrawCursorTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask ItemTemplateParamsTask CursorItemTask SelectedItemsTask DrawForegroundConnectorAnnotationTask".split(" "),
primitives.orgdiagram.DrawCursorTask,"#008000");a.addTask("DrawHighlightTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask ItemTemplateParamsTask HighlightItemTask CursorItemTask SelectedItemsTask DrawCursorTask".split(" "),primitives.orgdiagram.DrawHighlightTask,"#008000");return a}function f(){e.options.hasButtons=2;e.options.pageFitMode=5;e.options.autoSizeMaximum=new primitives.common.Size(1E5,1E5)}var e={name:"orgdiagram",doc:null,options:a,tasks:null,
graphics:null};return{draw:function(a,h,i){e.doc=a;e.tasks=d(b,c);e.graphics=new primitives.pdf.graphics(e.doc);e.graphics.debug=!1;f();e.doc.save();e.doc.translate(h,i);e.tasks.process("OptionsTask",null,!1);e.doc.restore();a=e.tasks.getTask("AlignDiagramTask");return new primitives.common.Size(a.getContentSize())},getSize:function(){e.tasks=d(b,c);f();e.tasks.process("OptionsTask","AlignDiagramTask",!1);var a=e.tasks.getTask("AlignDiagramTask");return new primitives.common.Size(a.getContentSize())}}};
primitives.pdf.AnnotationLabelTemplate=function(){return{template:function(){return{}},getHashCode:function(){return 0},render:function(a,b,c){c=c.context;a.save();a.font("Helvetica",12).text(c.label,b.x,b.y,{width:b.width,height:b.height,align:"center"});a.restore()}}};
primitives.pdf.CheckBoxTemplate=function(a){return{template:function(){return{}},getHashCode:function(){return 0},render:function(b,c,d){d=d.isSelected?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAF/SURBVDhPpZM7rwFREMf/u4hEY5vVkigoSERiKwq1QqOh28R30QnFRqnSKHwFn0C37Sbi0SCE2KzE41wzd/feG48g91ftmdn5zznzkLLZrNhutzidTvgEv98PRVEgxeNx0e12EYvFcDweXfdjZFmGEIKDx+MxdF0HotGomEwmV/tnUAzFyqT8KrNHLpdDJpPBZrPh81UHLPAO7XYb6/Ua8/kcpmnC5/NBkqT3BJbLJRqNBgKBACqVCgqFAg6HA/veEiiVSlBVFZfLBZ1Ox7V+81KAMtPVV6sV+v2+a/2FBeg9RDqdhqZp/E1Mp1O0Wi32V6tVLuAtLEBvGw6HmM1m2O/3yOfz7CyXy4hEItz3ZrPJtr/8dIEKUiwWYRgGX3e32yGZTOJ8PnMBB4MBB9xy14VarcaZFosFQqEQHMdBvV5HIpFw/3gATZNlWTxdHr1eT4TDYZFKpVzLPRRDsU9HeTQaCdu23dM91wKzwNNlCgaDXINHW0pF95bpn+us4AsY2TIOZFyZ9AAAAABJRU5ErkJggg==":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAACjSURBVDhPrZNNCsQgDEY/f2q33sCCN+iNPJlXE2/gTtDiVBln1TJo+zZBJS+YELLvewkhIOeMETjnkFKCaK2LtRbbtiGl9H2+hlKKUkpLds7BGAMopYr3/rwfo+bUXFrN/yrfcXrQBDMwxkAImRfEGFucFnTeEdT/zNIEy7K0wyi/KfSGjPJoCp13BDM9EEK0eLtM67riOI7LLa0F+zI9XGeJDyTldfBA9FNyAAAAAElFTkSuQmCC";
b.save();b.image(d,c.x,c.y);b.font("Helvetica",11).text(a,c.x+20,c.y+4,{ellipsis:!0,width:c.width-4,height:c.height,align:"left"});b.restore()}}};primitives.pdf.CursorTemplate=function(a,b){return{template:function(){return{}},getHashCode:function(){return 0},render:function(a,d){a.save();a.roundedRect(d.x,d.y,d.width,d.height,4).lineWidth(b.cursorBorderWidth).stroke("#fbd850");a.restore()}}};
primitives.pdf.DummyTemplate=function(){return{template:function(){return{}},getHashCode:function(){return 0},render:function(){}}};
primitives.pdf.GroupTitleTemplate=function(a,b){return{template:function(){return{}},getHashCode:function(){return 0},render:function(c,d,f){new primitives.text.Config;var f=f.context,e=f.groupTitleColor||"#4169e1",g=primitives.common.highestContrast(e,b,a);c.save();c.translate(d.width,0).rotate(90,{origin:[d.x,d.y]});c.fillColor(e).roundedRect(d.x,d.y,d.height-2,d.width,4).fill();c.fillColor(g).font("Helvetica",12).text(f.groupTitle,d.x+4,d.y+6,{ellipsis:!0,width:d.height-4,height:d.width-4,align:"center"});
c.restore()}}};primitives.pdf.HighlightTemplate=function(a,b){return{template:function(){return{}},getHashCode:function(){return 0},render:function(a,d){a.save();a.roundedRect(d.x,d.y,d.width,d.height,4).lineWidth(b.highlightBorderWidth).stroke("#fbcb09");a.restore()}}};
primitives.pdf.ItemTemplate=function(a,b){return{template:function(){return{}},getHashCode:function(){return 0},render:function(c,d,f){var f=f.context,e=null!=f.itemTitleColor?f.itemTitleColor:"#4169e1",g=primitives.common.highestContrast(e,a.itemTitleSecondFontColor,a.itemTitleFirstFontColor),h=new primitives.common.Size(b.itemSize);h.width-=2*b.itemBorderWidth;h.height-=2*b.itemBorderWidth;c.save();c.roundedRect(d.x,d.y,d.width,d.height,4).lineWidth(b.itemBorderWidth).stroke("#dddddd");c.fillColor(e).roundedRect(d.x+
2,d.y+2,h.width-4,18,2).fill();c.fillColor(g).font("Helvetica",12).text(f.title,d.x+4,d.y+7,{ellipsis:!0,width:h.width-4-8,height:16,align:"left"});null!=f.image&&c.image(f.image,d.x+3,d.y+24);c.rect(d.x+3,d.y+24,50,60).stroke("#cccccc");c.fillColor("black").font("Helvetica",10).text(f.description,d.x+56,d.y+24,{ellipsis:!0,width:h.width-4-56,height:74,align:"left"});c.restore()}}};
primitives.pdf.LabelAnnotationTemplate=function(){return{template:function(){return{}},getHashCode:function(){return 0},render:function(a,b,c){c=c.context;a.save();a.font("Helvetica",12).text(c.title,b.x,b.y,{width:b.width,height:b.height,align:"center"});a.restore()}}};primitives.pdf.UserTemplate=function(a,b,c){return{template:function(){return{}},getHashCode:function(){return 0},render:function(d,f,e){null!=c?c(d,f,e):primitives.pdf.ItemTemplate(a,b).render(d,f,e)}}};
primitives.callout.Config=function(){this.classPrefix="bpcallout";this.graphicsType=1;this.pointerPlacement=0;this.snapPoint=this.position=null;this.cornerRadius="10%";this.offset=0;this.lineWidth=this.opacity=1;this.lineType=0;this.pointerWidth="10%";this.borderColor="#000000";this.fillColor="#d3d3d3"};primitives.callout.Controller=function(){this.widgetEventPrefix="bpcallout";this.options=new primitives.callout.Config;this.m_shape=this.m_graphics=this.m_panelSize=this.m_placeholder=null};
primitives.callout.Controller.prototype._create=function(){this.element.addClass("ui-widget");this._createLayout();this._redraw()};primitives.callout.Controller.prototype.destroy=function(){this._cleanLayout()};
primitives.callout.Controller.prototype._createLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());this.m_placeholder=jQuery("<div></div>");this.m_placeholder.css({position:"relative",overflow:"hidden",top:"0px",left:"0px",padding:"0px",margin:"0px"});this.m_placeholder.css(this.m_panelSize.getCSS());this.m_placeholder.addClass("placeholder");this.m_placeholder.addClass(this.widgetEventPrefix);this.element.append(this.m_placeholder);
this.m_graphics=primitives.common.createGraphics(this.options.graphicsType,this.element);this.m_shape=new primitives.common.Callout(this.m_graphics)};primitives.callout.Controller.prototype._cleanLayout=function(){null!==this.m_graphics&&this.m_graphics.clean();this.m_graphics=null;this.element.find("."+this.widgetEventPrefix).remove()};
primitives.callout.Controller.prototype._updateLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.innerWidth(),this.element.innerHeight());this.m_placeholder.css(this.m_panelSize.getCSS())};primitives.callout.Controller.prototype.update=function(a){a?(this._cleanLayout(),this._createLayout(),this._redraw()):(this._updateLayout(),this.m_graphics.resize("placeholder",this.m_panelSize.width,this.m_panelSize.height),this.m_graphics.begin(),this._redraw(),this.m_graphics.end())};
primitives.callout.Controller.prototype._redraw=function(){var a="pointerPlacement cornerRadius offset opacity lineWidth lineType pointerWidth borderColor fillColor".split(" "),b,c;this.m_graphics.activate("placeholder");for(b=0;b<a.length;b+=1)c=a[b],this.m_shape[c]=this.options[c];this.m_shape.draw(this.options.snapPoint,this.options.position)};
primitives.callout.Controller.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":var c=jQuery([]);b?(c.filter(".ui-state-focus").blur(),c.removeClass("ui-state-hover"),c.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(c.propAttr("disabled",!1),this.element.removeClass("ui-disabled"))}};"undefined"!=typeof jQuery&&function(a){a.widget("ui.bpCallout",new primitives.callout.Controller)}(jQuery);
primitives.connector.Config=function(){this.classPrefix="bpconnector";this.graphicsType=1;this.connectorShapeType=this.connectorPlacementType=this.orientationType=0;this.toRectangle=this.fromRectangle=null;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=3;this.color="#000000";this.lineType=0;this.label=null;this.labelSize=new primitives.common.Size(60,30);this.labelPlacementType=1};
primitives.connector.AnnotationLabelTemplate=function(a){var b,c=jQuery("<div></div>");c.addClass("bp-item bp-corner-all bp-connector-label");b=c.wrap("<div>").parent().html();var d=primitives.common.hashCode(b);return{template:function(){return b},getHashCode:function(){return d},render:function(b,c){c.element.html(a.label)}}};
primitives.connector.Controller=function(){this.widgetEventPrefix="bpconnector";this.options=new primitives.connector.Config;this._labelTemplate=this._graphics=this._panelSize=this._placeholder=null};primitives.connector.Controller.prototype._create=function(){this.element.addClass("ui-widget");this._labelTemplate=primitives.connector.AnnotationLabelTemplate(this.options);this._createLayout();this._redraw()};primitives.connector.Controller.prototype.destroy=function(){this._cleanLayout()};
primitives.connector.Controller.prototype._createLayout=function(){this._panelSize=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());this._placeholder=jQuery("<div></div>");this._placeholder.css({position:"relative",overflow:"hidden",top:"0px",left:"0px",padding:"0px",margin:"0px"});this._placeholder.css(this._panelSize.getCSS());this._placeholder.addClass("placeholder");this._placeholder.addClass(this.widgetEventPrefix);this.element.append(this._placeholder);this._graphics=
primitives.common.createGraphics(this.options.graphicsType,this.element)};primitives.connector.Controller.prototype._cleanLayout=function(){null!==this._graphics&&this._graphics.clean();this._graphics=null;this.element.find("."+this.widgetEventPrefix).remove()};primitives.connector.Controller.prototype._updateLayout=function(){this._panelSize=new primitives.common.Rect(0,0,this.element.innerWidth(),this.element.innerHeight());this._placeholder.css(this._panelSize.getCSS())};
primitives.connector.Controller.prototype.update=function(a){a?(this._cleanLayout(),this._createLayout(),this._redraw()):(this._updateLayout(),this._graphics.resize("placeholder",this._panelSize.width,this._panelSize.height),this._graphics.begin(),this._redraw(),this._graphics.end())};
primitives.connector.Controller.prototype._redraw=function(){var a=this.options,b,c,d=new primitives.common.Transform,f=this._graphics.activate("placeholder"),e=new primitives.common.PolylinesBuffer,g=this,h=primitives.orgdiagram.ConnectorAnnotationOffsetResolver();d.size=new primitives.common.Size(this._panelSize.width,this._panelSize.height);d.setOrientation(a.orientationType);if(null!=a.fromRectangle&&null!=a.toRectangle){var i=a.fromRectangle,j=a.toRectangle;d.transformRect(i.x,i.y,i.width,i.height,
!1,this,function(a,b,c,d){i=new primitives.common.Rect(a,b,c,d)});d.transformRect(j.x,j.y,j.width,j.height,!1,this,function(a,b,c,d){j=new primitives.common.Rect(a,b,c,d)});switch(a.connectorPlacementType){case 0:b=new primitives.common.ConnectorOffbeat;break;case 1:b=new primitives.common.ConnectorStraight}var k;d.transformRect(0,0,a.labelSize.width,a.labelSize.height,!1,this,function(a,b,c,d){k=new primitives.common.Size(c,d)});var l=null;d.transformRect(0,0,f.size.width,f.size.height,!1,this,function(a,
b,c,d){l=new primitives.common.Size(c,d)});var f=new primitives.common.PaletteItem({lineColor:a.color,lineWidth:a.lineWidth,lineType:a.lineType}),m=!primitives.common.isNullOrEmpty(a.label),i=(new primitives.common.Rect(i)).offset(a.offset),j=(new primitives.common.Rect(j)).offset(a.offset);b.draw(e,f,i,j,6*a.lineWidth,0,k,l,a.connectorShapeType,4,a.labelPlacementType,m,h,function(b){m&&null!=b&&(d.transformRect(b.x,b.y,b.width,b.height,!0,g,function(a,c,d,e){b=new primitives.common.Rect(a,c,d,e)}),
c=new primitives.common.RenderEventArgs,c.context=a,g._graphics.template(b.x,b.y,0,0,0,0,b.width,b.height,g._labelTemplate.template(),g._labelTemplate.getHashCode(),g._labelTemplate.render,c,null))});h.resolve()}e.transform(d,!0);this._graphics.polylinesBuffer(e)};
primitives.connector.Controller.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":var c=jQuery([]);b?(c.filter(".ui-state-focus").blur(),c.removeClass("ui-state-hover"),c.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(c.propAttr("disabled",!1),this.element.removeClass("ui-disabled"))}};"undefined"!=typeof jQuery&&function(a){a.widget("ui.bpConnector",new primitives.connector.Controller)}(jQuery);
primitives.orgdiagram.Widget=function(a,b){this.widgetEventPrefix="orgdiagram";this.options=new a;this.control=null;this.controlFactory=b};primitives.orgdiagram.Widget.prototype._create=function(){this.element.addClass("ui-widget");this.control=new this.controlFactory(this.element,this._readOptions(this.options))};primitives.orgdiagram.Widget.prototype.destroy=function(){this.control.destroy()};primitives.orgdiagram.Widget.prototype.update=function(a){this.control.update(a)};
primitives.orgdiagram.Widget.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":var c=jQuery([]);b?(c.filter(".ui-state-focus").blur(),c.removeClass("ui-state-hover"),c.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(c.propAttr("disabled",!1),this.element.removeClass("ui-disabled"))}this.control.setOptions(this._readOptions(this.options))};
primitives.orgdiagram.Widget.prototype._readOptions=function(a){var b={},c=this,d;for(d in a)if(a.hasOwnProperty(d))switch(d){case "onHighlightChanged":case "onCursorChanged":case "onSelectionChanging":case "onButtonClick":case "onMouseClick":case "onMouseDblClick":case "onItemRender":case "onHighlightRender":b[d]=function(a){return function(b,d){c._trigger(a,b,d)}}(d);break;case "onHighlightChanging":b[d]=function(a,b){var d=c.control.getOptions();c.options.highlightItem=d.highlightItem;c._trigger("onHighlightChanging",
a,b)};break;case "onCursorChanging":b[d]=function(a,b){var d=c.control.getOptions();c.options.cursorItem=d.cursorItem;c._trigger("onCursorChanging",a,b)};break;case "onSelectionChanged":b[d]=function(a,b){var d=c.control.getOptions();c.options.selectedItems=d.selectedItems;c._trigger("onSelectionChanged",a,b)};break;default:b[d]=a[d]}return b};"undefined"!=typeof jQuery&&function(a){a.widget("ui.orgDiagram",new primitives.orgdiagram.Widget(primitives.orgdiagram.Config,primitives.orgdiagram.Control))}(jQuery);
"undefined"!=typeof jQuery&&function(a){a.widget("ui.famDiagram",new primitives.orgdiagram.Widget(primitives.famdiagram.Config,primitives.famdiagram.Control))}(jQuery);
primitives.shape.Config=function(){this.classPrefix="bpconnector";this.graphicsType=1;this.shapeType=this.orientationType=0;this.position=null;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=2;this.cornerRadius="10%";this.opacity=1;this.fillColor=this.borderColor=null;this.lineType=0;this.label=null;this.labelSize=new primitives.common.Size(60,30);this.labelPlacement=0;this.labelOffset=4};
primitives.shape.AnnotationLabelTemplate=function(a){var b,c=jQuery("<div></div>");c.addClass("bp-item bp-corner-all bp-connector-label");b=c.wrap("<div>").parent().html();var d=primitives.common.hashCode(b);return{template:function(){return b},getHashCode:function(){return d},render:function(b,c){c.element.html(a.label)}}};
primitives.shape.Controller=function(){this.widgetEventPrefix="bpshape";this.options=new primitives.shape.Config;this._labelTemplate=this.m_shape=this.m_graphics=this.m_panelSize=this.m_placeholder=null};primitives.shape.Controller.prototype._create=function(){this.element.addClass("ui-widget");this._labelTemplate=primitives.shape.AnnotationLabelTemplate(this.options);this._createLayout();this._redraw()};primitives.shape.Controller.prototype.destroy=function(){this._cleanLayout()};
primitives.shape.Controller.prototype._createLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());this.m_placeholder=jQuery("<div></div>");this.m_placeholder.css({position:"relative",overflow:"hidden",top:"0px",left:"0px",padding:"0px",margin:"0px"});this.m_placeholder.css(this.m_panelSize.getCSS());this.m_placeholder.addClass("placeholder");this.m_placeholder.addClass(this.widgetEventPrefix);this.element.append(this.m_placeholder);
this.m_graphics=primitives.common.createGraphics(this.options.graphicsType,this.element)};primitives.shape.Controller.prototype._cleanLayout=function(){null!==this.m_graphics&&this.m_graphics.clean();this.m_graphics=null;this.element.find("."+this.widgetEventPrefix).remove()};primitives.shape.Controller.prototype._updateLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.innerWidth(),this.element.innerHeight());this.m_placeholder.css(this.m_panelSize.getCSS())};
primitives.shape.Controller.prototype.update=function(a){a?(this._cleanLayout(),this._createLayout(),this._redraw()):(this._updateLayout(),this.m_graphics.resize("placeholder",this.m_panelSize.width,this.m_panelSize.height),this.m_graphics.begin(),this._redraw(),this.m_graphics.end())};
primitives.shape.Controller.prototype._redraw=function(){var a="orientationType shapeType offset lineWidth borderColor lineType labelSize labelOffset labelPlacement cornerRadius opacity fillColor".split(" "),b,c;this.m_graphics.activate("placeholder");this.m_shape=new primitives.common.Shape(this.m_graphics);for(b=0;b<a.length;b+=1)c=a[b],this.m_shape[c]=this.options[c];this.m_shape.hasLabel=!primitives.common.isNullOrEmpty(this.options.label);this.m_shape.labelTemplate=this._labelTemplate;this.m_shape.panelSize=
new primitives.common.Size(this.m_panelSize.width,this.m_panelSize.height);this.m_shape.draw(this.options.position)};primitives.shape.Controller.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":var c=jQuery([]);b?(c.filter(".ui-state-focus").blur(),c.removeClass("ui-state-hover"),c.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(c.propAttr("disabled",!1),this.element.removeClass("ui-disabled"))}};
"undefined"!=typeof jQuery&&function(a){a.widget("ui.bpShape",new primitives.shape.Controller)}(jQuery);primitives.text.Config=function(){this.classPrefix="bptext";this.orientation=this.graphicsType=0;this.text="";this.verticalAlignment=1;this.horizontalAlignment=0;this.fontSize="16px";this.fontFamily="Arial";this.color="#000000";this.fontStyle=this.fontWeight="normal"};
primitives.text.Controller=function(){this.widgetEventPrefix="bptext";this.options=new primitives.text.Config;this.m_graphics=this.m_panelSize=this.m_placeholder=null};primitives.text.Controller.prototype._create=function(){this.element.addClass("ui-widget");this._createLayout();this._redraw()};primitives.text.Controller.prototype.destroy=function(){this._cleanLayout()};
primitives.text.Controller.prototype._createLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());this.m_placeholder=jQuery("<div></div>");this.m_placeholder.css({position:"relative",overflow:"hidden",top:"0px",left:"0px",padding:"0px",margin:"0px"});this.m_placeholder.css(this.m_panelSize.getCSS());this.m_placeholder.addClass("placeholder");this.m_placeholder.addClass(this.widgetEventPrefix);this.element.append(this.m_placeholder);
this.m_graphics=primitives.common.createGraphics(this.options.graphicsType,this.element)};primitives.text.Controller.prototype._cleanLayout=function(){null!==this.m_graphics&&this.m_graphics.clean();this.m_graphics=null;this.element.find("."+this.widgetEventPrefix).remove()};primitives.text.Controller.prototype._updateLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.innerWidth(),this.element.innerHeight());this.m_placeholder.css(this.m_panelSize.getCSS())};
primitives.text.Controller.prototype.update=function(a){a?(this._cleanLayout(),this._createLayout(),this._redraw()):(this._updateLayout(),this.m_graphics.resize("placeholder",this.m_panelSize.width,this.m_panelSize.height),this.m_graphics.begin(),this._redraw(),this.m_graphics.end())};
primitives.text.Controller.prototype._redraw=function(){var a=this.m_graphics.activate("placeholder");this.m_graphics.text(a.rect.x,a.rect.y,a.rect.width,a.rect.height,this.options.text,this.options.orientation,this.options.horizontalAlignment,this.options.verticalAlignment,{"font-size":this.options.fontSize,"font-family":this.options.fontFamily,"font-style":this.options.fontStyle,"font-weight":this.options.fontWeight,"font-color":this.options.color})};
primitives.text.Controller.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":var c=jQuery([]);b?(c.filter(".ui-state-focus").blur(),c.removeClass("ui-state-hover"),c.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(c.propAttr("disabled",!1),this.element.removeClass("ui-disabled"))}};"undefined"!=typeof jQuery&&function(a){a.widget("ui.bpText",new primitives.text.Controller)}(jQuery);
